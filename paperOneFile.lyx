#LyX 1.6.8 created this file. For more info see http://www.lyx.org/
\lyxformat 345
\begin_document
\begin_header
\textclass elsart
\begin_preamble
\usepackage{yjsco}\journal{Journal of Symbolic Computation}

\renewcommand{\algorithmicrequire}{\textbf{Input:}}\renewcommand{\algorithmicensure}{\textbf{Output:}}\renewcommand{\algorithmicensure}{\textbf{if}}\renewcommand{\algorithmicensure}{\textbf{Uses:}}

\def\diag{\mbox{diag}}\def\cdeg{\qopname\relax n{cdeg}}\keycomment{\{\{}{\}\}}\def\MM{\qopname\relax n{MM}}\def\M{\qopname\relax n{M}}\def\ord{\qopname\relax n{ord}}

\def\StorjohannTransform{\qopname\relax n{StorjohannTransform}}\def\TransformUnbalanced{\qopname\relax n{TransformUnbalanced}}\def\rowDimension{\qopname\relax n{rowDimension}}\def\columnDimension{\qopname\relax n{columnDimension}}\DeclareMathOperator{\re}{rem}\DeclareMathOperator{\coeff}{coeff}\DeclareMathOperator{\lcoeff}{lcoeff}\def\mab{\qopname\relax n{OrderBasis}}\def\mmab{\qopname\relax n{FastBasis}}\def\umab{\qopname\relax n{UnbalancedFastBasis}}\newcommand{\bb}{\\}

\makeatother
\end_preamble
\options amsthm,seceqn,secthm
\use_default_options false
\language english
\inputencoding latin9
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 2
\use_esint 1
\cite_engine natbib_authoryear
\use_bibtopic false
\paperorientation portrait
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle default
\tracking_changes false
\output_changes false
\author "" 
\author "" 
\end_header

\begin_body

\begin_layout Title
Efficient Algorithms for Order Bases Computation
\end_layout

\begin_layout Author
Wei Zhou and George Labahn
\end_layout

\begin_layout Author Address
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Cheriton School of Computer Science
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

University of Waterloo
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

,
\begin_inset Newline newline
\end_inset

 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

Waterloo, Ontario, Canada
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\end_layout

\begin_layout Author Email

\backslash
{w2zhou,glabahn
\backslash
}@uwaterloo.ca 
\end_layout

\begin_layout Abstract
In this paper we present two algorithms for the computation of a shifted
 order basis of an 
\begin_inset Formula $m\times n$
\end_inset

 matrix of power series over a field 
\begin_inset Formula $\mathbb{K}$
\end_inset

 with 
\begin_inset Formula $m\le n$
\end_inset

.
 For a given order 
\begin_inset Formula $\sigma$
\end_inset

 and balanced shift 
\begin_inset Formula $\vec{s}$
\end_inset

 the first algorithm determines an order basis with a cost of 
\begin_inset Formula $O^{\sim}(n^{\omega}\lceil m\sigma/n\rceil)$
\end_inset

 field operations in 
\begin_inset Formula $\mathbb{K}$
\end_inset

, where 
\begin_inset Formula $\omega$
\end_inset

 is the exponent of matrix multiplication.
 Here an input shift is balanced when 
\begin_inset Formula $\max(\vec{s})-\min(\vec{s})\in O(m\sigma/n)$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%Here $O^{
\backslash
sim}$
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%is just $O$ with log factors omitted and 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%$
\backslash
MM
\backslash
left(n,d
\backslash
right)$ denotes
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%the cost of multiplying two polynomial matrices with dimension $n$
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%and degree $d$.
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

This extends earlier work of Storjohann which only determines a subset of
 an order basis that is within a specified degree bound 
\begin_inset Formula $\delta$
\end_inset

 using 
\begin_inset Formula $O^{\sim}(n^{\omega}\delta)$
\end_inset

 field operations for 
\begin_inset Formula $\delta\ge\lceil m\sigma/n\rceil$
\end_inset

.
\end_layout

\begin_layout Abstract
While the first algorithm addresses the case when the column degrees of
 a complete order basis are unbalanced given a balanced input shift, it
 is not efficient in the case when an unbalanced shift results in the row
 degrees also becoming unbalanced.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%The column degrees of a complete basis may be unbalanced, which is
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%a major issue we address in the first algorithm.
 When the input shift
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%is unbalanced, the row degrees of the basis can also be unbalanced
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%in addition to the unbalanced column degrees.
 For this, we present
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

We present a second algorithm which balances the high degree rows and computes
 an order basis also using 
\begin_inset Formula $O^{\sim}(n^{\omega}\lceil m\sigma/n\rceil)$
\end_inset

 field operations in the case that the shift is unbalanced but satisfies
 the condition 
\begin_inset Formula $\sum_{i=1}^{n}(\max(\vec{s})-\vec{s}_{i})\le m\sigma$
\end_inset

.
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Every problem with any unbalanced shift can be in fact reduced to a problem
 with a shift that satisfying this condition if the degrees of a resulting
 order basis is known.
 
\end_layout

\end_inset

 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Many unbalanced shift problems can be in fact converted to problems satisfying
 this condition.
 
\end_layout

\end_inset

 This condition essentially allows us to locate those high degree rows that
 need to be balanced.
 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
In more general unbalanced shift cases, this algorithm may not work well
 directly since we do not know in advance which are the high degree rows
 need to be balanced.
 But it may work efficiently if we have an effective way of estimating the
 resulting row degrees.
 
\end_layout

\end_inset

 This extends the earlier work by the authors from ISSAC'09.
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
remove all soft O notation and always write logs explicitly? 
\end_layout

\end_inset

Let 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[\left[x\right]\right]^{m\times n}$
\end_inset

 be a matrix of power series over a field 
\begin_inset Formula $\mathbb{K}$
\end_inset

 with 
\begin_inset Formula $m\le n$
\end_inset

.
 Given a nonnegative integer 
\begin_inset Formula $\sigma$
\end_inset

, we say a vector 
\begin_inset Formula $\mathbf{p}\in\mathbb{K}\left[x\right]^{n\times1}$
\end_inset

 of polynomials gives an 
\emph on
order
\emph default
 
\begin_inset Formula $\sigma$
\end_inset

 approximation of 
\begin_inset Formula $\mathbf{F}$
\end_inset

, or 
\begin_inset Formula $\mathbf{p}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

, if 
\begin_inset Formula \[
\mathbf{F}\cdot\mathbf{p}\equiv\mathbf{0}\mod x^{\sigma},\]

\end_inset

 that is, the first 
\begin_inset Formula $\sigma$
\end_inset

 terms of 
\begin_inset Formula $\mathbf{F}\cdot\mathbf{p}$
\end_inset

 are zero.
 Historically such problems date back to their use in Hermite's proof of
 the transcendence of 
\begin_inset Formula $e$
\end_inset

 in 1873.
 In 1893 Padé, a student of Hermite, formalized the concepts introduced
 by Hermite and defined what is now known as Hermite-Padé approximants (where
 
\begin_inset Formula $m=1$
\end_inset

), Padé approximants (where 
\begin_inset Formula $m=1,n=2$
\end_inset

) and simultaneous Padé approximants (where 
\begin_inset Formula $\mathbf{F}$
\end_inset

 has a special structure).
 Such rational approximations also specified degree constraints on the polynomia
ls 
\begin_inset Formula $\mathbf{p}$
\end_inset

 and had their order conditions related to these degree constraints.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%Pad
\backslash
'e also introduced the notion of a Pad
\backslash
'e
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%table for the case $m=1,n=2$ which described all Pad
\backslash
'e approximants 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%in terms of $2$ nearby approximants.
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Additional order problems include vector and matrix versions of rational
 approximation, partial realizations of matrix sequences and vector rational
 reconstruction just to name a few (cf.
 the references in 
\begin_inset CommandInset citation
LatexCommand citet
key "BL1997"

\end_inset

).
 As an example, the factorization of differential operators algorithm of
 
\begin_inset CommandInset citation
LatexCommand citet
key "vanHoeij"

\end_inset

 makes use of vector Hermite-Padé approximation to reconstruct differential
 factorizations over rational functions from factorizations of differential
 operators over power series domains.
\end_layout

\begin_layout Standard
The set of all such order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

 approximations forms a module over 
\begin_inset Formula $\mathbb{K}\left[x\right]$
\end_inset

.
 An 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
em
\end_layout

\end_inset

 order basis
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 - or minimal approximant basis or 
\begin_inset Formula $\sigma$
\end_inset

-basis - is a basis of this module having a type of minimal degree property
 (called reduced order basis in 
\begin_inset CommandInset citation
LatexCommand citep
key "BL1997"

\end_inset

).
 The minimal degree property parameterizes solutions to an order problem
 by the degrees of the columns of the order basis.
 In the case of rational approximation, order bases can be viewed as a natural
 generalization of the Padé table of a power series 
\begin_inset CommandInset citation
LatexCommand citep
key "gravesmorris"

\end_inset

 since they are able to describe 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
em
\end_layout

\end_inset

 all
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 solutions to such problems given particular degree bounds.
 They can even be used to show the well known block structure of the Padé
 and related Rational Interpolation tables 
\begin_inset CommandInset citation
LatexCommand citep
key "BL1997"

\end_inset

.
 Order bases are used in such diverse applications as the inversion of structure
d matrices 
\begin_inset CommandInset citation
LatexCommand citep
key "La92"

\end_inset

, normal forms of matrix polynomials 
\begin_inset CommandInset citation
LatexCommand citep
key "BLV:1999,BLV:jsc06"

\end_inset

, and other important problems in matrix polynomial arithmetic including
 matrix inversion, determinant and nullspace computation 
\begin_inset CommandInset citation
LatexCommand citep
key "Giorgi2003,storjohann-villard:2005"

\end_inset

.
 In our case we also allow the minimal degree property to include a shift
 
\begin_inset Formula $\vec{s}$
\end_inset

.
 Such a shift is important, for example, for matrix normal form problems
 
\begin_inset CommandInset citation
LatexCommand citep
key "BLV:1999,BLV:jsc06"

\end_inset

.
\end_layout

\begin_layout Standard
In this paper we focus on the efficient computation of order basis.
 Algorithms for fast computation of order basis include that of 
\begin_inset CommandInset citation
LatexCommand citet
key "BeLa94"

\end_inset

 which converts the matrix problem into a vector problem of higher order
 (which they called the Power Hermite-Padé problem).
 Their divide and conquer algorithm has complexity of 
\begin_inset Formula $O^{\sim}(n^{2}m\sigma+nm^{2}\sigma)$
\end_inset

 field operations.
 As usual, the soft-
\begin_inset Formula $O$
\end_inset

 notation 
\begin_inset Formula $O^{\sim}$
\end_inset

 is simply Big-
\begin_inset Formula $O$
\end_inset

 with polylogarithmic factors 
\begin_inset Formula $(\log(nm\sigma))^{O(1)}$
\end_inset

 ommited.
 By working more directly on the input 
\begin_inset Formula $m\times n$
\end_inset

 input matrix, 
\begin_inset CommandInset citation
LatexCommand citet
key "Giorgi2003"

\end_inset

 give a divide and conquer method with cost 
\begin_inset Formula $O^{\sim}\left(n^{\omega}\sigma\right)$
\end_inset

 arithmetic operations.
 Their method is very efficient if 
\begin_inset Formula $m$
\end_inset

 is close to the size of 
\begin_inset Formula $n$
\end_inset

 but can be improved if 
\begin_inset Formula $m$
\end_inset

 is small.
\end_layout

\begin_layout Standard
In a novel construction, 
\begin_inset CommandInset citation
LatexCommand citet
key "Storjohann:2006"

\end_inset

 effectively reverses the approach of Beckermann and Labahn.
 Namely, rather than convert a high dimension matrix order problem into
 a lower dimension vector problem of higher order, Storjohann converts a
 low dimension problem to a high dimension problem with lower order.
 For example, computing an order basis for a 
\begin_inset Formula $1\times n$
\end_inset

 vector input 
\begin_inset Formula $\mathbf{f}$
\end_inset

 and order 
\begin_inset Formula $\sigma$
\end_inset

 can be converted to a problem of order basis computation with an 
\begin_inset Formula $O\left(n\right)\times O\left(n\right)$
\end_inset

 input matrix and an order 
\begin_inset Formula $O\left(\left\lceil \sigma/n\right\rceil \right)$
\end_inset

.
 Combining this conversion with the method of Giorgi et al.
 can then be used effectively for problems with small row dimensions to
 achieve a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}\left\lceil m\sigma/n\right\rceil \right)$
\end_inset

.
\end_layout

\begin_layout Standard
However, while order bases of the original problem can have degree up to
 
\begin_inset Formula $\sigma$
\end_inset

, the nature of Storjohann's conversion limits the degree of an order basis
 of the converted problem to 
\begin_inset Formula $O\left(\left\lceil m\sigma/n\right\rceil \right)$
\end_inset

 in order to be computationally efficient.
 In other words, this approach does not in general compute a complete order
 basis.
 Rather, in order to achieve efficiency, it only computes a partial order
 basis containing basis elements with degrees within 
\begin_inset Formula $O\left(\left\lceil m\sigma/n\right\rceil \right)$
\end_inset

, referred to by Storjohann as a 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout


\backslash
em
\end_layout

\end_inset

 minbasis
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

.
 Fast methods for computing a minbasis are particularly useful for certain
 problems, for example, in the case of inversion of structured block matrices
 where one needs only precisely the minbasis 
\begin_inset CommandInset citation
LatexCommand citep
key "La92"

\end_inset

.
 However, in other applications, such as those arising in matrix polynomial
 arithmetic, one needs a complete basis which specifies all solutions of
 a given order, not just those within a particular degree bound (cf.
 
\begin_inset CommandInset citation
LatexCommand citet
key "BL1997"

\end_inset

).
\end_layout

\begin_layout Standard
In this paper we present two algorithms which compute an entire order basis
 with a cost of 
\begin_inset Formula $O^{\sim}(n^{\omega}\lceil m\sigma/n\rceil)$
\end_inset

 field operations.
 This work extends the previous results first reported in 
\begin_inset CommandInset citation
LatexCommand citet
key "za2009"

\end_inset

.
 The two algorithms differ depending on the nature of the degree shift required
 for the reduced order basis.
 In the first case we use a transformation that can be considered as an
 extension of Storjohann's transformation.
 This new transformation provides a way to extend the results from one transform
ed problem to another transformed problem of a higher degree.
 This enables us to use an idea from the null space basis algorithm found
 in 
\begin_inset CommandInset citation
LatexCommand citep
key "storjohann-villard:2005"

\end_inset

 in order to achieve efficient computation.
 At each iteration, basis elements within a specified degree bound are computed
 via a Storjohann transformed problem.
 Then the partial result is used to simplify the next Storjohann transformed
 problem of a higher degree, allowing basis elements within a higher degree
 bound to be computed efficiently.
 This is repeated until all basis elements are computed.
\end_layout

\begin_layout Standard
In order to compute an order basis efficiently, the first algorithm requires
 that the degree shifts are balanced.
 In the case where the shift is not balanced, the row degrees of the basis
 can also become unbalanced in addition to the unbalanced column degrees.
 We give a second algorithm that balances the high degree rows and uses
 
\begin_inset Formula $O^{\sim}(n^{\omega}\lceil m\sigma/n\rceil)$
\end_inset

 field operations when the shift 
\begin_inset Formula $\vec{s}$
\end_inset

 is unbalanced but satisfies the condition 
\begin_inset Formula $\sum_{i=1}^{n}(\max(\vec{s})-\vec{s}_{i})\le m\sigma$
\end_inset

.
 This condition essentially allows us to locate the high degree unbalanced
 rows that need to be balanced.
 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
In fact, every problem with any unbalanced shift can be reformulated to
 a problem with a shift satisfying this condition if the degrees of the
 resulting order basis is known.
 
\end_layout

\end_inset

 The algorithm converts a problem of unbalanced shift to one with balanced
 shift, based on a second idea from 
\begin_inset CommandInset citation
LatexCommand citep
key "Storjohann:2006"

\end_inset

.
 Then the first algorithm is used to efficiently compute the elements of
 an order basis whose shifted degrees exceed a specified parameter.
 The problem is then reduced to one where we remove the computed elements.
 This results in a new problem with smaller dimension and higher degree.
 The same process is repeated again on this new problem in order to compute
 the elements with the next highest shifted degrees.
\end_layout

\begin_layout Standard
The remaining paper is structured as follows.
 Basic definitions and properties of order bases are given in the next section.
 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sec:transform"

\end_inset

 provides an extension to Storjohann's transformation to allow higher degree
 basis elements to be computed.
 Based on this new transformation, 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sec:Order-Basis-Computation"

\end_inset

 establishes a link between two Storjohann transformed problems of different
 degrees, from which an recursive method and then an iterative algorithm
 are derived.
 The time complexity is analyzed in the next section.
 After this, 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sec:Unbalanced-Shift"

\end_inset

 describes an algorithm which handles problems with a type of unbalanced
 shift.
 This is followed by a conclusion along with a description for topics for
 future research.
 
\end_layout

\begin_layout Section
Preliminaries
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Background"

\end_inset


\end_layout

\begin_layout Standard
The computational cost in this paper is analysed by bounding the number
 of arithmetic operations (additions, subtractions, multiplications, and
 divisions) in the coefficient field 
\begin_inset Formula $\mathbb{K}$
\end_inset

 on an algebraic random access machine.
 We use 
\begin_inset Formula $\MM(n,d)$
\end_inset

 to denote the cost of multiplying two polynomial matrices with dimension
 
\begin_inset Formula $n$
\end_inset

 and degree 
\begin_inset Formula $d$
\end_inset

, and 
\begin_inset Formula $\M(n)$
\end_inset

 to denote the cost of multiplying two polynomials with degree 
\begin_inset Formula $d$
\end_inset

.
 We define a cost function 
\begin_inset Formula $\bar{\M}(d)=d\log d\log\log d$
\end_inset

, then 
\begin_inset Formula $\bar{\M}(ab)\in O\left(\bar{\M}(a)\bar{\M}(b)\right)$
\end_inset

 and 
\begin_inset Formula $\bar{\M}(t)\in O(n^{\omega-1})$
\end_inset

.
 We take 
\begin_inset Formula $\MM(n,d)\in O\left(n^{\omega}\M(d)\right)\subset O(n^{\omega}\M'(d))$
\end_inset

, where the multiplication exponent 
\begin_inset Formula $\omega$
\end_inset

 is assumed to satisfy 
\begin_inset Formula $2<\omega\le3$
\end_inset

.
 We refer to the book by 
\begin_inset CommandInset citation
LatexCommand citet
key "vonzurgathen"

\end_inset

 for more details and reference about the cost of polynomial multiplication
 and matrix multiplication.
\end_layout

\begin_layout Standard
In the remaining of this section, we provide some of the background needed
 in order to understand the basic concepts and tools needed for order basis
 computation.
 This includes basic definitions and a look at the size of the input and
 the output for computing such bases.
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
, which provide lower bounds for the computational cost 
\end_layout

\end_inset

 The challenges of balancing input and handling unbalanced output are discussed
 along with the techniques which we plan to use to overcome the difficulties.
 We review the construction by 
\begin_inset CommandInset citation
LatexCommand citet
key "Storjohann:2006"

\end_inset

 which transforms the inputs to those having dimensions and degree balance
 better suited for fast computation and discuss an idea from 
\begin_inset CommandInset citation
LatexCommand citet
key "storjohann-villard:2005"

\end_inset

 for handling the case where the output degree is unbalanced.
\end_layout

\begin_layout Subsection
Order Basis
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\mathbb{K}$
\end_inset

 be a field, 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[\left[x\right]\right]^{m\times n}$
\end_inset

 a matrix of power series and 
\begin_inset Formula $\vec{\sigma}=\left[\sigma_{1},\dots,\sigma_{m}\right]$
\end_inset

 a vector of non-negative integers.
 
\end_layout

\begin_layout Definition
A vector of polynomials 
\begin_inset Formula $\mathbf{p}\in\mathbb{K}\left[x\right]^{n\times1}$
\end_inset

 has 
\emph on
order
\emph default
 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

 (or 
\emph on
order
\emph default
 
\begin_inset Formula $\vec{\sigma}$
\end_inset

 with respect to 
\begin_inset Formula $\mathbf{F}$
\end_inset

) if 
\begin_inset Formula $\mathbf{F}\cdot\mathbf{p}\equiv\mathbf{0}\mod x^{\vec{\sigma}}$
\end_inset

, that is, 
\begin_inset Formula \[
\mathbf{F}\cdot\mathbf{p}=x^{\vec{\sigma}}\mathbf{r}=\begin{bmatrix}x^{\sigma_{1}}\\
 & \ddots\\
 &  & x^{\sigma_{m}}\end{bmatrix}\mathbf{r}\]

\end_inset

 for some 
\begin_inset Formula $\mathbf{r}\in\mathbb{K}\left[\left[x\right]\right]^{m\times1}$
\end_inset

.
 If 
\begin_inset Formula $\vec{\sigma}=\left[\sigma,\dots,\sigma\right]$
\end_inset

 is uniform, then we say that 
\begin_inset Formula $\mathbf{p}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right).$
\end_inset

 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
The vector of power series 
\begin_inset Formula $\mathbf{r}$
\end_inset

 is called the order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

-residual of 
\series bold

\begin_inset Formula $\mathbf{p}$
\end_inset


\series default
.
 
\end_layout

\end_inset

 The set of all order 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

 vectors is a 
\begin_inset Formula $\mathbb{K}\left[x\right]$
\end_inset

-module denoted by 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

.
 
\end_layout

\begin_layout Standard
An order basis for 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and 
\begin_inset Formula $\vec{\sigma}$
\end_inset

 is simply a basis for the module 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

.
 In this paper we compute those order bases having a type of minimality
 degree condition (also referred to as a reduced order basis in 
\begin_inset CommandInset citation
LatexCommand citep
key "BL1997"

\end_inset

).
 While minimality is often given in terms of the degrees alone it is sometimes
 important to consider this in terms of shifted degrees 
\begin_inset CommandInset citation
LatexCommand citep
key "BLV:jsc06"

\end_inset

.
\end_layout

\begin_layout Standard
The shifted column degree of a column polynomial vector 
\begin_inset Formula $\mathbf{p}$
\end_inset

 with shift 
\begin_inset Formula $\vec{s}=\left[s_{1},\dots,s_{n}\right]\in\mathbb{Z}^{n}$
\end_inset

 is given by 
\begin_inset Formula \[
\deg_{\vec{s}}\mathbf{p}=\max_{1\le i\le n}[\deg p^{\left(i\right)}+s_{i}]=\deg(x^{\vec{s}}\cdot\mathbf{p}).\]

\end_inset

 We call this the 
\emph on

\begin_inset Formula $\vec{s}$
\end_inset

-column degree
\emph default
, or simply the 
\emph on

\begin_inset Formula $\vec{s}$
\end_inset

-degree
\emph default
 of 
\begin_inset Formula $\mathbf{p}$
\end_inset

.
 A shifted column degree defined this way is equivalent to the notion of
 
\emph on
defect
\emph default
 commonly used in the literature.
 Our definition of 
\begin_inset Formula $\vec{s}$
\end_inset

-degree is also equivalent to the notion of 
\begin_inset Formula $\mathbf{H}$
\end_inset

-degree from 
\begin_inset CommandInset citation
LatexCommand citep
key "BL1997"

\end_inset

 for 
\begin_inset Formula $\mathbf{H}=x^{\vec{s}}$
\end_inset

.
 As in the uniform shift case, we say a matrix is 
\emph on

\begin_inset Formula $\vec{s}$
\end_inset

-column reduced
\emph default
 or 
\emph on

\begin_inset Formula $\vec{s}$
\end_inset

-reduced
\emph default
 if its 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees cannot be decreased by unimodular column operations.
 More precisely, if 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is a 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced and 
\begin_inset Formula $[d_{1},\dots,d_{n}]$
\end_inset

 are the 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees of columns of 
\begin_inset Formula $\mathbf{P}$
\end_inset

 sorted in nondecreasing order, then 
\begin_inset Formula $[d_{1},\dots,d_{n}]$
\end_inset

 is lexicographically minimal among all matrices right equivalent to 
\begin_inset Formula $\mathbf{P}$
\end_inset

.
 Note that a matrix 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced if and only if 
\begin_inset Formula $x^{\vec{s}}\cdot\mathbf{P}$
\end_inset

 is column reduced.
 Similarly, 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is in 
\begin_inset Formula $\vec{s}$
\end_inset

-Popov form if 
\begin_inset Formula $x^{\vec{s}}\cdot\mathbf{P}$
\end_inset

 is in Popov form 
\begin_inset CommandInset citation
LatexCommand citep
key "BLV:1999,BLV:jsc06"

\end_inset

.
 
\end_layout

\begin_layout Standard
An 
\emph on
order basis
\emph default
 
\begin_inset CommandInset citation
LatexCommand citep
key "BeLa94,BL1997"

\end_inset

 
\begin_inset Formula $\mathbf{P}$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 with order 
\begin_inset Formula $\vec{\sigma}$
\end_inset

 and shift 
\begin_inset Formula $\vec{s}$
\end_inset

, or simply an 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis, is a basis for the module 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

 
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
\begin_inset Formula \[
\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle =\{\mathbf{p}\in\mathbb{K}\left[x\right]^{n\times1}\|\mathbf{F}\cdot\mathbf{p}=x^{\vec{\sigma}}\mathbf{r},\mathbf{r}\in\mathbb{K}[[x]]^{m\times1}\}\]

\end_inset


\end_layout

\end_inset

 having minimal 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees.
 If 
\begin_inset Formula $\vec{\sigma}=\left[\sigma,\dots,\sigma\right]$
\end_inset

 are constant vectors then we simply write 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 The precise definition of an 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis is as follows.
\end_layout

\begin_layout Definition
A polynomial matrix 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is an order basis of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 of order 
\begin_inset Formula $\sigma$
\end_inset

 and shift 
\begin_inset Formula $\vec{s}$
\end_inset

, denoted by 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis, if the following properties hold:
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 is a nonsigular matrix of dimension 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

 (or equivalently, each column of 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is in 
\begin_inset Formula $\left\langle (\mathbf{F},\vec{\sigma})\right\rangle $
\end_inset

).
 
\end_layout

\begin_layout Enumerate
Any 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

 can be expressed as a linear combination of the columns of 
\begin_inset Formula $\mathbf{P}$
\end_inset

, given by 
\begin_inset Formula $\mathbf{P}^{-1}\mathbf{q}$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
Note that the module 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

 does not depend on the shift 
\begin_inset Formula $\vec{s}$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Although we allow different orders for each row in this definition, we focus
 on order basis computation problems having uniform order.
 However special cases of non-uniform order problems are still needed in
 our analysis.
 We also assume 
\begin_inset Formula $m\le n$
\end_inset

 for simplicity.
 The case of 
\begin_inset Formula $m>n$
\end_inset

 can be transformed to the case of 
\begin_inset Formula $m\le n$
\end_inset

 by compression 
\begin_inset CommandInset citation
LatexCommand citep
key "storjohann-villard:2005"

\end_inset

.
 We further assume, without any loss of generality, that 
\begin_inset Formula $n/m$
\end_inset

 and 
\begin_inset Formula $\sigma$
\end_inset

 are powers of two.
 This can be achieved by padding zero rows to the input matrix and multiplying
 it by some power of 
\begin_inset Formula $x$
\end_inset

.
\end_layout

\begin_layout Standard
From 
\begin_inset CommandInset citation
LatexCommand citep
key "BL1997"

\end_inset

 we have the following lemma.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:orderBasisProperty"

\end_inset

 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:orderBasisEquivalence"

\end_inset

The following are equivalent for a polynomial matrix 
\series bold

\begin_inset Formula $\mathbf{P}$
\end_inset


\series default
: 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis.
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 is comprised of a set of 
\begin_inset Formula $n$
\end_inset

 minimal 
\begin_inset Formula $\vec{s}$
\end_inset

-degree polynomial vectors that are linearly independent and each having
 order 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
\begin_inset CommandInset label
LatexCommand label
name "enu:reduced+generator"

\end_inset


\begin_inset Formula $\mathbf{P}$
\end_inset

 does not contain a zero column, has order 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

, is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced, and any 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

 can be expressed as a linear combination of the columns of 
\begin_inset Formula $\mathbf{P}$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Standard
In some cases an entire order basis is unnecessary and instead one looks
 for a minimal basis that generates only the elements of 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

 with 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees bounded by a given 
\begin_inset Formula $\delta$
\end_inset

.
 Such a minimal basis is a partial 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis comprised of elements of a 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis with 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees bounded by 
\begin_inset Formula $\delta$
\end_inset

.
 This is called a 
\emph on
minbasis
\emph default
 in 
\begin_inset CommandInset citation
LatexCommand citet
key "Storjohann:2006"

\end_inset

.
 
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:genset"

\end_inset

 Let 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma},\vec{s}\right)\right\rangle _{\delta}\subset\left\langle \left(\mathbf{F},\vec{\sigma}\right)\right\rangle $
\end_inset

 denote the set of order 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right)$
\end_inset

 polynomial vectors with 
\begin_inset Formula $\vec{s}$
\end_inset

-degree bounded by 
\begin_inset Formula $\delta$
\end_inset

.
 A 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)_{\delta}$
\end_inset

-basis is a polynomial matrix 
\begin_inset Formula $\mathbf{P}$
\end_inset

 not containing a zero column and satisfying: 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma}\right).$
\end_inset

 
\end_layout

\begin_layout Enumerate
Any element of 
\begin_inset Formula $\left\langle \left(\mathbf{F},\vec{\sigma},\vec{s}\right)\right\rangle _{\delta}$
\end_inset

 can be expressed as a linear combination of the columns of 
\begin_inset Formula $\mathbf{P}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\mathbf{P}$
\end_inset

 is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
As before, the linear combination here is in fact unique.
 
\end_layout

\end_inset

A 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)_{\delta}$
\end_inset

-basis is, in general, not square unless 
\begin_inset Formula $\delta$
\end_inset

 is large enough to contain all 
\begin_inset Formula $n$
\end_inset

 basis elements in which case it is a complete 
\begin_inset Formula $\left(\mathbf{F},\vec{\sigma},\vec{s}\right)$
\end_inset

-basis.
\end_layout

\begin_layout Subsection
Balancing Input with Storjohann's Transformation
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sub:storjohannTransformation"

\end_inset


\end_layout

\begin_layout Standard
For computing a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis with input matrix 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[\left[x\right]\right]^{m\times n}$
\end_inset

, shift 
\begin_inset Formula $\vec{s}$
\end_inset

 and order 
\begin_inset Formula $\sigma$
\end_inset

 one can view 
\begin_inset Formula $\mathbf{F}$
\end_inset

 as a polynomial matrix with degree 
\begin_inset Formula $\sigma-1$
\end_inset

, as higher order terms are not needed in the computation.
 As such the total input size of an order basis problem is 
\begin_inset Formula $mn\sigma$
\end_inset

 coefficients.
 One can apply the method of 
\begin_inset CommandInset citation
LatexCommand citet
key "Giorgi2003"

\end_inset

 directly, which gives a cost of 
\begin_inset Formula \begin{align*}
\sum_{i=0}^{\log\sigma}2^{i}\MM(n,2^{-i}\sigma)= & \sum_{i=0}^{\log\sigma}2^{-i}\sigma\MM(n,2^{i})\\
\subset & O\left(\sum_{i=0}^{\log\sigma}2^{-i}n^{\omega}\sigma2^{i}\log2^{i}\log\log2^{i}\right)\\
= & O\left(n^{\omega}\sigma\sum_{i=0}^{\log\sigma}i\log i\right)\\
\subset & O\left(n^{\omega}\sigma\sum_{i=0}^{\log\sigma}\log\sigma\log\log\sigma\right)\\
= & O\left(n^{\omega}\sigma\log^{2}\sigma\log\log\sigma\right)=O(n^{\omega}\bar{\M}(\sigma)\log\sigma),\end{align*}

\end_inset

 close to the cost of multiplying two matrices with dimension 
\begin_inset Formula $n$
\end_inset

 and degree 
\begin_inset Formula $\sigma$
\end_inset

.
 Note that this cost is independent of the degree shift.
 This is very efficient if 
\begin_inset Formula $m\in\Theta\left(n\right)$
\end_inset

.
 However, for small 
\begin_inset Formula $m$
\end_inset

, say 
\begin_inset Formula $m=1$
\end_inset

 as in Hermite Padé approximation, the total input size is only 
\begin_inset Formula $n\sigma$
\end_inset

 coefficients.
 Matrix multiplication cannot be used effectively on a such vector input.
\end_layout

\begin_layout Standard
\begin_inset CommandInset citation
LatexCommand citet
key "Storjohann:2006"

\end_inset

 provides a novel way to transform an order basis problem with small row
 dimension to a problem with higher row dimension and possibly lower degree
 to take advantage of 
\begin_inset CommandInset citation
LatexCommand citet
key "Giorgi2003"

\end_inset

's algorithm.
 We provide a quick overview of a slightly modified version of Storjohann's
 method.
 Our small modification allows a nonuniform degree shift for the input and
 provides a slightly simpler degree shift, degree, and order for the transformed
 problem.
 The proof of its correctness is provided in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sec:transform"

\end_inset

.
 In order to compute a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis, assuming without loss of generality that 
\begin_inset Formula $\min\left(\vec{s}\right)=0$
\end_inset

, we first write 
\begin_inset Formula \[
\mathbf{F}=\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta}+\mathbf{F}_{2}x^{2\delta}+\cdots+\mathbf{F}_{l}x^{l\delta},\]

\end_inset

 with 
\begin_inset Formula $\deg\mathbf{F}_{i}<\delta$
\end_inset


\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
I used 
\begin_inset Formula $\deg\mathbf{F}_{i}\le\delta-1$
\end_inset

 before, but the reviewer suggested changing to 
\begin_inset Formula $\deg\mathbf{F}_{i}<\delta$
\end_inset

 and said it's slightly easier to read.
 A reason to use 
\begin_inset Formula $\le$
\end_inset

 is to make it consistent with the definition of minbasis.
 For example, 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{\delta-1}$
\end_inset

-basis indicates that the degree bound is 
\begin_inset Formula $\delta-1$
\end_inset

.
 I still prefer to use 
\begin_inset Formula $\le$
\end_inset

.
 
\end_layout

\end_inset

 for a positive integer 
\begin_inset Formula $\delta$
\end_inset

, and where we assume (again without loss of generality) that 
\begin_inset Formula $\sigma=\left(l+1\right)\delta$
\end_inset

.
 Set 
\begin_inset Formula \[
{\bar{\mathbf{F}}}=\left[\begin{array}{c|cccc}
\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta} & \mathbf{0}_{m} & \mathbf{0}_{m} & \cdots & \mathbf{0}_{m}\\
\hline \mathbf{F}_{1}+\mathbf{F}_{2}x^{\delta} & \mathbf{I}_{m} & \mathbf{0}_{m}\\
\mathbf{F}_{2}+\mathbf{F}_{3}x^{\delta} & \mathbf{0}_{m} & \mathbf{I}_{m}\\
\vdots &  &  & \ddots\\
\mathbf{F}_{l-1}+\mathbf{F}_{l}x^{\delta} &  &  &  & \mathbf{I}_{m}\end{array}\right]_{ml\times(n+m(l-1))}.\]

\end_inset

 On the left side of 
\begin_inset Formula $\bar{\mathbf{F}}$
\end_inset

, each block 
\begin_inset Formula $\mathbf{F}_{i}+\mathbf{F}_{i+1}x^{\delta}$
\end_inset

 has dimension 
\begin_inset Formula $m\times n$
\end_inset

.
 On the right side, there are 
\begin_inset Formula $l\times(l-1)$
\end_inset

 blocks of 
\begin_inset Formula $\mathbf{0}_{m}$
\end_inset

's or 
\begin_inset Formula $\mathbf{I}_{m}$
\end_inset

's each having dimension 
\begin_inset Formula $m\times m$
\end_inset

.
 The overall dimension of 
\begin_inset Formula $\bar{\mathbf{F}}$
\end_inset

 is 
\begin_inset Formula $ml\times(n+m(l-1))$
\end_inset

.
 Set 
\begin_inset Formula $\vec{s'}=\left[\vec{s},0,\dots,0\right]$
\end_inset

 (
\begin_inset Formula $\vec{s}$
\end_inset

 followed by 
\begin_inset Formula $m\left(l-1\right)$
\end_inset

 
\begin_inset Formula $0$
\end_inset

's).
 A 
\begin_inset Formula $({\bar{\mathbf{F}}},2\delta,\vec{s'})$
\end_inset

-basis can then be computed by the method of Giorgi et al.
 with a cost of 
\begin_inset Formula $O^{\sim}\left(n^{\omega}\delta\right)$
\end_inset

 for 
\begin_inset Formula $\delta\ge\left\lceil m\sigma/n\right\rceil $
\end_inset

.
 This transformation of Storjohann can be viewed as a partial linearization
 of the original problem, where 
\begin_inset Formula $\bar{\mathbf{F}}$
\end_inset

 is analogous to the coefficient matrix of 
\begin_inset Formula $\mathbf{F}$
\end_inset

.
 Note that 
\begin_inset Formula $\bar{\mathbf{F}}$
\end_inset

 has 
\begin_inset Formula $l$
\end_inset

 block rows each containing 
\begin_inset Formula $m$
\end_inset

 rows.
 We continue to use each block row to represent 
\begin_inset Formula $m$
\end_inset

 rows for the remainder of the paper.
\end_layout

\begin_layout Standard
Clearly a 
\begin_inset Formula $(\bar{\mathbf{F}},2\delta,\vec{s'})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

 of the transformed problem is not a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis of the original problem, as 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

 has a higher dimension and lower degree.
 However, the first 
\begin_inset Formula $n$
\end_inset

 rows of the 
\begin_inset Formula $(\bar{\mathbf{F}},2\delta,\vec{s'})_{\delta-1}$
\end_inset

-basis contained in 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{\delta-1}$
\end_inset

-basis.
\end_layout

\begin_layout Standard
Note that there is no need to set the degree parameter 
\begin_inset Formula $\delta$
\end_inset

 to less than 
\begin_inset Formula $\left\lceil m\sigma/n\right\rceil $
\end_inset

, as this produces fewer basis elements without a better cost.
 The lowest cost is achieved when 
\begin_inset Formula $\bar{\mathbf{F}}$
\end_inset

 is close to square so matrix multiplication can be used most effectively.
 This requires the number of block rows 
\begin_inset Formula $l$
\end_inset

 of 
\begin_inset Formula $\bar{\mathbf{F}}$
\end_inset

 to be close to 
\begin_inset Formula $n/m$
\end_inset

, which requires 
\begin_inset Formula $\delta=\Theta\left(\left\lceil m\sigma/n\right\rceil \right)$
\end_inset

.
 Recall that 
\begin_inset Formula $mn\sigma$
\end_inset

 is the total size of the original 
\begin_inset Formula $m\times n$
\end_inset

 input matrix 
\begin_inset Formula $\mathbf{F}$
\end_inset

, hence 
\begin_inset Formula $d=mn\sigma/n^{2}=m\sigma/n$
\end_inset

 is the average degree of each entry of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 if the 
\begin_inset Formula $m$
\end_inset

 rows of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 are spread out over 
\begin_inset Formula $n$
\end_inset

 rows.
 Choosing 
\begin_inset Formula $\delta=\Theta\left(\left\lceil d\right\rceil \right)$
\end_inset

, the cost of computing a 
\begin_inset Formula $({\bar{\mathbf{F}}},2\delta,\vec{s'})$
\end_inset

-basis is then 
\begin_inset Formula $O^{\sim}\left(n^{\omega}\left\lceil d\right\rceil \right)=O^{\sim}\left(n^{\omega}\left\lceil m\sigma/n\right\rceil \right)$
\end_inset

.
 The ceiling function here is used to take care of the case of 
\begin_inset Formula $m\sigma<n$
\end_inset

.
 For the remainder of the paper, we assume that 
\begin_inset Formula $m\sigma\ge n$
\end_inset

 in order to avoid the need for the ceiling function and so simplify the
 presentation.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% avoid this case for simplicity.
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Together with the assumption that 
\begin_inset Formula $\sigma$
\end_inset

 and 
\begin_inset Formula $n/m$
\end_inset

 are both powers of two, 
\begin_inset Formula $m\sigma/n$
\end_inset

 is then always a positive integer in this paper.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%Let us now look at a concrete example that illustrate Storjohann's method.
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exm:StorjohannTransformation"

\end_inset

Let 
\begin_inset Formula $\mathbb{K}=\mathbb{Z}_{2}$
\end_inset

, 
\begin_inset Formula $\sigma=8$
\end_inset

, 
\begin_inset Formula $\delta=2$
\end_inset

 and 
\begin_inset Formula \[
\mathbf{F}=[x+x^{2}+x^{3}+x^{4}+x^{5}+x^{6},~1+x+x^{5}+x^{6}+x^{7},~1+x^{2}+x^{4}+x^{5}+x^{6}+x^{7},~1+x+x^{3}+x^{7}]\]

\end_inset

 a vector of size 
\begin_inset Formula $1\times4$
\end_inset

.
 Then 
\begin_inset Formula \[
\bar{\mathbf{F}}=\left[{\begin{array}{cccc|cc}
x+x^{2}+x^{3} & 1+x & 1+x^{2} & 1+x+x^{2} & ~~0~ & ~0~\\
\hline 1+x+x^{2}+x^{3} & x^{3} & 1+x^{2}+x^{3} & x & ~~1~ & ~0~\\
1+x+x^{2} & x+x^{2}+x^{3} & 1+x+x^{2}+x^{3} & x^{3} & ~~0~ & ~1~\end{array}}\right]_{3\times6}\]

\end_inset

 and a 
\begin_inset Formula $\left(\bar{\mathbf{F}},4,\vec{0}\right)$
\end_inset

-basis is given by 
\begin_inset Formula \[
\bar{\mathbf{P}}=\left[{\begin{array}{cc|cccc}
~1~ & ~x~ & 1 & x^{2}+x^{3} & 0 & x+x^{2}+x^{3}\\
0 & 1 & 0 & x^{2} & x^{2}+x^{3} & 0\\
1 & 1+x & x+x^{2} & x^{2} & x^{2} & x^{2}\\
1 & 0 & 0 & 0 & 0 & 0\\
\hline 0 & 1 & 1 & 0 & x^{2} & x+x^{2}+x^{3}\\
0 & 1 & 1+x^{2} & 0 & x^{2} & x+x^{2}\end{array}}\right].\]

\end_inset

 The first two columns of 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

 have degree less than 
\begin_inset Formula $2$
\end_inset

, hence its top left 
\begin_inset Formula $4\times2$
\end_inset

 submatrix is a 
\begin_inset Formula $\left(\mathbf{F},8,\vec{0}\right)_{1}$
\end_inset

-basis.
 This is a low degree part of the
\series bold
 
\begin_inset Formula $(\mathbf{F},8,\vec{0})$
\end_inset


\series default
-basis
\begin_inset Formula \[
\mathbf{P}=\begin{bmatrix}1 & x & 1 & x^{2}\\
0 & 1 & x^{2}+x^{3} & 0\\
1 & 1+x & x & x^{3}+x^{4}\\
1 & 0 & 0 & 0\end{bmatrix}.\]

\end_inset

 Note that if 
\begin_inset Formula $\delta$
\end_inset

 is set to 
\begin_inset Formula $\sigma/2=4$
\end_inset

, then the transformed problem is the same as the original problem.
 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Unbalanced-Output"

\end_inset

Unbalanced Output 
\end_layout

\begin_layout Standard
Storjohann's transformation can be used to efficiently compute a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{\delta-1}$
\end_inset

-basis if the degree parameter 
\begin_inset Formula $\delta$
\end_inset

 is close to the average degree 
\begin_inset Formula $d=m\sigma/n$
\end_inset

.
 However, if 
\begin_inset Formula $\delta$
\end_inset

 is large, say 
\begin_inset Formula $\delta=\Theta\left(\sigma\right)$
\end_inset

, or if we want to compute a complete 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis, then the current analysis for the computation still gives the cost
 estimate of  
\begin_inset Formula $O^{\sim}\left(n^{\omega}\sigma\right)$
\end_inset

.
\end_layout

\begin_layout Standard
The underlying difficulty with computing a complete order basis is that
 the basis can have degree up to 
\begin_inset Formula $\sigma$
\end_inset

.
 As the output of this problem has dimension 
\begin_inset Formula $n\times n$
\end_inset

 and degree up to 
\begin_inset Formula $\Theta\left(\sigma\right)$
\end_inset

, this may seem to suggest 
\begin_inset Formula $O^{\sim}\left(n^{\omega}\sigma\right)$
\end_inset

 is about the best that can be done.
 However, the total size of the output, that is, the total number of coefficient
s of all 
\begin_inset Formula $n^{2}$
\end_inset

 polynomial entries can still be bounded by 
\begin_inset Formula $O\left(mn\sigma\right)$
\end_inset

, the same as the size of the input.
 This gives some hope for a more efficient method.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:size"

\end_inset

Let 
\begin_inset Formula $\vec{t}$
\end_inset

 be the 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 Then 
\begin_inset Formula $\sum_{i}\left(\vec{t}_{i}-\vec{s}_{i}\right)~\le~m\sigma$
\end_inset


\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
 and 
\shape up

\begin_inset Formula $\max_{i}\left(\vec{t}_{i}-\vec{s}_{i}\right)\le\sigma$
\end_inset


\end_layout

\end_inset


\shape up

\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout

\shape up
need to permute the columns to put the pivots on the diagonal.
\end_layout

\end_inset


\shape default
.
 In addition, the total size of any 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis in 
\begin_inset Formula $\vec{s}$
\end_inset

-Popov form is bounded by 
\begin_inset Formula $nm\sigma$
\end_inset

.
 
\end_layout

\begin_layout Proof
This can be shown by considering the sizes of the pivots in the iterative
 order basis computation given in 
\begin_inset CommandInset citation
LatexCommand citep
key "BeLa94,Giorgi2003"

\end_inset

.
 
\begin_inset Note Comment
status open

\begin_layout Plain Layout
Consider the degree of pivot entries in the iterative order basis computation
 from 
\begin_inset CommandInset citation
LatexCommand citet
key "BeLa94"

\end_inset

.
 Starting at order zero, for each order increasing by one, the sum of the
 degrees of all the pivot entries is increased by at most 
\begin_inset Formula $m$
\end_inset

.
 Hence the sum is at most 
\begin_inset Formula $m\sigma$
\end_inset

 after 
\begin_inset Formula $\sigma$
\end_inset

 increases for an order 
\begin_inset Formula $\sigma$
\end_inset

 order basis.
 Now consider any particular column of the basis.
 Each entry in the column has degree bounded by the corresponding pivot
 entry of the row, so the total degree of the entries in the column is bounded
 by 
\begin_inset Formula $m\sigma$
\end_inset

.
 Therefore, the size of any order 
\begin_inset Formula $\sigma$
\end_inset

 basis with 
\begin_inset Formula $n$
\end_inset

 columns is bounded by 
\begin_inset Formula $nm\sigma$
\end_inset

 coefficients.
 
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Plain Layout
As a result, the average degree of the entries of the output matrix can
 be also bounded by 
\begin_inset Formula $d=m\sigma/n$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Let us now look at the average column degree of the output.
 In the first part of this paper, we assumed, without loss of generality,
 that 
\begin_inset Formula $\min\left(\vec{s}\right)=0$
\end_inset

 so 
\begin_inset Formula $\deg\mathbf{q}\le\deg_{\vec{s}}\mathbf{q}$
\end_inset

 for any 
\begin_inset Formula $\mathbf{q}\in\mathbb{K}\left[x\right]^{n}$
\end_inset

.
 The situation is simpler if the shift 
\begin_inset Formula $\vec{s}$
\end_inset

 is uniform since then 
\begin_inset Formula $\sum_{i}\vec{t}_{i}\le m\sigma$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:size"

\end_inset

 and the average column degree is therefore bounded by 
\begin_inset Formula $d=m\sigma/n$
\end_inset

.
 In the first part of this paper, we consider a slightly more general case,
 when the shift 
\begin_inset Formula $\vec{s}$
\end_inset

 is 
\emph on
balanced
\emph default
, which is defined as follows.
 
\end_layout

\begin_layout Definition
A shift 
\begin_inset Formula $\vec{s}$
\end_inset

 is balanced if 
\begin_inset Formula $\max\vec{s}-\min\vec{s}\in O(d)=O(m\sigma/n)$
\end_inset

.
 
\end_layout

\begin_layout Standard
By assuming 
\begin_inset Formula $\min\vec{s}=0$
\end_inset

, 
\begin_inset Formula $\vec{s}$
\end_inset

 is balanced if 
\begin_inset Formula $\max\vec{s}\in O(d)$
\end_inset

.
 In this case, 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:size"

\end_inset

 implies 
\begin_inset Formula $\sum_{i}\left(\vec{t}_{i}\right)\le m\sigma+\sum_{i}\left(\vec{s}_{i}\right)\in O\left(m\sigma+nd\right)=O\left(m\sigma\right)$
\end_inset

.
 Hence the average column degree of the output basis remains 
\begin_inset Formula $O\left(d\right)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%From the iterative algorithms for computing order basis, computing
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%a order basis to order $
\backslash
sigma$ requires up to $
\backslash
sigma$ iterations,
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%each iteration increases the sum of column degrees of the order basis
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%by at most $m$.
 Therefore, the sum of column degrees of an order
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%$
\backslash
sigma$ order basis is at most $m
\backslash
sigma$.
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
In fact, if 
\begin_inset Formula $\mathbf{F}\left(0\right)$
\end_inset

 is full rank, the sum of column degrees of an order 
\begin_inset Formula $\sigma$
\end_inset

 order basis is exactly 
\begin_inset Formula $m\sigma$
\end_inset

, as we need exactly 
\begin_inset Formula $\sigma$
\end_inset

 iterations, each increases the sum of the column degrees by exactly 
\begin_inset Formula $m$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The fact that a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis can have degree up to 
\begin_inset Formula $\sigma$
\end_inset

 while its average column degree is 
\begin_inset Formula $O\left(m\sigma/n\right)$
\end_inset

 implies that an order basis can have quite unbalanced column degrees, especiall
y if 
\begin_inset Formula $m$
\end_inset

 is small.
 A similar problem with unbalanced output is encountered in null space basis
 computation.
 
\begin_inset CommandInset citation
LatexCommand citet
key "storjohann-villard:2005"

\end_inset

 deal with this in the following way.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $d$
\end_inset

 be the average column degree of the output.
 Set the degree parameter 
\begin_inset Formula $\delta$
\end_inset

 to twice that of 
\begin_inset Formula $d$
\end_inset

.
 This allows one to compute at least half the columns of a basis (since
 the number of columns with degree at least 
\begin_inset Formula $\delta$
\end_inset

 must be at most a half of the total number of columns).
 One can then simplify the problem, so that the computed basis elements
 are completely removed from the problem.
 This reduces the dimension of the problem by at least a factor of 
\begin_inset Formula $2$
\end_inset

.
 One then doubles the degree bound 
\begin_inset Formula $\delta$
\end_inset

 in order to have at least 
\begin_inset Formula $3/4$
\end_inset

 of the basis elements computed.
 Repeating this, at iteration 
\begin_inset Formula $i$
\end_inset

, at most 
\begin_inset Formula $1/2^{i}$
\end_inset

 of the basis elements are remaining.
 Therefore, no more than 
\begin_inset Formula $\log n$
\end_inset

 iterations are needed to compute all basis elements.
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%We now have two ideas for efficient computation.
 Storjohann's transformation
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%for balancing the input and Storjohann and Villard's method for handling
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%unbalanced output.
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%In this paper, we discuss a way to compute order basis involving the
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%ideas of 
\backslash
citep{storjohann-villard:2005} and 
\backslash
citep{Storjohann:2006}.
 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Extending Storjohann's Transformation
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:transform"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
notations: 
\end_layout

\begin_layout Itemize
Matrices
\end_layout

\begin_deeper
\begin_layout Itemize
Polynomial matrices: bold capital 
\begin_inset Formula $\mathbf{A,B,F,G,P,R}$
\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\mathbf{F}$
\end_inset

: input matrix,
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\bar{\mathbf{F}}$
\end_inset

: Storjohann transformed matrix, 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\check{\mathbf{F}}$
\end_inset

: the transformation that extends 
\begin_inset Formula $\bar{\mathbf{F}}$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
\begin_inset Formula $\mathbf{G}$
\end_inset

: input matrix for the second subproblem.
 
\end_layout

\end_deeper
\begin_layout Itemize
scalar matrices: non-bold Capital, used to distinguish coefficient matrix
 
\end_layout

\begin_layout Itemize
Identity matrix: 
\begin_inset Formula $\mathbf{I}$
\end_inset

 this is to be consistent with polynomial matrices, as identity is considered
 as an important element of polynomial matrices.
 
\end_layout

\end_deeper
\begin_layout Itemize
order
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\sigma,\omega$
\end_inset

 
\end_layout

\end_deeper
\begin_layout Itemize
vectors
\end_layout

\begin_deeper
\begin_layout Itemize
polynomial vectors: 
\begin_inset Formula $\mathbf{p,q,r,s,t}$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{p}$
\end_inset

: element in basis 
\begin_inset Formula $\mathbf{P}$
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{q}:$
\end_inset

 some test element in 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma\right)\right\rangle $
\end_inset

 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\bar{\mathbf{t}}$
\end_inset

: test element in 
\begin_inset Formula $\left\langle \left(\check{\mathbf{F}},\vec{\omega}\right)\right\rangle $
\end_inset

 
\end_layout

\end_deeper
\begin_layout Itemize
shifts:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\vec{e}$
\end_inset

: uniform 0 shift used for transformation.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\vec{s}$
\end_inset

: original input shift 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\vec{t}$
\end_inset

: output shifted degrees of the current basis, with result from previous
 subproblems included.
 i.e., 
\begin_inset Formula $\left[\vec{s},0,\dots,0\right]$
\end_inset

-degrees of the current basis.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\vec{b},\vec{a}$
\end_inset

: input shift and output shifted degrees for each reduced subproblem that
 calls OrderBasis.
 In the iterative computational process, input shift 
\begin_inset Formula $\vec{b}^{\left(i-1\right)}$
\end_inset

 corresponds to input shift 
\begin_inset Formula $\vec{a}^{\left(i\right)}$
\end_inset

.
 The high degree entries of 
\begin_inset Formula $\vec{a}^{\left(i\right)}$
\end_inset

 at iteration 
\begin_inset Formula $i$
\end_inset

 is then used as the input shift 
\begin_inset Formula $\vec{b}^{\left(i\right)}$
\end_inset

 for iteration 
\begin_inset Formula $i$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Itemize
dimension:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $m,n$
\end_inset

: row, column dimension 
\end_layout

\begin_layout Itemize
\begin_inset Formula $k$
\end_inset

: number of columns with 
\begin_inset Formula $\left[\vec{s},0,\dots,0\right]$
\end_inset

-degrees less than degree bound 
\end_layout

\begin_layout Itemize
\begin_inset Formula $l$
\end_inset

: number of block rows 
\end_layout

\end_deeper
\begin_layout Itemize
degrees, order:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\sigma$
\end_inset

: order 
\end_layout

\begin_layout Itemize
\begin_inset Formula $\delta$
\end_inset

: degree bound 
\end_layout

\begin_layout Itemize
\begin_inset Formula $d$
\end_inset

: average degree (=
\begin_inset Formula $m\sigma/n$
\end_inset

) 
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Standard
In this section, we introduce a transformation that can be viewed as an
 extension of Storjohann's transformation which allows for computation of
 a full, rather than partial, order basis.
 More generally (as discussed in the next section) this transformation provides
 a link between two Storjohann transformed problems constructed using different
 degree parameters.
 For easier understanding, we first focus on a particular case of this transform
ation in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sub:particularCase"

\end_inset

 and then generalize this in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sub:generalTransform"

\end_inset

.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:particularCase"

\end_inset

A Particular Case
\end_layout

\begin_layout Standard
Consider the problem of computing a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 We assume 
\begin_inset Formula $\sigma=4\delta$
\end_inset

 
\begin_inset Note Comment
status open

\begin_layout Plain Layout
(The results below hold for any positive integer great than one, but 4 is
 used for simplicity.
 ) 
\end_layout

\end_inset

for a positive integer 
\begin_inset Formula $\delta$
\end_inset

 and write the input matrix polynomial as 
\begin_inset Formula $\mathbf{F}=\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta}+\mathbf{F}_{2}x^{2\delta}+\mathbf{F}_{3}x^{3\delta}$
\end_inset

 with 
\begin_inset Formula $\deg\mathbf{F}_{i}<\delta$
\end_inset

.
\begin_inset Note Comment
status open

\begin_layout Plain Layout
again, changed from 
\begin_inset Formula $\deg\mathbf{F}_{i}\le\delta-1$
\end_inset

 to 
\begin_inset Formula $\deg\mathbf{F}_{i}<\delta$
\end_inset

 even though I prefer 
\begin_inset Formula $\le$
\end_inset

 
\end_layout

\end_inset

 In the following, we show that computing a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis can be done by computing a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis where 
\begin_inset Formula \begin{equation}
\mathbf{F}'=\left[\begin{array}{cc}
\mathbf{F} & \mathbf{0}\\
\mathbf{F}'_{21} & \mathbf{F}'_{22}\end{array}\right]=\left[\begin{array}{c|cr}
\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta}+\mathbf{F}_{2}x^{2\delta}+\mathbf{F}_{3}x^{3\delta} & \mathbf{0} & \mathbf{0}\\
\hline \mathbf{F}_{1}+\mathbf{F}_{2}x^{\delta} & \mathbf{I}_{m} & \mathbf{0}\\
\mathbf{F}_{2}+\mathbf{F}_{3}x^{\delta} & \mathbf{0} & \mathbf{I}_{m}\end{array}\right]\label{eq:extendedSTransformTop}\end{equation}

\end_inset

 with order 
\begin_inset Formula $\vec{\omega}=\left[4\delta,\dots,4\delta,2\delta,\dots,2\delta\right]$
\end_inset

 (with 
\begin_inset Formula $m$
\end_inset

 
\begin_inset Formula $4\delta$
\end_inset

's and 
\begin_inset Formula $2m$
\end_inset

 
\begin_inset Formula $2\delta$
\end_inset

's) and degree shift 
\begin_inset Formula $\vec{s'}=\left[\vec{s},e,\dots,e\right]$
\end_inset

 (with 
\begin_inset Formula $2m$
\end_inset

 
\begin_inset Formula $e$
\end_inset

's), where 
\begin_inset Formula $e$
\end_inset

 is an integer less than or equal to 
\begin_inset Formula $1$
\end_inset

.
 
\begin_inset Note Comment
status open

\begin_layout Plain Layout
actually true for 
\begin_inset Formula $e\le\min\vec{s}+1$
\end_inset

.
 keeping this 
\begin_inset Formula $e$
\end_inset

 helps to show that this hold true in more general situations, while Storjohann
 only used 
\begin_inset Formula $e=1$
\end_inset

.
 it can be negative as well.
 
\end_layout

\end_inset

 We set 
\begin_inset Formula $e$
\end_inset

 to 
\begin_inset Formula $0$
\end_inset

 in this paper for simplicity
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Storjohann used 
\begin_inset Formula $e=1$
\end_inset

 in 
\begin_inset CommandInset citation
LatexCommand citep
key "Storjohann:2006"

\end_inset

.
 All results in this section still hold for any other 
\begin_inset Formula $e\le1.$
\end_inset


\end_layout

\end_inset

.
 
\begin_inset Note Comment
status open

\begin_layout Plain Layout
In fact, it is quite easy to construct a 
\begin_inset Formula $(\check{\mathbf{F}},\vec{\omega},\vec{s'})$
\end_inset

-basis from a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis, as we show later in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:FtoAbasis"

\end_inset

.
 However, it requires more work to extract a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis from a 
\begin_inset Formula $(\check{\mathbf{F}},\vec{\omega},\vec{s'})$
\end_inset

-basis, which is addressed eventually in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:extractingFbasisFromGbasis"

\end_inset

.
 Note that although constructing a 
\begin_inset Formula $(\check{\mathbf{F}},\vec{\omega},\vec{s'})$
\end_inset

-basis from a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:FtoAbasis"

\end_inset

 is the reverse of what we want, this well-formed 
\begin_inset Formula $(\check{\mathbf{F}},\vec{\omega},\vec{s'})$
\end_inset

-basis restricts the elements of 
\begin_inset Formula $\langle(\check{\mathbf{F}},\vec{\omega},\vec{s'})\rangle$
\end_inset

 to a simple form shown in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:FtauBasisForm"

\end_inset

, which helps to establish a close correspondence between a 
\begin_inset Formula $(\check{\mathbf{F}},\vec{\omega},\vec{s'})$
\end_inset

-basis and a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:2delta-1Basis"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:2deltaBasis"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:mainTheorem"

\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
We first look at the correspondence bettween the elements of 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{\tau}$
\end_inset

 and the elements of 
\begin_inset Formula $\langle(\mathbf{F}',\vec{\omega},\vec{s'})\rangle_{\tau}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:qToBqOrder"

\end_inset

 to 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:bqToqOrder"

\end_inset

.
 The correspondence between 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-bases and 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-bases is then considered in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:FtauBasisForm"

\end_inset

 to 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:mainTheorem"

\end_inset

.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula \[
\mathbf{B}=\left[\begin{array}{c}
\mathbf{I}_{n}\\
x^{-\delta}\mathbf{F}_{0}\\
x^{-2\delta}\left(\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta}\right)\end{array}\right].\]

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:qToBqOrder"

\end_inset

If 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma\right)\right\rangle $
\end_inset

, then 
\begin_inset Formula $\mathbf{B}\mathbf{q}\in\langle(\mathbf{F}'\vec{,\omega})\rangle$
\end_inset

.
\end_layout

\begin_layout Proof
The lemma follows from 
\begin_inset Formula \[
\mathbf{F}'\mathbf{B}\mathbf{q}=\left[\begin{array}{r}
\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta}+\mathbf{F}_{2}x^{2\delta}+\mathbf{F}_{3}x^{3\delta}\\
\mathbf{F}_{0}x^{-\delta}+\mathbf{F}_{1}+\mathbf{F}_{2}x^{\delta}\\
\mathbf{F}_{0}x^{-2\delta}+\mathbf{F}_{1}x^{-\delta}+\mathbf{F}_{2}+\mathbf{F}_{3}x^{\delta}\end{array}\right]\mathbf{q}\equiv\mathbf{0}\mod x^{\vec{\omega}}.\]

\end_inset

 Note that the bottom rows of 
\begin_inset Formula $\mathbf{B}$
\end_inset

 may not be polynomials.
 However, 
\begin_inset Formula $\mathbf{B}\mathbf{q}$
\end_inset

 is a polynomial vector since 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma\right)\right\rangle $
\end_inset

 implies 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F}_{0},\delta\right)\right\rangle $
\end_inset

 and 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta},2\delta\right)\right\rangle $
\end_inset

.
 
\end_layout

\begin_layout Standard
\noindent
The following lemma shows that the condition 
\begin_inset Formula $e\le1$
\end_inset

 forces 
\begin_inset Formula $\deg_{\vec{s'}}\mathbf{B}\mathbf{q}$
\end_inset

 to be determined by 
\begin_inset Formula $\mathbf{q}$
\end_inset

.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:qToBqDegree"

\end_inset

If 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{\tau}$
\end_inset

 for any degree bound 
\begin_inset Formula $\tau\in\mathbb{Z}$
\end_inset

, then 
\begin_inset Formula $\deg_{\vec{s'}}\mathbf{B}\mathbf{q}=\deg_{\vec{s}}\mathbf{q}$
\end_inset

.
\end_layout

\begin_layout Proof
By assumption 
\begin_inset Formula $s_{i}\ge0$
\end_inset

, so 
\begin_inset Formula $\deg\mathbf{q}\le\deg_{\vec{s}}\mathbf{q}.$
\end_inset

 Now consider the degree of the bottom 
\begin_inset Formula $2m$
\end_inset

 entries, 
\begin_inset Formula $\mathbf{q}_{2},\mathbf{q}_{3}$
\end_inset

, of 
\begin_inset Formula \[
\begin{bmatrix}\mathbf{q}\\
\mathbf{q}_{2}\\
\mathbf{q}_{3}\end{bmatrix}=\mathbf{B}\mathbf{q}=\left[\begin{array}{r}
\mathbf{q}\\
x^{-\delta}\mathbf{F}_{0}\cdot\mathbf{q}\\
x^{-2\delta}\left(\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta}\right)\cdot\mathbf{q}\end{array}\right].\]

\end_inset

 Our goal is to show 
\begin_inset Formula $\deg_{\vec{e}}\left[\mathbf{q}_{2}^{T},\mathbf{q}_{3}^{T}\right]^{T}\le\deg_{\vec{s}}\mathbf{q}$
\end_inset

.
 Note that 
\begin_inset Formula \[
\deg\mathbf{q}_{2}=\deg\left(\mathbf{F}_{0}\mathbf{q}/x^{\delta}\right)\le\deg\mathbf{q}+\delta-1-\delta\le\deg_{\vec{s}}\mathbf{q}-1,\]

\end_inset

 and similarly 
\begin_inset Formula $\deg\mathbf{q}_{3}\le\deg_{\vec{s}}\mathbf{q}-1$
\end_inset

.
 Therefore 
\begin_inset Formula \[
\deg_{\vec{e}}\begin{bmatrix}\mathbf{q}_{2}\\
\mathbf{q}_{3}\end{bmatrix}=\deg\begin{bmatrix}\mathbf{q}_{2}\\
\mathbf{q}_{3}\end{bmatrix}+e\le\deg_{\vec{s}}\mathbf{q}-1+e\le\deg_{\vec{s}}\mathbf{q}.\]

\end_inset

 
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:sToBs"

\end_inset

If 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{\tau}$
\end_inset

 for any degree bound 
\begin_inset Formula $\tau\in\mathbb{Z}$
\end_inset

 , then
\shape up
 
\shape default

\begin_inset Formula $\mathbf{B}\mathbf{q}\in\langle(\mathbf{F}',\vec{\omega},\vec{s'})\rangle_{\tau}$
\end_inset


\shape up
.

\shape default
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
begin{pf}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%This follows from 
\backslash
prettyref{lem:qToBqOrder} and 
\backslash
prettyref{lem:qToBqDegree}.
\backslash
end{pf}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:linearCombinationOfFirstnRows"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{S}}_{\tau}$
\end_inset

 be a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})_{\tau}$
\end_inset

-basis and 
\begin_inset Formula $\mathbf{S}_{\tau}$
\end_inset

 be the top 
\begin_inset Formula $n$
\end_inset

 rows of 
\begin_inset Formula $\bar{\mathbf{S}}_{\tau}$
\end_inset

 for any bound 
\begin_inset Formula $\tau\in\mathbb{Z}$
\end_inset

.
 Then any 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{\tau}$
\end_inset

 is a linear combination of the columns of 
\begin_inset Formula $\mathbf{S}_{\tau}$
\end_inset

.
\end_layout

\begin_layout Proof
By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:sToBs"

\end_inset

, 
\begin_inset Formula $\mathbf{B}\mathbf{q}\in\langle(\mathbf{F}',\vec{\omega},\vec{s'})\rangle_{\tau}$
\end_inset

, and so is a linear combination of columns of 
\begin_inset Formula $\bar{\mathbf{S}}_{\tau}$
\end_inset

.
 That is, there exists a polynomial vector 
\begin_inset Formula $\mathbf{u}$
\end_inset

 such that 
\begin_inset Formula $\mathbf{B}\mathbf{q}=\bar{\mathbf{S}}_{\tau}\mathbf{u}$
\end_inset

.
 This remains true if we restrict the equation to the top 
\begin_inset Formula $n$
\end_inset

 rows, that is, 
\begin_inset Formula $\mathbf{q}=\left[\mathbf{I}_{n},\mathbf{0}\right]\mathbf{B}\mathbf{q}=\left[\mathbf{I}_{n},\mathbf{0}\right]\bar{\mathbf{S}}_{\tau}\mathbf{u}=\mathbf{S}_{\tau}\mathbf{u}$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:bqToqOrder"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{q}}\in\langle(\mathbf{F}',\vec{\omega},\vec{s'})\rangle_{\tau}$
\end_inset

 for any degree bound 
\begin_inset Formula $\tau\in\mathbb{Z}$
\end_inset

, and 
\begin_inset Formula $\mathbf{q}_{1}$
\end_inset

 the first 
\begin_inset Formula $n$
\end_inset

 entries of 
\begin_inset Formula $\mathbf{\bar{q}}$
\end_inset

.
 Then 
\begin_inset Formula $\mathbf{q}_{1}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{\tau}$
\end_inset

.
\end_layout

\begin_layout Proof
The top rows of 
\begin_inset Formula \[
\mathbf{F}'\mathbf{q}=\left[\begin{array}{cc}
\mathbf{F} & \mathbf{0}\\
\mathbf{F}'_{21} & \mathbf{F}'_{22}\end{array}\right]\left[\begin{array}{c}
\mathbf{q}_{1}\\
\mathbf{q}_{2}\end{array}\right]=\begin{bmatrix}\mathbf{F}\mathbf{q}_{1}\\
\mathbf{F}'_{21}\mathbf{q}_{1}+\mathbf{F}'_{22}\mathbf{q}_{2}\end{bmatrix}\equiv\mathbf{0}\mod x^{\vec{\omega}}\]

\end_inset

 give 
\begin_inset Formula $\mathbf{F}\mathbf{q}_{1}\equiv\mathbf{0}\mod x^{\sigma}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The next lemma shows a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis can be constructed from a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 This well-formed 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis restricts the elements of 
\begin_inset Formula $\langle(\mathbf{F}',\vec{\omega},\vec{s'})\rangle$
\end_inset

 to a simple form shown in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:FtauBasisForm"

\end_inset

.
 This in turn helps to establish a close correspondence between a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis and a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:2delta-1Basis"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:2deltaBasis"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:mainTheorem"

\end_inset

.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:FtoAbasis"

\end_inset

If 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis, then 
\begin_inset Formula \begin{eqnarray*}
\bar{\mathbf{T}} & = & \left[\mathbf{B}\mathbf{P}~\begin{array}{|c}
\mathbf{0}_{n\times2m}\\
x^{2\delta}\mathbf{I}_{2m}\end{array}\right]=\left[\begin{array}{r|cc}
\mathbf{P} & \mathbf{0}_{n\times m} & \mathbf{0}_{n\times m}\\
\hline x^{-\delta}\mathbf{F}_{0}\cdot\mathbf{P} & x^{2\delta}\mathbf{I}_{m} & \mathbf{0}_{m}\\
x^{-2\delta}\left(\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta}\right)\cdot\mathbf{P} & \mathbf{0}_{m} & x^{2\delta}\mathbf{I}_{m}\end{array}\right]\end{eqnarray*}

\end_inset

 is a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis.
\end_layout

\begin_layout Proof
By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:qToBqOrder"

\end_inset

, 
\begin_inset Formula $\bar{\mathbf{T}}$
\end_inset

 has order 
\begin_inset Formula $(\mathbf{F}',\vec{\omega})$
\end_inset

 and is 
\begin_inset Formula $\vec{s'}$
\end_inset

-column reduced since 
\begin_inset Formula $\mathbf{P}$
\end_inset

 dominates the 
\begin_inset Formula $\vec{s'}$
\end_inset

-degrees of 
\begin_inset Formula $\bar{\mathbf{T}}$
\end_inset

 on the left side by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:qToBqDegree"

\end_inset

.
 It remains to show that any 
\begin_inset Formula $\bar{\mathbf{q}}\in\langle(\mathbf{F}',\vec{\omega},\vec{s'})\rangle$
\end_inset

 is a linear combination of the columns of 
\begin_inset Formula $\mathbf{\bar{\mathbf{T}}}$
\end_inset

.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $\mathbf{q}$
\end_inset

 be the top 
\begin_inset Formula $n$
\end_inset

 entries of 
\begin_inset Formula $\bar{\mathbf{q}}$
\end_inset

.
 Then by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:bqToqOrder"

\end_inset

, 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

, hence is a linear combination of the columns of 
\begin_inset Formula $\mathbf{P}$
\end_inset

, that is 
\begin_inset Formula $\mathbf{q}=\mathbf{P}\mathbf{u}$
\end_inset

 with 
\begin_inset Formula $\mathbf{u}=\mathbf{P}^{-1}\mathbf{q}\in\mathbb{K}\left[x\right]^{n\times1}$
\end_inset

.
 Subtracting the contribution of 
\begin_inset Formula $\mathbf{P}$
\end_inset

 from 
\begin_inset Formula $\bar{\mathbf{q}}$
\end_inset

, we get 
\begin_inset Formula \[
\mathbf{q}'=\bar{\mathbf{q}}-\mathbf{B}\mathbf{P}\mathbf{u}=\bar{\mathbf{q}}-\mathbf{B}\mathbf{q}=\left[\begin{array}{c}
\mathbf{0}\\
\mathbf{v}\end{array}\right],\]

\end_inset

 which is still in 
\begin_inset Formula $\langle(\mathbf{F}',\vec{\omega},\vec{s'})\rangle$
\end_inset

, that is, 
\begin_inset Formula \[
\mathbf{F}'\mathbf{q}'=\begin{bmatrix}\mathbf{0}\\
\mathbf{I}_{2m}\mathbf{v}\end{bmatrix}\equiv\mathbf{0}\mod x^{\vec{\omega}}.\]

\end_inset

 This forces 
\begin_inset Formula $\mathbf{v}$
\end_inset

 to be a linear combination of the columns of 
\begin_inset Formula $x^{2\delta}\mathbf{I}_{2m}$
\end_inset

, the bottom right submatrix of 
\begin_inset Formula $\bar{\mathbf{T}}$
\end_inset

.
 Now 
\begin_inset Formula $\bar{\mathbf{q}}=\bar{\mathbf{T}}\left[\mathbf{u}^{T},\mathbf{v}^{T}\right]^{T}$
\end_inset

 as required.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:FtauBasisForm"

\end_inset

Let 
\begin_inset Formula $\tau\in\mathbb{Z}$
\end_inset

 be any degree bound and 
\begin_inset Formula $\mathbf{P}_{\tau}\in\mathbb{K}\left[x\right]^{n\times t}$
\end_inset

 be a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{\tau}$
\end_inset

-basis.
 If 
\begin_inset Formula $\bar{\mathbf{q}}\in\langle(\mathbf{F}',\vec{\omega},\vec{s'})\rangle_{\tau}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}$
\end_inset

 is the top 
\begin_inset Formula $n$
\end_inset

 entries of 
\begin_inset Formula $\bar{\mathbf{q}}$
\end_inset

, then 
\begin_inset Formula $\bar{\mathbf{q}}$
\end_inset

 must have the form 
\begin_inset Formula \[
\bar{\mathbf{q}}=\mathbf{B}\mathbf{P}_{\tau}\mathbf{u}+x^{2\delta}\begin{bmatrix}\mathbf{0}\\
\mathbf{v}\end{bmatrix}=\mathbf{B}\mathbf{q}+x^{2\delta}\begin{bmatrix}\mathbf{0}\\
\mathbf{v}\end{bmatrix}\]

\end_inset

 for some polynomial vector 
\begin_inset Formula $\mathbf{u}\in\mathbb{K}\left[x\right]^{t\times1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}\in\mathbb{K}\left[x\right]^{2m\times1}$
\end_inset

.
 In particular, if 
\begin_inset Formula $\deg_{\vec{s'}}\bar{\mathbf{q}}<2\delta$
\end_inset

, then 
\begin_inset Formula $\bar{\mathbf{q}}=\mathbf{B}\mathbf{P}_{\tau}\mathbf{u}=\mathbf{B}\mathbf{q}$
\end_inset

.
 
\end_layout

\begin_layout Proof
This follows directly from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:FtoAbasis"

\end_inset

 with 
\begin_inset Formula $\vec{s'}$
\end_inset

-degrees restricted to 
\begin_inset Formula $\tau$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:2delta-1Basis"

\end_inset

If 
\begin_inset Formula $\bar{\mathbf{S}}^{\left(1\right)}$
\end_inset

 is a 
\begin_inset Formula $(\check{\mathbf{F}},\vec{\omega},\vec{s'})_{2\delta-1}$
\end_inset

-basis, then the matrix 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

 consisting of its first 
\begin_inset Formula $n$
\end_inset

 rows is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{2\delta-1}$
\end_inset

-basis.
\end_layout

\begin_layout Proof
By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:bqToqOrder"

\end_inset

, 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:linearCombinationOfFirstnRows"

\end_inset

, any 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{2\delta-1}$
\end_inset

 is a linear combination of 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

.
 It remains to show that 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

 is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
\end_layout

\begin_layout Proof
By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:FtauBasisForm"

\end_inset

, 
\begin_inset Formula $\bar{\mathbf{S}}^{\left(1\right)}=\mathbf{B}\mathbf{S}^{\left(1\right)}$
\end_inset

, and by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:bqToqOrder"

\end_inset

, the columns of 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

 are in 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{2\delta-1}$
\end_inset

.
 Thus, by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:qToBqDegree"

\end_inset

, 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

 determines the 
\begin_inset Formula $\vec{s'}$
\end_inset

-column degrees of 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

.
 Therefore, 
\begin_inset Formula $\bar{\mathbf{S}}^{\left(1\right)}$
\end_inset

 being 
\begin_inset Formula $\vec{s'}$
\end_inset

-column reduced implies that 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

 is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:2deltaBasis"

\end_inset

 Let 
\begin_inset Formula $\bar{\mathbf{S}}^{\left(12\right)}=[\bar{\mathbf{S}}^{\left(1\right)},\bar{\mathbf{S}}^{\left(2\right)}]$
\end_inset

 be a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})_{2\delta}$
\end_inset

-basis, with 
\begin_inset Formula $\deg_{\vec{s'}}\bar{\mathbf{S}}^{\left(1\right)}\le2\delta-1$
\end_inset

 and 
\begin_inset Formula $\deg_{\vec{s'}}\bar{\mathbf{S}}^{\left(2\right)}=2\delta$
\end_inset

, and 
\begin_inset Formula $\mathbf{S}^{\left(12\right)},\mathbf{S}^{\left(1\right)},\mathbf{S}^{\left(2\right)}$
\end_inset

 the first 
\begin_inset Formula $n$
\end_inset

 rows of 
\begin_inset Formula $\bar{\mathbf{S}}^{\left(12\right)},\bar{\mathbf{S}}^{\left(1\right)},\bar{\mathbf{S}}^{\left(2\right)}$
\end_inset

, respectively.
 Let 
\begin_inset Formula $I$
\end_inset

 be the column rank profile (the lexicographically smallest sequence of
 column indices that indicates a full column rank submatrix) of 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%which contains all columns of $
\backslash
mathbf{S}^{
\backslash
left(1
\backslash
right)}$ by 
\backslash
prettyref{lem:2delta-1Basis}.
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Then the submatrix
\series bold
 
\begin_inset Formula $\mathbf{S}_{I}^{\left(12\right)}$
\end_inset

 
\series default
comprised of the columns of 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

 indexed by 
\begin_inset Formula $I$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{2\delta}$
\end_inset

-basis.
 
\end_layout

\begin_layout Proof
Consider doing 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduction on 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

.
 From 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:2delta-1Basis"

\end_inset

, we know that 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{2\delta-1}$
\end_inset

-basis.
 Therefore, only 
\begin_inset Formula $\mathbf{S}^{\left(2\right)}$
\end_inset

 may be 
\begin_inset Formula $\vec{s}$
\end_inset

-reduced.
 If a column 
\begin_inset Formula $\mathbf{c}$
\end_inset

 of 
\begin_inset Formula $\mathbf{S}^{\left(2\right)}$
\end_inset

 can be further 
\begin_inset Formula $\vec{s}$
\end_inset

-reduced, then it becomes an element of 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{2\delta-1}$
\end_inset

, which is generated by 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

.
 Thus 
\begin_inset Formula $\mathbf{c}$
\end_inset

 must be reduced to zero by 
\begin_inset Formula $\mathbf{S}^{\left(1\right)}$
\end_inset

.
 The only nonzero columns of 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

 remaining after 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduction are therefore the columns that cannot be 
\begin_inset Formula $\vec{s}$
\end_inset

-reduced.
 Hence 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

 
\begin_inset Formula $\vec{s}$
\end_inset

-reduces to 
\series bold

\begin_inset Formula $\mathbf{S}_{I}^{\left(12\right)}$
\end_inset


\series default
.
 In addition, 
\series bold

\begin_inset Formula $\mathbf{S}_{I}^{\left(12\right)}$
\end_inset


\series default
 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

 as 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:bqToqOrder"

\end_inset

.
 From 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:linearCombinationOfFirstnRows"

\end_inset

 any 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{2\delta}$
\end_inset

 is a linear combination of 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

 and hence is also a linear combination of 
\begin_inset Formula $\mathbf{S}_{I}^{\left(12\right)}$
\end_inset

.
 
\end_layout

\begin_layout Standard
To extract 
\begin_inset Formula $\mathbf{S}_{I}^{\left(12\right)}$
\end_inset

 from 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

, note that doing 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduction on 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

 is equivalent to the more familiar problem of doing column reduction on
 
\begin_inset Formula $x^{\vec{s}}\mathbf{S}^{\left(12\right)}$
\end_inset

.
 As 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduces to 
\series bold

\begin_inset Formula $\mathbf{S}_{I}^{\left(12\right)}$
\end_inset


\series default
, this corresponds to determining the column rank profile of the
\emph on
 leading column coefficient matrix 
\emph default
of
\emph on
 
\series bold
\emph default

\begin_inset Formula $x^{\vec{s}}\mathbf{S}^{\left(12\right)}$
\end_inset


\series default

\begin_inset Note Comment
status open

\begin_layout Plain Layout

\emph on
 
\emph default

\begin_inset Formula $S^{\left(12\right)}=\lcoeff(x^{\vec{s}}\cdot\mathbf{S}^{\left(12\right)})$
\end_inset

 
\end_layout

\end_inset


\emph on
.
 
\emph default
Recall that the leading column coefficient matrix of a matrix 
\begin_inset Formula $\mathbf{A}=\left[\mathbf{a}_{1},\dots,\mathbf{a}_{k}\right]$
\end_inset

 used for column reduction is
\emph on
 
\begin_inset Formula \begin{eqnarray*}
\lcoeff\left(\mathbf{A}\right) & = & \left[\lcoeff\left(\mathbf{a}_{1}\right),\dots,\lcoeff\left(\mathbf{a}_{k}\right)\right]\\
 & = & \left[\coeff\left(\mathbf{a}_{1},\deg\left(\mathbf{a}_{1}\right)\right),\dots,\coeff\left(\mathbf{a}_{k},\deg\left(\mathbf{a}_{k}\right)\right)\right].\end{eqnarray*}

\end_inset

 
\emph default
The column rank profile of 
\begin_inset Formula $\lcoeff(x^{\vec{s}}\mathbf{S}^{\left(12\right)})$
\end_inset

 can be determined by (the transposed version of) LSP factorization 
\begin_inset CommandInset citation
LatexCommand citep
key "IbarraMH82"

\end_inset

, which factorizes 
\begin_inset Formula $\lcoeff(x^{\vec{s}}\mathbf{S}^{\left(12\right)})=PSU$
\end_inset

 as the product of a permutation matrix 
\begin_inset Formula $P$
\end_inset

, a matrix 
\begin_inset Formula $S$
\end_inset

 with its nonzero columns forming a lower triangular submatrix, and an upper
 triangular matrix 
\begin_inset Formula $U$
\end_inset

 with 
\begin_inset Formula $1$
\end_inset

's on the diagonal.
 The indices, 
\begin_inset Formula $I$
\end_inset

, of the nonzero columns of 
\begin_inset Formula $S$
\end_inset

 then give 
\begin_inset Formula $\mathbf{S}_{I}^{\left(12\right)}$
\end_inset

 in 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:mainTheorem"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{S}}=[\bar{\mathbf{S}}^{\left(12\right)},\bar{\mathbf{S}}^{\left(3\right)}]$
\end_inset

 be a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis, with 
\begin_inset Formula $\deg_{\vec{s'}}\bar{\mathbf{S}}^{\left(12\right)}\le2\delta$
\end_inset

 and 
\begin_inset Formula $\deg_{\vec{s'}}\bar{\mathbf{S}}^{\left(3\right)}\ge2\delta+1$
\end_inset

, and 
\begin_inset Formula $\mathbf{S},\mathbf{S}^{\left(12\right)},\mathbf{S}^{\left(3\right)}$
\end_inset

 the first 
\begin_inset Formula $n$
\end_inset

 rows of 
\begin_inset Formula $\bar{\mathbf{S}},\bar{\mathbf{S}}^{\left(12\right)},\bar{\mathbf{S}}^{\left(3\right)}$
\end_inset

, respectively.
 If 
\begin_inset Formula $I$
\end_inset

 is the column rank profile of 
\begin_inset Formula $\mathbf{S}^{\left(12\right)}$
\end_inset

, then the submatrix 
\series bold
 
\begin_inset Formula $[\mathbf{S}_{I}^{\left(12\right)},\mathbf{S}^{\left(3\right)}]$
\end_inset

 
\series default
of 
\begin_inset Formula $\mathbf{S}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 
\end_layout

\begin_layout Proof
By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:bqToqOrder"

\end_inset

, 
\begin_inset Formula $\mathbf{S}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

, and so 
\begin_inset Formula $[\mathbf{S}_{I}^{\left(12\right)},\mathbf{S}^{\left(3\right)}]$
\end_inset

 also has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:linearCombinationOfFirstnRows"

\end_inset

, any 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

 is a linear combination of the columns of 
\begin_inset Formula $\mathbf{S}$
\end_inset

, and so 
\begin_inset Formula $\mathbf{q}$
\end_inset

 is also a linear combination of the columns of 
\begin_inset Formula $[\mathbf{S}_{I}^{\left(12\right)},\mathbf{S}^{\left(3\right)}]$
\end_inset

.
 It only remains to show that 
\begin_inset Formula $[\mathbf{S}_{I}^{\left(12\right)},\mathbf{S}^{\left(3\right)}]$
\end_inset

 is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $\mathbf{P}$
\end_inset

 be a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis and 
\begin_inset Formula $\mathbf{\bar{\mathbf{T}}}$
\end_inset

 be the 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis constructed from 
\begin_inset Formula $\mathbf{P}$
\end_inset

 as in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:FtoAbasis"

\end_inset

.
 Let 
\begin_inset Formula $\bar{\mathbf{T}}^{\left(3\right)}$
\end_inset

 be the columns of 
\begin_inset Formula $\bar{\mathbf{T}}$
\end_inset

 with 
\begin_inset Formula $\vec{s'}$
\end_inset

-degrees greater than 
\begin_inset Formula $2\delta,$
\end_inset

 and 
\begin_inset Formula $\mathbf{P}^{\left(3\right)}$
\end_inset

 be the columns of 
\begin_inset Formula $\mathbf{P}$
\end_inset

 with 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees greater than 
\begin_inset Formula $2\delta.$
\end_inset

 Assume without loss of generality that 
\begin_inset Formula $\mathbf{S},$
\end_inset

 
\begin_inset Formula $\mathbf{P}$
\end_inset

, and 
\begin_inset Formula $\bar{\mathbf{T}}$
\end_inset

 have their columns sorted according to their 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees and 
\begin_inset Formula $\vec{s'}$
\end_inset

-degrees, respectively.
 Then 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{S}^{\left(3\right)}\le\deg_{\vec{s'}}\bar{\mathbf{S}}^{\left(3\right)}=\deg_{\vec{s'}}\bar{\mathbf{T}}^{\left(3\right)}=\deg_{\vec{s}}\mathbf{P}^{\left(3\right)}$
\end_inset

.
 Combining this with the 
\begin_inset Formula $\vec{s}$
\end_inset

-minimality of 
\begin_inset Formula $\mathbf{S}_{I}^{\left(12\right)}$
\end_inset

 from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:2deltaBasis"

\end_inset

, it follows that 
\begin_inset Formula $\deg_{\vec{s}}[\mathbf{S}_{I}^{\left(12\right)},\mathbf{S}^{\left(3\right)}]\le\deg_{\vec{s}}\mathbf{P}$
\end_inset

.
 This combined with the fact that 
\begin_inset Formula $[\mathbf{S}_{I}^{\left(12\right)},\mathbf{S}^{\left(3\right)}]$
\end_inset

 still generates 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

 implies that 
\begin_inset Formula $\deg_{\vec{s}}[\mathbf{S}_{I}^{\left(12\right)},\mathbf{S}^{\left(3\right)}]=\deg_{\vec{s}}\mathbf{P}$
\end_inset

.
 Therefore, 
\begin_inset Formula $[\mathbf{S}_{I}^{\left(12\right)},\mathbf{S}^{\left(3\right)}]$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:extractingFbasisFromGbasis"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{S}}$
\end_inset

 be a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis with its columns sorted in an increasing order of their 
\begin_inset Formula $\vec{s'}$
\end_inset

 degrees, and 
\begin_inset Formula $\mathbf{S}$
\end_inset

 the first 
\begin_inset Formula $n$
\end_inset

 rows of 
\begin_inset Formula $\bar{\mathbf{S}}$
\end_inset

.
 If 
\begin_inset Formula $J$
\end_inset

 is the column rank profile of 
\begin_inset Formula $\lcoeff(x^{\vec{s}}\mathbf{S})$
\end_inset

, then the submatrix 
\begin_inset Formula $\mathbf{S}_{J}$
\end_inset

 of 
\begin_inset Formula $\mathbf{S}$
\end_inset

 indexed by 
\begin_inset Formula $J$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
\end_layout

\begin_layout Proof
This follows directly from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:mainTheorem"

\end_inset

.
 
\end_layout

\begin_layout Standard
This rank profile 
\begin_inset Formula $J$
\end_inset

 can be determined by LSP factorization on 
\begin_inset Formula $\lcoeff(x^{\vec{s}}\cdot\mathbf{S}^{\left(12\right)})$
\end_inset

.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%as discussed before.
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exm:auxiliaryTransformation"

\end_inset

For the problem in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:StorjohannTransformation"

\end_inset

, 
\begin_inset Formula $\check{\mathbf{F}}$
\end_inset

 is given by 
\begin_inset Formula \begin{align*}
 & \left[{\begin{array}{cccccr}
x+x^{2}+x^{3}+x^{4}+x^{5}+x^{6} & \ 1+x+x^{5}+x^{6}+x^{7}\  & 1+x^{2}+x^{6}+x^{7} & \ 1+x+x^{3}+x^{7}\  & 0\  & 0\\
1+x+x^{2}+x^{3} & x^{3} & 1+x^{2}+x^{3} & x & 1\  & 0\\
1+x+x^{2} & x+x^{2}+x^{3} & 1+x+x^{2}+x^{3} & x^{3} & 0\  & 1\end{array}}\right],\end{align*}

\end_inset

 and a 
\begin_inset Formula $\left(\mathbf{F}',\left[8,4,4\right],\vec{0}\right)$
\end_inset

-basis is given as 
\begin_inset Formula \[
\left[\begin{array}{cccc|cc}
~1~ & x & 1 & x^{2} & x^{2}+x^{4} & 1+x^{2}+x^{3}+x^{4}\\
0 & 1 & x^{2}+x^{3} & 0 & x^{3} & 0\\
1 & 1+x & x & x^{3}+x^{4} & 0 & x+x^{2}+x^{3}\\
1 & 0 & 0 & 0 & 0 & 0\\
\hline 0 & 1 & 1+x^{2} & x^{2} & x^{2}+x^{3} & 1+x^{2}+x^{3}+x^{4}\\
0 & 1 & 1 & x^{2}+x^{4} & x^{2}+x^{3} & 1+x^{3}\end{array}\right].\]

\end_inset

 Column reduction on the top 4 rows gives the top left 
\begin_inset Formula $4\times4$
\end_inset

 submatrix, which is a 
\series bold

\begin_inset Formula $(\mathbf{F},8,\vec{0})$
\end_inset


\series default
-basis.
 
\end_layout

\begin_layout Standard
The following two lemmas verify Storjohann's result in the case of degree
 parameter 
\begin_inset Formula $\delta=\sigma/4$
\end_inset

.
 More specifically, we show that the matrix of the top 
\begin_inset Formula $n$
\end_inset

 rows of a 
\begin_inset Formula $(\bar{\mathbf{F}},2\delta,\vec{s'})_{\delta-1}$
\end_inset

-basis is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{\delta-1}$
\end_inset

-basis, with the transformed input matrix 
\begin_inset Formula \begin{equation}
\bar{\mathbf{F}}=\left[\begin{array}{l|cc}
\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta} & \mathbf{0} & \mathbf{0}\\
\hline \mathbf{F}_{1}+\mathbf{F}_{2}x^{\delta} & \mathbf{I}_{m} & \mathbf{0}\\
\mathbf{F}_{2}+\mathbf{F}_{3}x^{\delta} & \mathbf{0} & ~\mathbf{I}_{m}\end{array}\right]\equiv\mathbf{F}'\mod x^{2\delta}.\label{eq:storjohannTransformation4parts}\end{equation}

\end_inset


\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:A_delta-1Form"

\end_inset

If 
\begin_inset Formula $\bar{\mathbf{q}}\in\langle(\bar{\mathbf{F}},2\delta,\vec{s'})\rangle_{\delta-1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}$
\end_inset

 denotes the first 
\begin_inset Formula $n$
\end_inset

 entries of 
\begin_inset Formula $\bar{\mathbf{q}}$
\end_inset

, then 
\begin_inset Formula $\bar{\mathbf{q}}$
\end_inset

 must have the form 
\begin_inset Formula \[
\bar{\mathbf{q}}=\mathbf{B}\mathbf{q}=\left[\begin{array}{r}
\mathbf{q}\\
x^{-\delta}\mathbf{F}_{0}\cdot\mathbf{q}\\
x^{-2\delta}\left(\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta}\right)\cdot\mathbf{q}\end{array}\right]\]

\end_inset

 and 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{\delta-1}$
\end_inset

.
\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $\mathbf{q},\mathbf{q}_{2},\mathbf{q}_{3}$
\end_inset

 consist of the top 
\begin_inset Formula $n$
\end_inset

 entries, middle 
\begin_inset Formula $m$
\end_inset

 entries, and bottom 
\begin_inset Formula $m$
\end_inset

 entries, respectively, of 
\begin_inset Formula $\mathbf{\bar{\mathbf{q}}}$
\end_inset

 so that 
\begin_inset Formula \begin{align}
\bar{\mathbf{F}}\bar{\mathbf{q}} & \equiv\left[\begin{array}{r}
\mathbf{F}_{0}\mathbf{q}+x^{\delta}\mathbf{F}_{1}\mathbf{q}\\
\mathbf{q}_{2}+\mathbf{F}_{1}\mathbf{q}+x^{\delta}\mathbf{F}_{2}\mathbf{q}\\
\mathbf{q}_{3}+\mathbf{F}_{2}\mathbf{q}+x^{\delta}\mathbf{F}_{3}\mathbf{q}\end{array}\right]\equiv\mathbf{0}\mod x^{2\delta}.\label{eq:Aq}\end{align}

\end_inset

 From the first and second block rows, we get 
\begin_inset Formula $\mathbf{F}_{0}\mathbf{q}+x^{\delta}\mathbf{F}_{1}\mathbf{q}\equiv\mathbf{0}\mod x^{2\delta}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}_{2}+\mathbf{F}_{1}\mathbf{q}\equiv\mathbf{0}\mod x^{\delta}$
\end_inset

, which implies 
\begin_inset Formula \begin{equation}
\mathbf{F}_{0}\mathbf{q}\equiv x^{\delta}\mathbf{q}_{2}\mod x^{2\delta}.\label{eq:q1q2}\end{equation}

\end_inset

 Similarly, from the second and third rows, we get 
\begin_inset Formula $\mathbf{q}_{2}+\mathbf{F}_{1}\mathbf{q}+x^{\delta}\mathbf{F}_{2}\mathbf{q}\equiv\mathbf{0}\mod x^{2\delta}$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}_{3}+\mathbf{F}_{2}\mathbf{q}\equiv\mathbf{0}\mod x^{\delta}$
\end_inset

, which implies 
\begin_inset Formula $\mathbf{q}_{2}+\mathbf{F}_{1}\mathbf{q}\equiv x^{\delta}\mathbf{q}_{3}\mod x^{2\delta}$
\end_inset

.
\end_layout

\begin_layout Proof
Since 
\begin_inset Formula $\deg\mathbf{q}\le\deg_{\vec{s}}\mathbf{q}=\delta-1$
\end_inset

, we have 
\begin_inset Formula $\deg\mathbf{F}_{0}\mathbf{q}\le2\delta-2$
\end_inset

, hence from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "eq:q1q2"

\end_inset

 
\begin_inset Formula $\deg\mathbf{q}_{2}\le\delta-2$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}_{2}x^{\delta}=\mathbf{F}_{0}\mathbf{q}$
\end_inset

.
 Similarly, 
\begin_inset Formula $\deg\mathbf{q}_{3}\le\delta-2$
\end_inset

 and 
\begin_inset Formula $\mathbf{q}_{3}x^{2\delta}=\mathbf{q}_{2}x^{\delta}+\mathbf{F}_{1}\mathbf{q}x^{\delta}=\mathbf{F}_{0}\mathbf{q}+\mathbf{F}_{1}\mathbf{q}x^{\delta}$
\end_inset

.
 Substituting this to 
\begin_inset Formula $\mathbf{F}\mathbf{q}=(\mathbf{F}_{0}\mathbf{q}+\mathbf{F}_{1}\mathbf{q}x^{\delta})+(\mathbf{F}_{2}\mathbf{q}x^{2\delta}+\mathbf{F}_{3}\mathbf{q}x^{3\delta})$
\end_inset

, we get 
\begin_inset Formula $\mathbf{F}\mathbf{q}=\mathbf{q}_{3}x^{2\delta}+(\mathbf{F}_{2}\mathbf{q}x^{2\delta}+\mathbf{F}_{3}\mathbf{q}x^{3\delta})\equiv\mathbf{0}\mod x^{4\delta}$
\end_inset

 using the bottom block row of 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "eq:Aq"

\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:delta-1Basis"

\end_inset

 If 
\begin_inset Formula $\bar{\mathbf{S}}_{\delta-1}$
\end_inset

 is a 
\begin_inset Formula $(\bar{\mathbf{F}},2\delta,\vec{s'})_{\delta-1}$
\end_inset

-basis, then the matrix of its first 
\begin_inset Formula $n$
\end_inset

 rows, 
\begin_inset Formula $\mathbf{S}_{\delta-1}$
\end_inset

, is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{\delta-1}$
\end_inset

-basis.
\end_layout

\begin_layout Proof
By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:A_delta-1Form"

\end_inset

, 
\begin_inset Formula $\mathbf{S}_{\delta-1}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

.
 Following Lemmas 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:qToBqOrder"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:qToBqDegree"

\end_inset

 and Corollaries 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:sToBs"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:linearCombinationOfFirstnRows"

\end_inset

 (replacing 
\begin_inset Formula $\vec{\omega}$
\end_inset

 by 
\begin_inset Formula $2\delta$
\end_inset

), we conclude that any 
\begin_inset Formula $\mathbf{q}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{\delta-1}$
\end_inset

 is a linear combination of the columns of 
\begin_inset Formula $\mathbf{S}_{\delta-1}$
\end_inset

.
 In addition, since 
\begin_inset Formula $\bar{\mathbf{S}}_{\delta-1}=\mathbf{B}\mathbf{S}_{\delta-1}$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:A_delta-1Form"

\end_inset

, and the columns of 
\begin_inset Formula $\mathbf{S}_{\delta-1}$
\end_inset

 are in 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{\delta-1}$
\end_inset

, it follows from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:qToBqDegree"

\end_inset

 that 
\begin_inset Formula $\mathbf{S}_{\delta-1}$
\end_inset

 determines the 
\begin_inset Formula $\vec{s'}$
\end_inset

-column degrees of 
\begin_inset Formula $\bar{\mathbf{S}}_{\delta-1}$
\end_inset

.
 Hence 
\begin_inset Formula $\bar{\mathbf{S}}_{\delta-1}$
\end_inset

 
\begin_inset Formula $\vec{s'}$
\end_inset

-column reduced implies that 
\begin_inset Formula $\mathbf{S}_{\delta-1}$
\end_inset

 is 
\begin_inset Formula $\vec{s}$
\end_inset

-column reduced.
 
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:generalTransform"

\end_inset

More General Results
\end_layout

\begin_layout Standard
Let us now consider an immediate extension of the results in the previous
 subsection.
 Suppose that instead of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis we now want to compute a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

-basis with a Storjohann transformed input matrix 
\begin_inset Formula \[
\bar{\mathbf{F}}^{\left(i\right)}=\left[\begin{array}{c|cccc}
\mathbf{F}_{0}+\mathbf{F}_{1}x^{\delta^{\left(i\right)}} & \mathbf{0}_{m} & \cdots & \mathbf{\cdots} & \mathbf{0}_{m}\\
\hline \mathbf{F}_{1}+\mathbf{F}_{2}x^{\delta^{\left(i\right)}} & \mathbf{I}_{m}\\
\mathbf{F}_{2}+\mathbf{F}_{3}x^{\delta^{\left(i\right)}} &  & \mathbf{I}_{m}\\
\vdots &  &  & \ddots\\
\mathbf{F}_{l^{\left(i\right)}-1}+\mathbf{F}_{l^{\left(i\right)}}x^{\delta^{\left(i\right)}} &  &  &  & \mathbf{I}_{m}\end{array}\right]_{ml^{(i)}\times(n+m(l^{(i)}-1))}\]

\end_inset

 made with degree parameter 
\begin_inset Formula $\delta^{\left(i\right)}=2^{i}d$
\end_inset

 for some integer 
\begin_inset Formula $i$
\end_inset

 between 
\begin_inset Formula $2$
\end_inset


\begin_inset Note Comment
status open

\begin_layout Plain Layout
the base case is 
\begin_inset Formula $i=1$
\end_inset

 and problem is not to be subdivided 
\end_layout

\end_inset

 and 
\begin_inset Formula $\log\left(\sigma/d\right)-1$
\end_inset

, and a shift 
\begin_inset Formula $\vec{s}^{\left(i\right)}=[\vec{s},0,\dots,0]$
\end_inset

 (with 
\begin_inset Formula $m(l^{\left(i\right)}-1)$
\end_inset

 0's), where 
\begin_inset Formula $l^{\left(i\right)}=\sigma/\delta^{\left(i\right)}-1$
\end_inset

 is the number of block rows
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Recall that 
\begin_inset Formula $d=m\sigma/n$
\end_inset

 is the average degree of the input matrix 
\begin_inset Formula $\mathbf{F}$
\end_inset

 if we treat 
\begin_inset Formula $\mathbf{F}$
\end_inset

 as a square 
\begin_inset Formula $n\times n$
\end_inset

 matrix.
 Also, 
\begin_inset Formula $i$
\end_inset

 starts at 
\begin_inset Formula $2$
\end_inset

 because 
\begin_inset Formula $i=1$
\end_inset

 is our base case in the computation of an order basis, which may become
 more clear in the next section.
 The base case can be computed efficiently using the method of Giorgi et
 al.
 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "Giorgi2003"

\end_inset

 directly and does not require the transformation discussed in this section.
\end_layout

\end_inset

.
 To apply a transformation analogous to 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "eq:extendedSTransformTop"

\end_inset

, we write each 
\begin_inset Formula $\mathbf{F}_{j}=\mathbf{F}_{j0}+\mathbf{F}_{j1}\delta^{\left(i-1\right)}$
\end_inset

 and set 
\begin_inset Formula \begin{equation}
\mathbf{F}'^{\left(i\right)}=\left[\begin{array}{l|c}
\mathbf{F}_{00}+\mathbf{F}_{01}x^{\delta^{\left(i-1\right)}}+\mathbf{F}_{10}x^{2\delta^{\left(i-1\right)}}+\mathbf{F}_{11}x^{3\delta^{\left(i-1\right)}} & ~~\mathbf{0}~~\\
\hline \mathbf{F}_{01}+\mathbf{F}_{10}x^{\delta^{\left(i-1\right)}}\\
\mathbf{F}_{10}+\mathbf{F}_{11}x^{\delta^{\left(i-1\right)}}+\mathbf{F}_{20}x^{2\delta^{\left(i-1\right)}}+\mathbf{F}_{21}x^{3\delta^{\left(i-1\right)}}\\
\mathbf{F}_{11}+\mathbf{F}_{20}x^{\delta^{\left(i-1\right)}}\\
\vdots & ~~\mathbf{I}~~\\
\mathbf{F}_{\left(l^{\left(i\right)}-1\right)0}+\mathbf{F}_{\left(l^{\left(i\right)}-1\right)1}x^{\delta^{\left(i-1\right)}}+\mathbf{F}_{l^{\left(i\right)}0}x^{2\delta^{\left(i-1\right)}}+\mathbf{F}_{l^{\left(i\right)}1}x^{3\delta^{\left(i-1\right)}}\\
\mathbf{F}_{\left(l^{\left(i\right)}-1\right)1}+\mathbf{F}_{l^{\left(i\right)}0}x^{\delta^{\left(i-1\right)}}\\
\mathbf{F}_{l^{\left(i\right)}0}+\mathbf{F}_{l^{\left(i\right)}1}x^{\delta^{\left(i-1\right)}}\end{array}\right],\label{eq:extendedStorjohannTransform}\end{equation}

\end_inset

 
\begin_inset Note Comment
status open

\begin_layout Plain Layout
This is not ideal, but no better idea.
 
\end_layout

\end_inset

 and 
\begin_inset Formula $\vec{\omega}^{\left(i\right)}=\left[\left[[2\delta^{\left(i\right)}]^{m},[\delta^{\left(i\right)}]^{m}\right]^{l^{\left(i\right)}},[\delta^{\left(i\right)}]^{m}\right]$
\end_inset

, where 
\begin_inset Formula $\left[\circ\right]^{k}$
\end_inset

 represents 
\begin_inset Formula $\circ$
\end_inset

 repeated 
\begin_inset Formula $k$
\end_inset

 times
\begin_inset Note Comment
status open

\begin_layout Plain Layout
Not sure if using this notation is a good thing to do, but it saves space
 and makes presentation easier 
\end_layout

\end_inset

.
 The order entries 
\begin_inset Formula $2\delta^{\left(i\right)}$
\end_inset

, 
\begin_inset Formula $\delta^{\left(i\right)}$
\end_inset

 in 
\begin_inset Formula $\vec{\omega}^{\left(i\right)}$
\end_inset

 correspond to the degree 
\begin_inset Formula $2\delta^{\left(i\right)}-1$
\end_inset

, degree 
\begin_inset Formula $\delta^{\left(i\right)}-1$
\end_inset

 rows in 
\begin_inset Formula $\mathbf{F}'^{\left(i\right)}$
\end_inset

 respectively.
 Let 
\begin_inset Formula \[
\mathbf{E}^{\left(i\right)}=\left[\begin{array}{c||cc|cc|cc|cc||cc}
\mathbf{I}_{n} &  &  &  &  &  &  &  &  & \mathbf{0}_{n\times m} & \mathbf{0}_{n\times m}\\
\hline\hline  & \mathbf{0}_{m} & \mathbf{I}_{m} &  &  &  &  &  &  & \ \\
\hline  &  &  & \mathbf{0}_{m} & \mathbf{I}_{m} &  &  &  &  & \ \\
\hline  &  &  &  &  & \ddots & \ddots &  &  & \ \\
\hline  &  &  &  &  &  &  & \mathbf{0}_{m} & \mathbf{I}_{m}\end{array}\right]\]

\end_inset

 with 
\begin_inset Formula $l^{\left(i\right)}-1$
\end_inset

 blocks of 
\begin_inset Formula $\left[\mathbf{0}_{m},\mathbf{I}_{m}\right]$
\end_inset

 and hence an overall dimension of 
\begin_inset Formula $(n+m(l^{\left(i\right)}-1))\times(n+m(l^{\left(i-1\right)}-1))$
\end_inset

.
 Thus 
\begin_inset Formula $\mathbf{E}^{\left(i\right)}\mathbf{M}$
\end_inset

 picks out from 
\begin_inset Formula $\mathbf{M}$
\end_inset

 the first 
\begin_inset Formula $n$
\end_inset

 rows and the even block rows from the remaining rows except the last block
 row for a matrix 
\begin_inset Formula $\mathbf{M}$
\end_inset

 with 
\begin_inset Formula $n+m(l^{\left(i-1\right)}-1)$
\end_inset

 rows.
 In particular, if 
\begin_inset Formula $i=\log\left(n/m\right)-1$
\end_inset

, then 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)},\vec{\omega}^{\left(i\right)},\vec{s}^{\left(i-1\right)})=(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

, which for 
\begin_inset Formula $d=m\sigma/n$
\end_inset

 gives the problem considered earlier in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sub:particularCase"

\end_inset

, and 
\begin_inset Formula $\mathbf{E}^{\left(i\right)}=\left[\mathbf{I}_{n},\mathbf{0}_{n\times m},\mathbf{0}_{n\times m}\right]$
\end_inset

 is used to select the top 
\begin_inset Formula $n$
\end_inset

 rows of a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis for a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis to be extracted.
\end_layout

\begin_layout Standard
We can now state the analog of 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:extractingFbasisFromGbasis"

\end_inset

: 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:extractingOrderBasis"

\end_inset

Let 
\begin_inset Formula $\mathbf{S}'^{\left(i\right)}$
\end_inset

 be a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)},\vec{\omega}^{\left(i\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis with its columns sorted in an increasing order of their 
\begin_inset Formula $\vec{s}^{\left(i-1\right)}$
\end_inset

 degrees.
 Let 
\begin_inset Formula $\hat{\mathbf{S}}^{\left(i\right)}=\mathbf{E}^{\left(i\right)}\mathbf{S}'^{\left(i\right)}$
\end_inset

.
 Let 
\begin_inset Formula $J$
\end_inset

 be the column rank profile of 
\begin_inset Formula $\lcoeff(x^{\vec{s}^{\left(i\right)}}\hat{\mathbf{S}}^{\left(i\right)})$
\end_inset

.
 Then 
\begin_inset Formula $\hat{\mathbf{S}}_{J}^{\left(i\right)}$
\end_inset

 is a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

-basis.
\end_layout

\begin_layout Proof
One can follow the same arguments used before from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:qToBqOrder"

\end_inset

 to 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:extractingFbasisFromGbasis"

\end_inset

.
 Alternatively, this can be derived from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:extractingFbasisFromGbasis"

\end_inset

 by noticing the redundant block rows that can be disregarded after applying
 transformation 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "eq:extendedSTransformTop"

\end_inset

 directly to the input matrix 
\begin_inset Formula $\bar{\mathbf{F}}^{\left(i\right)}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:delta-1Basis"

\end_inset

 can also be extended in the same way to capture Storjohann's transformation
 with more general degree parameters: 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:linkStorjohanTransform"

\end_inset

If 
\begin_inset Formula $\bar{\mathbf{P}}_{1}^{\left(i-1\right)}$
\end_inset

 is a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i-1\right)},2\delta^{\left(i-1\right)},\vec{s}^{\left(i-1\right)})_{\delta^{\left(i-1\right)}-1}$
\end_inset

-basis, then 
\begin_inset Formula $\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}_{1}^{\left(i-1\right)}$
\end_inset

 is a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})_{\delta^{\left(i-1\right)}-1}$
\end_inset

-basis and the matrix of the top 
\begin_inset Formula $n$
\end_inset

 rows of 
\begin_inset Formula $\bar{\mathbf{P}}_{1}^{\left(i-1\right)}$
\end_inset

 is a 
\begin_inset Formula $(\mathbf{F},\sigma,\vec{s})_{\delta^{\left(i-1\right)}-1}$
\end_inset

-basis.
\end_layout

\begin_layout Proof
Again, this can be justified as done in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:delta-1Basis"

\end_inset

.
 Alternatively, one can apply Storjohann's transformation with degree parameter
 
\begin_inset Formula $\delta^{\left(i-1\right)}$
\end_inset

 to 
\begin_inset Formula $\bar{\mathbf{F}}^{\left(i\right)}$
\end_inset

 as in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "eq:storjohannTransformation4parts"

\end_inset

.
 The lemma then follows from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:delta-1Basis"

\end_inset

 after noticing the redundant block rows that can be disregarded.
 
\end_layout

\begin_layout Standard
Notice that if 
\begin_inset Formula $i=\log\left(n/m\right)-1,$
\end_inset

 then 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:extractingOrderBasis"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:linkStorjohanTransform"

\end_inset

 specialize to 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:extractingFbasisFromGbasis"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:delta-1Basis"

\end_inset

.
 
\end_layout

\begin_layout Section
Computation of Order Bases
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Order-Basis-Computation"

\end_inset


\end_layout

\begin_layout Standard
In this section, we establish a link between two different Storjohann transforme
d problems by dividing the transformed problem from the previous section
 into two subproblems and then simplifying the second subproblem.
 This leads to a recursive method for computing order bases.
 We also present an equivalent, iterative method for computing order bases.
 The iterative approach is usually more efficient in practice, as it uses
 just 
\begin_inset Formula $O(1)$
\end_inset

 iterations in the generic case.
\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:Dividing-to-Subproblems"

\end_inset

Dividing into Subproblems 
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sec:transform"

\end_inset

 we have shown that the problem of computing a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis can be converted to the problem of computing a 
\begin_inset Formula $(\mathbf{F}',\vec{\omega},\vec{s'})$
\end_inset

-basis and, more generally, that the computation of a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

-basis, a Storjohann transformed problem with degree parameter 
\begin_inset Formula $\delta^{\left(i\right)}$
\end_inset

, can be converted to the problem of computing a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)},\vec{\omega}^{\left(i\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis.
 We now consider dividing the new converted problem into two subproblems.
\end_layout

\begin_layout Standard
The first subproblem is to compute a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)},2\delta^{\left(i-1\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis or equivalently a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i-1\right)},2\delta^{\left(i-1\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

, a Storjohann transformed problem with degree parameter 
\begin_inset Formula $\delta^{\left(i-1\right)}$
\end_inset

.
 The second subproblem is computing a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)},\vec{\omega}^{\left(i\right)},\vec{t}^{\left(i-1\right)})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

 using the residual 
\begin_inset Formula $\mathbf{F}'^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

 from the first subproblem along with a degree shift 
\begin_inset Formula $\vec{t}^{\left(i-1\right)}=\deg_{\vec{s}^{\left(i-1\right)}}\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

.
 From Theorem 5.1 in 
\begin_inset CommandInset citation
LatexCommand citep
key "BL1997"

\end_inset

 we then know that the product 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(i-1\right)}\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

 is a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)},\vec{\omega}^{\left(i\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis and 
\begin_inset Formula $\deg_{\vec{s}^{\left(i-1\right)}}\bar{\mathbf{P}}^{\left(i-1\right)}\bar{\mathbf{Q}}^{\left(i\right)}=\deg_{\vec{t}^{\left(i-1\right)}}\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

.
 
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exm:subproblems"

\end_inset

 Let us continue with 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:StorjohannTransformation"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:auxiliaryTransformation"

\end_inset

 in order to compute a 
\begin_inset Formula $\left(\mathbf{F},8,\vec{0}\right)$
\end_inset

-basis (or equivalently a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(2\right)},8,\vec{0})$
\end_inset

-basis).
 This can be determined by computing a 
\begin_inset Formula $(\mathbf{F}'^{\left(2\right)},[8,4,4],\vec{0})$
\end_inset

-basis as shown in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:auxiliaryTransformation"

\end_inset

 where we have 
\begin_inset Formula $\mathbf{F}'^{\left(2\right)}=\mathbf{F}'$
\end_inset

.
 Computing a 
\begin_inset Formula $(\mathbf{F}'^{\left(2\right)},[8,4,4],\vec{0})$
\end_inset

-basis can be divided into two subproblems.
 The first subproblem is computing a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(1\right)},4,\vec{0})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(1\right)}$
\end_inset

, the Storjohann partial linearized problem in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:StorjohannTransformation"

\end_inset

.
 The residual 
\begin_inset Formula \[
\mathbf{F}'^{(2)}\bar{\mathbf{P}}^{(1)}=\left[{\begin{array}{rcccccccccc}
0 & \  & x^{8} & \  & x^{6}+x^{9} & \  & x^{4}+x^{6}+x^{9} & \  & x^{6}+x^{8}+x^{9}+x^{10} & \  & x^{5}+x^{8}\\
0 &  & 0 &  & x^{5} &  & x^{4}+x^{6} &  & x^{4}+x^{6} &  & x^{5}+x^{6}\\
0 &  & x^{4} &  & x^{5} &  & x^{5} &  & x^{4}+x^{5}+x^{6} &  & x^{4}\end{array}}\right]\]

\end_inset

 is then used as the input matrix for the second subproblem.
 The shift for the second subproblem 
\begin_inset Formula $\vec{t}^{(1)}=[0,1,2,3,3,3]$
\end_inset

 is the list of column degrees of 
\begin_inset Formula $\bar{\mathbf{P}}^{(1)}$
\end_inset

 and so the second subproblem is to compute a 
\begin_inset Formula $(\mathbf{F}'^{(2)}\bar{\mathbf{P}}^{(1)},\left[8,4,4\right],[0,1,2,3,3,3])$
\end_inset

-basis, which is 
\begin_inset Formula \begin{equation}
\bar{\mathbf{Q}}^{(2)}=\left[{\begin{array}{cccccc}
~~1~ & ~~0~ & ~0~ & ~0~ & ~0~ & ~0~\\
0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & ~x^{2}~ & ~x~ & ~1~\\
0 & 0 & 0 & 0 & x & 0\\
0 & 0 & 1 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & ~x~\end{array}}\right].\label{eq:Qbar2}\end{equation}

\end_inset

 Then 
\begin_inset Formula $\bar{\mathbf{P}}^{(1)}\bar{\mathbf{Q}}^{(2)}$
\end_inset

 gives the 
\begin_inset Formula $(\mathbf{F}'^{\left(2\right)},[8,4,4],\vec{0})$
\end_inset

-basis shown in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:auxiliaryTransformation"

\end_inset

.
 
\end_layout

\begin_layout Standard
We now show that the dimension of the second subproblem can be significantly
 reduced.
 First, the row dimension can be reduced by over a half.
 Let 
\begin_inset Formula $\hat{\mathbf{P}}^{\left(i-1\right)}=\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:simplifySecondSubproblem"

\end_inset

A 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}^{\left(i-1\right)},2\delta^{\left(i\right)},\vec{t}^{\left(i-1\right)})$
\end_inset

-basis is a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)},\vec{\omega}^{\left(i\right)},\vec{t}^{\left(i-1\right)})$
\end_inset

-basis.
\end_layout

\begin_layout Proof
This follows because 
\begin_inset Formula $\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

 is a submatrix of 
\begin_inset Formula $\mathbf{F}'^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

 after removing rows which already have the correct order 
\begin_inset Formula $2\delta^{\left(i-1\right)}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The column dimension of the second subproblem can be reduced by disregarding
 the 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})_{\delta^{\left(i-1\right)}-1}$
\end_inset

-basis which has already been computed.
 More specifically, after sorting the columns of 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

 in an increasing order of their 
\begin_inset Formula $\vec{s}^{\left(i-1\right)}$
\end_inset

-degrees, let 
\begin_inset Formula $[\bar{\mathbf{P}}_{1}^{\left(i-1\right)},\bar{\mathbf{P}}_{2}^{\left(i-1\right)}]=\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

 be such that 
\begin_inset Formula $\deg_{\vec{s}^{\left(i-1\right)}}\bar{\mathbf{P}}_{1}^{\left(i-1\right)}\le\delta^{\left(i-1\right)}-1$
\end_inset

 and 
\begin_inset Formula $\deg_{\vec{s}^{\left(i-1\right)}}\bar{\mathbf{P}}_{2}^{\left(i-1\right)}\ge\delta^{\left(i-1\right)}$
\end_inset

.
 Then 
\begin_inset Formula $\hat{\mathbf{P}}_{1}^{\left(i-1\right)}=\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}_{1}^{\left(i-1\right)}$
\end_inset

 is a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})_{\delta^{\left(i-1\right)}-1}$
\end_inset

-basis by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:linkStorjohanTransform"

\end_inset

.
 In the second subproblem, the remaining basis elements of a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

-basis can then be computed without 
\begin_inset Formula $\bar{\mathbf{P}}_{1}^{\left(i-1\right)}$
\end_inset

.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\hat{\mathbf{P}}_{2}^{\left(i-1\right)}=\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

, 
\begin_inset Formula $\vec{b}^{\left(i-1\right)}=\deg_{\vec{s}^{\left(i-1\right)}}\bar{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

, 
\begin_inset Formula $\bar{\mathbf{Q}}_{2}^{\left(i\right)}$
\end_inset

 be a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}_{2}^{\left(i-1\right)},2\delta^{\left(i\right)},\vec{b}^{\left(i-1\right)})$
\end_inset

-basis (or equivalently a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)}\bar{\mathbf{P}}_{2}^{\left(i-1\right)},\vec{\omega}^{\left(i\right)},\vec{b}^{\left(i-1\right)})$
\end_inset

-basis), and 
\begin_inset Formula $k^{\left(i-1\right)}$
\end_inset

 be the column dimension of 
\begin_inset Formula $\bar{\mathbf{P}}_{1}^{\left(i-1\right)}$
\end_inset

.
 We then have the following result.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:disregardComputedBasisElements"

\end_inset

 The matrix 
\begin_inset Formula \[
\bar{\mathbf{Q}}^{\left(i\right)}=\left[\begin{array}{cc}
\mathbf{I}_{k^{\left(i-1\right)}}\\
 & \bar{\mathbf{Q}}_{2}^{\left(i\right)}\end{array}\right]\]

\end_inset

 is a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}^{\left(i-1\right)},2\delta^{\left(i\right)},\vec{t}^{\left(i-1\right)})$
\end_inset

-basis (equivalently a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)},\vec{\omega}^{\left(i\right)},\vec{t}^{\left(i-1\right)})$
\end_inset

-basis).
\end_layout

\begin_layout Proof
First note that 
\begin_inset Formula $\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

 has order 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}^{\left(i-1\right)},2\delta^{\left(i\right)})$
\end_inset

 as 
\begin_inset Formula \[
\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}^{\left(i-1\right)}\bar{\mathbf{Q}}^{\left(i\right)}=[\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}_{1}^{\left(i-1\right)},\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}_{2}^{\left(i-1\right)}\bar{\mathbf{Q}}_{2}^{\left(i\right)}]\equiv0\mod x^{2\delta^{\left(i\right)}}.\]

\end_inset

 In addition, 
\begin_inset Formula $\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

 has minimal 
\begin_inset Formula $\vec{t}^{\left(i-1\right)}$
\end_inset

 degrees as 
\begin_inset Formula $\bar{\mathbf{Q}}_{2}^{\left(i\right)}$
\end_inset

 is 
\begin_inset Formula $\vec{b}$
\end_inset

-minimal.
 Hence, by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:orderBasisEquivalence"

\end_inset

, 
\begin_inset Formula $\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

 is a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)}\cdot\hat{\mathbf{P}}^{\left(i-1\right)},2\delta^{\left(i\right)},\vec{t}^{\left(i-1\right)})$
\end_inset

-basis.
 
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Plain Layout
Alternatively, one can also argue that since 
\begin_inset Formula $\hat{\mathbf{P}}_{1}^{\left(i-1\right)}$
\end_inset

 already has order 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)})$
\end_inset

, it cannot contribute in any way to and cannot be affected in any way by
 the computations of a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}^{\left(i-1\right)},2\delta^{\left(i\right)},\vec{b}^{\left(i-1\right)})$
\end_inset

-basis, hence it is sufficient to just use 
\begin_inset Formula $\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

 to compute a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)}\cdot\hat{\mathbf{P}}_{2}^{\left(i-1\right)},2\delta^{\left(i\right)},\vec{b}^{\left(i-1\right)})$
\end_inset

-basis.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:disregardComputedBasisElements"

\end_inset

 immediately leads to the following.
 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:computationAtTopLevel"

\end_inset

Let 
\begin_inset Formula $\hat{\mathbf{S}}=[\hat{\mathbf{P}}_{1}^{\left(i-1\right)},\hat{\mathbf{P}}_{2}^{\left(i-1\right)}\bar{\mathbf{Q}}_{2}^{\left(i\right)}]$
\end_inset

, and let 
\begin_inset Formula $I$
\end_inset

 be the column rank profile of 
\begin_inset Formula $\lcoeff(x^{\vec{s}^{\left(i\right)}}\hat{\mathbf{S}})$
\end_inset

.
 Then 
\begin_inset Formula $\hat{\mathbf{S}}_{I}$
\end_inset

 is a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

-basis.
\end_layout

\begin_layout Proof
From 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:disregardComputedBasisElements"

\end_inset

, 
\begin_inset Formula $\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

 is a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)},\vec{\omega}^{\left(i\right)},\vec{t}^{\left(i-1\right)})$
\end_inset

-basis and hence 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(i-1\right)}\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

 is a 
\begin_inset Formula $(\mathbf{F}'^{\left(i\right)},\vec{\omega}^{\left(i\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis.
 Since 
\begin_inset Formula $[\hat{\mathbf{P}}_{1}^{\left(i-1\right)},\hat{\mathbf{P}}_{2}^{\left(i-1\right)}\bar{\mathbf{Q}}_{2}^{\left(i\right)}]=\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)}\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

, the result follows from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:extractingOrderBasis"

\end_inset

.
 
\begin_inset Note Comment
status open

\begin_layout Plain Layout
\begin_inset Formula $=\mathbf{E}^{\left(i\right)}[\bar{\mathbf{P}}_{1}^{\left(i-1\right)},\bar{\mathbf{P}}_{2}^{\left(i-1\right)}\bar{\mathbf{Q}}_{2}^{\left(i\right)}]$
\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Example
Continuing with 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:StorjohannTransformation"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:auxiliaryTransformation"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:subproblems"

\end_inset

, 
\begin_inset Note Comment
status open

\begin_layout Plain Layout
notice that after the first subproblem, the second subproblem of computing
 
\begin_inset Formula $\bar{\mathbf{Q}}^{(2)}$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:subproblems"

\end_inset

 is really a smaller problem of computing the lower right 
\begin_inset Formula $4\times4$
\end_inset

 submatrix 
\begin_inset Formula $\bar{\mathbf{Q}}_{2}^{(2)}$
\end_inset

, which is a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(2\right)}\hat{\mathbf{P}}_{2}^{\left(1\right)},8,\vec{b}^{\left(1\right)})$
\end_inset

-basis (or equivalently a 
\begin_inset Formula $(\mathbf{F}'^{\left(2\right)}\bar{\mathbf{P}}_{2}^{\left(1\right)},[8,4,4],\vec{b}^{\left(1\right)})$
\end_inset

-basis), where 
\begin_inset Formula $\bar{\mathbf{P}}_{2}^{\left(1\right)}$
\end_inset

 is the last 
\begin_inset Formula $4$
\end_inset

 columns of 
\begin_inset Formula $\bar{\mathbf{P}}^{(1)}$
\end_inset

, 
\begin_inset Formula $\vec{b}^{(1)}=[2,3,3,3]$
\end_inset

 is the list of column degrees of 
\begin_inset Formula $\bar{\mathbf{P}}_{2}^{(1)}$
\end_inset

, and 
\begin_inset Formula $\hat{\mathbf{P}}_{2}^{\left(1\right)}$
\end_inset

 is the first 
\begin_inset Formula $4$
\end_inset

 rows of 
\begin_inset Formula $\bar{\mathbf{P}}_{2}^{(1)}$
\end_inset

.
 
\end_layout

\end_inset

notice that in the computation of the second subproblem, instead of using
 
\begin_inset Formula $\mathbf{F}'^{\left(2\right)},$
\end_inset

 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(1\right)}$
\end_inset

, 
\begin_inset Formula $\bar{\mathbf{Q}}^{(2)}$
\end_inset

, and 
\begin_inset Formula $\bar{\mathbf{P}}^{(1)}\bar{\mathbf{Q}}^{(2)}$
\end_inset

, the previous lemmas show that we can just use their submatrices, 
\begin_inset Formula $\bar{\mathbf{F}}^{(2)}$
\end_inset

 the top left 
\begin_inset Formula $1\times4$
\end_inset

 submatrix of 
\begin_inset Formula $\mathbf{F}'^{\left(2\right)}$
\end_inset

, 
\begin_inset Formula $\hat{\mathbf{P}}_{2}^{(1)}$
\end_inset

 the top right 
\begin_inset Formula $4\times4$
\end_inset

 submatrix of 
\begin_inset Formula $\bar{\mathbf{P}}^{(1)}$
\end_inset

, 
\begin_inset Formula $\bar{\mathbf{Q}}_{2}^{(2)}$
\end_inset

 the bottom right 
\begin_inset Formula $4\times4$
\end_inset

 submatrix of 
\begin_inset Formula $\bar{\mathbf{Q}}^{(2)}$
\end_inset

, and 
\begin_inset Formula $\hat{\mathbf{P}}_{2}^{(1)}\bar{\mathbf{Q}}_{2}^{(2)}$
\end_inset

 the top right 
\begin_inset Formula $4\times4$
\end_inset

 submatrix of 
\begin_inset Formula $\bar{\mathbf{P}}^{(1)}\bar{\mathbf{Q}}^{(2)}$
\end_inset

of lower dimensions.
 
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:computationAtTopLevel"

\end_inset

 gives us a way of computing a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 We can set 
\begin_inset Formula $i$
\end_inset

 to 
\begin_inset Formula $\log\left(n/m\right)-1$
\end_inset

 so that 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

=
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

, and compute a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

-basis.
 By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:computationAtTopLevel"

\end_inset

, this can be divided into two subproblems.
 The first produces 
\begin_inset Formula $[\hat{\mathbf{P}}_{1}^{\left(i-1\right)},\hat{\mathbf{P}}_{2}^{\left(i-1\right)}]=\hat{\mathbf{P}}^{\left(i-1\right)}=\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

 from computing a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i-1\right)},2\delta^{\left(i-1\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(i-1\right)}$
\end_inset

.
 The second subproblem then computes a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}_{2}^{\left(i-1\right)},2\delta^{\left(i\right)},\vec{b}^{\left(i-1\right)})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{Q}}_{2}^{\left(i\right)}$
\end_inset

.
 Note the first subproblem of computing a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i-1\right)},2\delta^{\left(i-1\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis can again be divided into two subproblems just as before.
 This can be repeated recursively until we reach the base case with degree
 parameter 
\begin_inset Formula $\delta^{\left(1\right)}=2d$
\end_inset

.
 The total number of recursion levels is therefore 
\begin_inset Formula $\log\left(n/m\right)-1$
\end_inset

.
\end_layout

\begin_layout Standard
Notice that the transformed matrix 
\begin_inset Formula $\mathbf{F}'^{\left(i\right)}$
\end_inset

 is not used explicitly in the computation, even though it is crucial for
 deriving our results.
\end_layout

\begin_layout Subsection
The Iterative View
\end_layout

\begin_layout Standard
In this subsection we present our algorithm, which uses an iterative version
 of the computation discussed above.
\begin_inset Note Comment
status open

\begin_layout Plain Layout
The recursive top-down approach of the previous subsection is useful for
 giving an overall picture of the computation process.
 Algorithm 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 uses an equivalent corresponding bottom-up iterative approach.
 
\end_layout

\end_inset


\begin_inset Note Comment
status open

\begin_layout Plain Layout
, allowing the complexity to be more easily analyzed.
 
\end_layout

\end_inset


\begin_inset Note Comment
status open

\begin_layout Plain Layout
.
 In practice, bottom-up iterative approaches are more efficient than the
 corresponding top-down recursive approaches.
 For our purpose, it is also easier to analyze the computational cost of
 the iterative procedure.
 
\end_layout

\end_inset

 The iterative version is usually more efficient in practice, considering
 that the generic case has balanced output that can be computed with just
 one iteration, whereas the recursive method has to go through 
\begin_inset Formula $\log(n/m)-1$
\end_inset

 levels of recursion.
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 uses a subroutine 
\begin_inset Formula $\mab$
\end_inset

, the algorithm from Giorgi et al.
 
\begin_inset CommandInset citation
LatexCommand citeyearpar
key "Giorgi2003"

\end_inset

, for computing order bases with balanced input.
 Specifically, 
\begin_inset Formula $\left[\mathbf{Q},\vec{a}\right]=\mab(\mathbf{G},\sigma,\vec{b})$
\end_inset

 computes a 
\begin_inset Formula $(\mathbf{G},\sigma,\vec{b})$
\end_inset

-basis and also returns its 
\begin_inset Formula $\vec{b}$
\end_inset

-column degrees 
\begin_inset Formula $\vec{a}$
\end_inset

.
 The other subroutine 
\begin_inset Formula $\StorjohannTransform$
\end_inset

 is the transformation described in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sub:storjohannTransformation"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 proceeds as follows.
 In the first iteration, which is the base case of the recursive approach,
 we set the degree parameter 
\begin_inset Formula $\delta^{\left(1\right)}$
\end_inset

 to be twice the average degree 
\begin_inset Formula $d$
\end_inset

 and apply Storjohann's transformation to produce a new input matrix 
\begin_inset Formula $\bar{\mathbf{F}}^{\left(1\right)}$
\end_inset

, which has 
\begin_inset Formula $l^{\left(1\right)}$
\end_inset

 block rows.
 Then a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(1\right)},2\delta^{\left(1\right)},\vec{s}^{\left(1\right)})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(1\right)}$
\end_inset

 is computed.
 Note this is in fact the first subproblem of computing a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(2\right)},2\delta^{\left(2\right)},\vec{s}^{\left(2\right)})$
\end_inset

-basis, which is another Storjohann transformed problem and also the problem
 of the second iteration.
 At the second iteration, we work on a new Storjohann transformed problem
 with the degree doubled and the number of block rows 
\begin_inset Formula $l^{\left(2\right)}=(l^{\left(1\right)}-1)/2$
\end_inset

 reduced by over a half.
 The column dimension is reduced by using the result from the previous iteration.
 More specifically, we know that the basis 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(1\right)}$
\end_inset

 already provides a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(2\right)},2\delta^{\left(2\right)},\vec{s}^{\left(2\right)})_{\delta^{\left(1\right)}-1}$
\end_inset

-basis 
\begin_inset Formula $\hat{\mathbf{P}}_{1}^{\left(1\right)}$
\end_inset

, which can be disregarded in the remaining computation.
 The remaining work in the second iteration is to compute a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(2\right)}\hat{\mathbf{P}}_{2}^{\left(1\right)},2\delta^{\left(2\right)},\vec{b}^{\left(1\right)})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{Q}}^{\left(2\right)}$
\end_inset

, where 
\begin_inset Formula $\vec{b}^{\left(1\right)}=\deg_{\vec{s}^{\left(1\right)}}\bar{\mathbf{P}}_{2}^{\left(1\right)}$
\end_inset

, and then to combine it with the result from the previous iteration to
 form a matrix 
\begin_inset Formula $[\hat{\mathbf{P}}_{1}^{\left(1\right)},\hat{\mathbf{P}}_{2}^{\left(1\right)}\bar{\mathbf{Q}}^{\left(2\right)}]$
\end_inset

 in order to extract a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(2\right)},2\delta^{\left(2\right)},\vec{s}^{\left(2\right)})$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(2\right)}$
\end_inset

.
\end_layout

\begin_layout Standard
With a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(2\right)},2\delta^{\left(2\right)},\vec{s}^{\left(2\right)})$
\end_inset

-basis computed, we can repeat the same process to use it for computing
 a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(3\right)},2\delta^{\left(3\right)},\vec{s}^{\left(3\right)})$
\end_inset

-basis.
 Continue, using the computed 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i-1\right)},2\delta^{\left(i-1\right)},\vec{s}^{\left(i-1\right)})$
\end_inset

-basis to compute a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

-basis, until all 
\begin_inset Formula $n$
\end_inset

 elements of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis have been determined.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement t
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $\mmab\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:mab"

\end_inset

 
\end_layout

\begin_layout Algorithm
* 
\series bold
Input:
\series default
 
\begin_inset Formula $\mathbf{F}\in\mathbb{K}\left[x\right]^{m\times n}$
\end_inset

, 
\begin_inset Formula $\sigma\in\mathbb{Z}_{\ge0}$
\end_inset

,
\begin_inset Formula $\vec{s}\in\mathbb{Z}^{n}$
\end_inset

 satisfying 
\begin_inset Formula $n\ge m,$
\end_inset

 
\begin_inset Formula $n/m$
\end_inset

 and 
\begin_inset Formula $\sigma$
\end_inset

 are powers of 2 and 
\begin_inset Formula $\min\left(\vec{s}\right)=0$
\end_inset

 
\end_layout

\begin_layout Algorithm
* 
\series bold
Output:
\series default
 a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis 
\begin_inset Formula $\mathbf{P}\in K\left[x\right]^{n\times n}$
\end_inset

 and 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{P}$
\end_inset


\end_layout

\begin_layout Algorithm
* 
\end_layout

\begin_layout Algorithm (num)
* 
\series bold
if 
\series default

\begin_inset Formula $2m\ge n$
\end_inset

 
\series bold
then return
\series default
 
\begin_inset Formula $\mab\left(\mathbf{F},\sigma,\vec{s}\right);$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $i:=1;$
\end_inset

 
\begin_inset Formula $d:=m\sigma/n;$
\end_inset

 
\begin_inset Formula $\delta^{\left(1\right)}:=2d;$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\bar{\mathbf{F}}^{\left(1\right)}:=\StorjohannTransform(\mathbf{F},\delta^{\left(1\right)});$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $l^{\left(1\right)}:=\rowDimension(\bar{\mathbf{F}}^{\left(1\right)})/m;$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status open

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\vec{b}^{\left(0\right)}:=\left[\vec{s},0,\dots,0\right];$
\end_inset


\begin_inset space \space{}
\end_inset


\begin_inset space \space{}
\end_inset


\begin_inset space \space{}
\end_inset


\begin_inset space \space{}
\end_inset


\begin_inset space \space{}
\end_inset


\begin_inset space \space{}
\end_inset


\begin_inset space \space{}
\end_inset

// 
\begin_inset Formula $m(l_{1}-1)$
\end_inset

 
\begin_inset Formula $0$
\end_inset

's
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $[\bar{\mathbf{P}}^{\left(1\right)},\vec{a}^{\left(1\right)}]:=\mab(\bar{\mathbf{F}}^{\left(1\right)},2\delta^{\left(1\right)},\vec{b}^{\left(0\right)});$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 Sort the columns of 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(i\right)}$
\end_inset

 and 
\begin_inset Formula $\vec{a}^{\left(i\right)}$
\end_inset

 by the shifted column degrees 
\begin_inset Formula $\vec{a}^{\left(i\right)}=\deg_{\vec{b}}\bar{\mathbf{P}}^{\left(i\right)}$
\end_inset

 in increasing order; 
\end_layout

\begin_layout Algorithm (num)
* 
\begin_inset Formula $\vec{t}^{\left(i\right)}:=\vec{a}^{\left(i\right)};$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $k^{\left(i\right)}:=$
\end_inset

 number of entries of 
\begin_inset Formula $\vec{a}^{\left(i\right)}$
\end_inset

 less than 
\begin_inset Formula $\delta^{\left(i\right)}$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
* 
\begin_inset Formula $[\bar{\mathbf{P}}_{1}^{\left(i\right)},\bar{\mathbf{P}}_{2}^{\left(i\right)}]:=\bar{\mathbf{P}}^{\left(i\right)}$
\end_inset

 with 
\begin_inset Formula $\bar{\mathbf{P}}_{1}^{\left(i\right)}\in K\left[x\right]^{n\times k^{\left(i\right)}}$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

while
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\columnDimension(\bar{\mathbf{P}}_{1}^{\left(i\right)})<n$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $i:=i+1;$
\end_inset

 
\begin_inset Formula $\delta^{\left(i\right)}:=2\delta^{\left(i-1\right)};$
\end_inset

 
\begin_inset Formula $l^{\left(i\right)}:=(l^{\left(i-1\right)}-1)/2;$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\bar{\mathbf{F}}^{\left(i\right)}:=\StorjohannTransform(\mathbf{F},\delta^{\left(i\right)});$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\hat{\mathbf{P}}_{2}^{\left(i-1\right)}:=\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "line:matrixProduct1"

\end_inset


\begin_inset Formula $\mathbf{G}^{\left(i\right)}:=\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}_{2}^{\left(i-1\right)};$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status open

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\vec{b}^{\left(i-1\right)}:=\vec{t}^{\left(i-1\right)}[k^{\left(i-1\right)}+1\dots n+m(l^{\left(i-1\right)}-1)];$
\end_inset

 
\begin_inset Newline newline
\end_inset


\begin_inset Formula $\mbox{ // w:=v[k..l] means that w receives a slice of v whose indices range from k to l}$
\end_inset


\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "line:orderBasisComputation"

\end_inset


\begin_inset Formula $[\mathbf{Q}^{\left(i\right)},\vec{a}^{\left(i\right)}]:=\mab(\mathbf{G}^{\left(i\right)},2\delta^{\left(i\right)},\vec{b}^{\left(i-1\right)});$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 Sort the columns of 
\begin_inset Formula $\mathbf{Q}^{\left(i\right)}$
\end_inset

 and 
\begin_inset Formula $\vec{a}^{\left(i\right)}$
\end_inset

 by 
\begin_inset Formula $\vec{a}^{\left(i\right)}=\deg_{\vec{b}^{\left(i-1\right)}}\mathbf{Q}^{\left(i\right)}$
\end_inset

 in increasing order; 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "line:matrixProduct2"

\end_inset


\begin_inset Formula $\check{\mathbf{P}}^{\left(i\right)}:=\hat{\mathbf{P}}_{2}^{\left(i-1\right)}\mathbf{Q}^{\left(i\right)};$
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset CommandInset label
LatexCommand label
name "line:LSP"

\end_inset


\begin_inset Formula $J:=$
\end_inset

 the column rank profile of 
\begin_inset Formula $\lcoeff(x^{\left[\vec{s},0,\dots,0\right]}[\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}_{1}^{\left(i-1\right)},\check{\mathbf{P}}^{\left(i\right)}])$
\end_inset

; 
\end_layout

\begin_layout Algorithm (num)
* 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(i\right)}:=[\mathbf{E}^{\left(i\right)}\bar{\mathbf{P}}_{1}^{\left(i-1\right)},\check{\mathbf{P}}^{\left(i\right)}]_{J}$
\end_inset

,
\end_layout

\begin_layout Algorithm (num)
* 
\begin_inset Formula $\vec{t}^{\left(i\right)}:=\deg_{\left[\vec{s},0,\dots,0\right]}\bar{\mathbf{P}}^{\left(i\right)}$
\end_inset

; 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $k^{\left(i\right)}:=$
\end_inset

 number of entries of 
\begin_inset Formula $\vec{t}^{\left(i\right)}$
\end_inset

 less than 
\begin_inset Formula $\delta^{\left(i\right)}$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
* 
\begin_inset Formula $[\bar{\mathbf{P}}_{1}^{\left(i\right)},\bar{\mathbf{P}}_{2}^{\left(i\right)}]:=\bar{\mathbf{P}}^{\left(i\right)}$
\end_inset

 with 
\begin_inset Formula $\bar{\mathbf{P}}_{1}^{\left(i\right)}\in K\left[x\right]^{n\times k^{\left(i\right)}}$
\end_inset

 ;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

endwhile
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset space ~
\end_inset

 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\series bold
return
\series default
 the top 
\begin_inset Formula $n$
\end_inset

 rows of 
\begin_inset Formula $\bar{\mathbf{P}}_{1}^{\left(i\right)}$
\end_inset

, 
\begin_inset Formula $\vec{t}^{\left(i\right)}\left[1..n\right]$
\end_inset

; 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Comment
status collapsed

\begin_layout Theorem
Algorithm 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 computes a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis correctly.
\end_layout

\begin_layout Proof
This follows from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:simplifySecondSubproblem"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:disregardComputedBasisElements"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:computationAtTopLevel"

\end_inset

.
 
\end_layout

\end_inset

 
\end_layout

\begin_layout Section
Computational Complexity
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:complexity"

\end_inset


\end_layout

\begin_layout Standard
In this section, we analyze the computational complexity of 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 computes a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis in no more than 
\begin_inset Formula $\log\left(n/m\right)-1$
\end_inset

 iterations.
\end_layout

\begin_layout Proof
Each iteration 
\begin_inset Formula $i$
\end_inset

 computes a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})$
\end_inset

-basis.
 At iteration 
\begin_inset Formula ${i}^{*}=\log(n/m)-1$
\end_inset

, the degree parameter is 
\begin_inset Formula $\sigma/2$
\end_inset

 and 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left({i}^{*}\right)},2\delta^{\left({i}^{*}\right)},\vec{s}^{\left({i}^{*}\right)})=\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:remainingNumberElements"

\end_inset

If the shift 
\begin_inset Formula $\vec{s}=\left[0,\dots,0\right]$
\end_inset

, then a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{\delta^{\left(i\right)}-1}$
\end_inset

-basis (or equivalently a 
\begin_inset Formula $(\bar{\mathbf{F}}^{\left(i\right)},2\delta^{\left(i\right)},\vec{s}^{\left(i\right)})_{\delta^{\left(i\right)}-1}$
\end_inset

-basis) computed at iteration 
\begin_inset Formula $i$
\end_inset

 has at least 
\begin_inset Formula $n-n/2^{i}$
\end_inset

 elements, and hence at most 
\begin_inset Formula $n/2^{i}$
\end_inset

 elements remain to be computed.
 If the shift 
\begin_inset Formula $\vec{s}$
\end_inset

 is balanced, that is, 
\begin_inset Formula $\max\vec{s}\in O(d)$
\end_inset

 assuming 
\begin_inset Formula $\min\vec{s}=0$
\end_inset

, then the number 
\begin_inset Formula $n^{\left(i\right)}$
\end_inset

 of remaining basis elements at iteration 
\begin_inset Formula $i$
\end_inset

 is 
\begin_inset Formula $O(n/2^{i})$
\end_inset

.
\end_layout

\begin_layout Proof
The uniform case follows from the idea of 
\begin_inset CommandInset citation
LatexCommand citet
key "storjohann-villard:2005"

\end_inset

 on null space basis computation discussed in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sub:Unbalanced-Output"

\end_inset

.
 For the balanced case, the average column degree is bounded by 
\begin_inset Formula $cd=cm\sigma/n$
\end_inset

 for some constant 
\begin_inset Formula $c$
\end_inset

.
 The first iteration 
\begin_inset Formula $\lambda$
\end_inset

 such that 
\begin_inset Formula $\delta^{\left(\lambda\right)}$
\end_inset

 reaches 
\begin_inset Formula $cd$
\end_inset

 is therefore a constant.
 That is, 
\begin_inset Formula $\delta^{\left(\lambda\right)}=2^{\lambda}d\ge cd>\delta^{\left(\lambda-1\right)}$
\end_inset

 and hence 
\begin_inset Formula $\lambda=\left\lceil \log c\right\rceil $
\end_inset

.
 By the same argument as in the uniform case, the number of remaining basis
 elements 
\begin_inset Formula $n^{\left(i\right)}\le n/2^{i-\lambda}=2^{\lambda}(n/2^{i})\in O(n/2^{i})$
\end_inset

 at iteration 
\begin_inset Formula $i\ge\lambda$
\end_inset

.
 For iterations 
\begin_inset Formula $i<\lambda$
\end_inset

, certainly 
\begin_inset Formula $n^{\left(i\right)}\le n<2^{\lambda}(n/2^{i})\in O(n/2^{i})$
\end_inset

.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:balancedCost"

\end_inset

If the shift 
\begin_inset Formula $\vec{s}$
\end_inset

 is balanced with 
\begin_inset Formula $\min\left(\vec{s}\right)=0$
\end_inset

, then 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 computes a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis with a cost of 
\begin_inset Formula $O\left(n^{\omega}\bar{\M}(d)\log\sigma)\right)=O\left(n^{\omega}d\log d\log\log d\log\sigma)\right)\subset O^{\sim}\left(n^{\omega}d\right)$
\end_inset

 field operations.
 
\end_layout

\begin_layout Proof
The computational cost depends on the degree, the row dimension, and the
 column dimension of the problem at each iteration.
 The degree parameter 
\begin_inset Formula $\delta^{\left(i\right)}$
\end_inset

 is 
\begin_inset Formula $2^{i}d$
\end_inset

 at iteration 
\begin_inset Formula $i$
\end_inset

.
 The number of block rows 
\begin_inset Formula $l^{\left(i\right)}$
\end_inset

 is 
\begin_inset Formula $\sigma/\delta^{\left(i\right)}-1$
\end_inset

, which is less than 
\begin_inset Formula $\sigma/(2^{i}d)=n/(2^{i}m)$
\end_inset

 at iteration 
\begin_inset Formula $i$
\end_inset

.
 The row dimension is therefore less than 
\begin_inset Formula $n/2^{i}$
\end_inset

 at iteration 
\begin_inset Formula $i$
\end_inset

.
\end_layout

\begin_layout Proof
The column dimension of interest at iteration 
\begin_inset Formula $i$
\end_inset

 is the column dimension of 
\begin_inset Formula $\hat{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

 (equivalently the column dimension of 
\begin_inset Formula $\bar{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

), which is the sum of two components, 
\begin_inset Formula $n^{\left(i-1\right)}+(l^{\left(i-1\right)}-1)m$
\end_inset

.
 The first component 
\begin_inset Formula $n^{\left(i-1\right)}\in O(n/2^{i})$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:remainingNumberElements"

\end_inset

.
 The second component 
\begin_inset Formula $(l^{\left(i-1\right)}-1)m<n/2^{i-1}-m<n/2^{i-1}$
\end_inset

 comes from the size of the identity matrix added in Storjohann's transformation.
 Therefore, the overall column dimension of the problem at iteration 
\begin_inset Formula $i$
\end_inset

 is 
\begin_inset Formula $O(n/2^{i})$
\end_inset

.
\end_layout

\begin_layout Proof
At each iteration, the four most expensive operations are the multiplications
 at 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "line:matrixProduct1"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "line:matrixProduct2"

\end_inset

, the order basis computation at 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "line:orderBasisComputation"

\end_inset

, and extracting the basis at 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "line:LSP"

\end_inset

.
\end_layout

\begin_layout Proof
The matrices 
\begin_inset Formula $\bar{\mathbf{F}}^{\left(i\right)}$
\end_inset

 and 
\begin_inset Formula $\hat{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

 have degree 
\begin_inset Formula $O(2^{i}d)$
\end_inset

 and dimensions 
\begin_inset Formula $O(n/2^{i})\times O\left(n\right)$
\end_inset

 and 
\begin_inset Formula $O\left(n\right)\times O(n/2^{i})$
\end_inset

.
 The multiplication cost is therefore 
\begin_inset Formula $2^{i}\MM(n/2^{i},2^{i}d)$
\end_inset

 field operations, which is bounded by
\begin_inset Formula \begin{align}
2^{i}\MM(n/2^{i},2^{i}d) & \in O\left(2^{i}\left(n/2^{i}\right)^{\omega}\bar{\M}(2^{i}d)\right)\nonumber \\
 & \subset O\left(n^{\omega}\left(2^{i}\right)^{1-\omega}\bar{\M}\left(2^{i}\right)\bar{\M}(d)\right)\label{eq:separateMultiplication}\\
 & \subset O\left(n^{\omega}\left(2^{i}\right)^{1-\omega}\left(2^{i}\right)^{\omega-1}\bar{\M}(d)\right)\label{eq:MultiplicationToExponent}\\
 & \subset O\left(n^{\omega}\bar{\M}(d)\right).\nonumber \end{align}

\end_inset

Equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:separateMultiplication"

\end_inset

) follows from 
\begin_inset Formula $\bar{\M}(ab)\in O\left(\bar{\M}(a)\bar{\M}(b)\right)$
\end_inset

.
 Equation (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MultiplicationToExponent"

\end_inset

) follows from 
\begin_inset Formula $\bar{\M}(t)\in O(t^{\omega-1})$
\end_inset

.
\end_layout

\begin_layout Proof
The matrices 
\begin_inset Formula $\hat{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

 and 
\begin_inset Formula $\bar{\mathbf{Q}}^{\left(i\right)}$
\end_inset

 of the second multiplication have the same degree 
\begin_inset Formula $O(2^{i}d)$
\end_inset

 and dimensions 
\begin_inset Formula $O\left(n\right)\times O(n/2^{i})$
\end_inset

 and 
\begin_inset Formula $O(n/2^{i})\times O(n/2^{i})$
\end_inset

 and can also be multiplied with a cost of 
\begin_inset Formula $O\left(n^{\omega}\bar{\M}(d)\right)$
\end_inset

 field operations.
 The total cost of the multiplications over 
\begin_inset Formula $O(\log\left(n/m\right))$
\end_inset

 iterations is therefore 
\begin_inset Formula $O\left(n^{\omega}\bar{\M}(d)\log(n/m)\right)$
\end_inset

.
\end_layout

\begin_layout Proof
The input matrix 
\begin_inset Formula $\mathbf{G}^{\left(i\right)}=\bar{\mathbf{F}}^{\left(i\right)}\hat{\mathbf{P}}_{2}^{\left(i-1\right)}$
\end_inset

 of the order basis computation problem at iteration 
\begin_inset Formula $i$
\end_inset

 has dimension 
\begin_inset Formula $O(n/2^{i})\times O(n/2^{i})$
\end_inset

 and the order of the problem is 
\begin_inset Formula $2\delta^{\left(i\right)}\in O(2^{i}d)$
\end_inset

.
 Thus, the cost of the order basis computation at iteration 
\begin_inset Formula $i$
\end_inset

 is 
\begin_inset Formula $O\left(\left(n/2^{i}\right)^{\omega}\bar{\M}\left(2^{i}d\right)\log\left(2^{i}d\right)\right)$
\end_inset

.
 The total cost over 
\begin_inset Formula $O(\log\left(n/m\right))$
\end_inset

 iterations is bounded by 
\begin_inset Formula \begin{align*}
 & O\left(\sum_{i=1}^{\infty}\left(\left(n/2^{i}\right)^{\omega}\bar{\M}\left(2^{i}d\right)\log\left(2^{i}d\right)\right)\right)\\
\subset & O\left(\sum_{i=1}^{\infty}\left(\left(n/2^{i}\right)^{\omega}\bar{\M}\left(2^{i}\right)\log\left(2^{i}\right)\bar{\M}\left(d\right)\log\left(d\right)\right)\right)\\
\subset & O\left(\sum_{i=1}^{\infty}\left(n^{\omega}\left(2^{i}\right)^{-\omega}\left(2^{i}\right)^{\omega-1}\bar{\M}\left(d\right)\log\left(d\right)\right)\right)\\
\subset & O\left(n^{\omega}\bar{\M}\left(d\right)\log\left(d\right)\sum_{i=1}^{\infty}\left(2^{-i}\right)\right)\\
\subset & O\left(n^{\omega}\bar{\M}\left(d\right)\log\left(d\right)\right).\end{align*}

\end_inset


\end_layout

\begin_layout Proof
Finally, extracting an order basis by LSP factorization costs 
\begin_inset Formula $O\left(n^{\omega}\right)$
\end_inset

, which is dominated by the other costs.
 Combining the above gives 
\begin_inset Formula \[
O\left(n^{\omega}\bar{\M}\left(d\right)\log(n/m)+n^{\omega}\bar{\M}\left(d\right)\log d\right)=O\left(n^{\omega}\bar{\M}\left(d\right)\log\sigma)\right)\]

\end_inset

 as the total cost of the algorithm.
 
\end_layout

\begin_layout Section
Unbalanced Shifts
\end_layout

\begin_layout Standard
\begin_inset CommandInset label
LatexCommand label
name "sec:Unbalanced-Shift"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sec:complexity"

\end_inset

 shows that 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 can efficiently compute a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis when the shift 
\begin_inset Formula $\vec{s}$
\end_inset

 is balanced.
 When the 
\begin_inset Formula $\vec{s}$
\end_inset

 is unbalanced (something important for example in normal form computation
 
\begin_inset CommandInset citation
LatexCommand citep
key "BLV:1999,BLV:jsc06"

\end_inset

), then 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 still returns a correct answer but may be less efficient.
 The possible inefficiency results because there may not be enough partial
 results from the intermediate subproblems to sufficiently reduce the column
 dimension of the subsequent subproblem.
 This is clear from the fact that the column degrees of the output can be
 much larger and no longer sum up to 
\begin_inset Formula $O\left(m\sigma\right)$
\end_inset

 as in the balanced shift case.
 The shifted 
\begin_inset Formula $\vec{s}$
\end_inset

-column degrees, however, still behave well.
 In particular, the total 
\begin_inset Formula $\vec{s}$
\end_inset

-degree increase is still bounded by 
\begin_inset Formula $m\sigma$
\end_inset

 as stated in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:size"

\end_inset

, while the shifted degree of any column can also increase by up to 
\begin_inset Formula $\sigma$
\end_inset

.
 Recall that 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:size"

\end_inset

 states that for any shift 
\begin_inset Formula $\vec{s}$
\end_inset

, there exists a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis still having a total size bounded by 
\begin_inset Formula $nm\sigma$
\end_inset

 which gives hope for efficient computation.
\end_layout

\begin_layout Standard
In this section, we describe an algorithm for an important special case
 of unbalanced shift -- when the input shift 
\begin_inset Formula $\vec{s}$
\end_inset

 satisfies the condition:
\begin_inset Formula \[
\sum_{i=1}^{n}(\max(\vec{s})-\vec{s}_{i})\le m\sigma.\]

\end_inset

 For simpler presentation, we use the equivalent condition 
\begin_inset Formula \begin{equation}
\vec{s}\le0\mbox{ and }\sum_{i}-\vec{s}_{i}\le m\sigma,\label{con:unbalancedCondition}\end{equation}

\end_inset

 which can always be obtained from the previous condition by using 
\begin_inset Formula $\vec{s}-\max\vec{s}$
\end_inset

 as the new shift.
 Note that translating every entry of the shift by the same constant does
 not change the problem.
\end_layout

\begin_layout Standard
In the balanced shift case, a central problem is to find a way to handle
 unbalanced column degrees of the output order basis.
 In this section, the unbalanced shift makes row degrees of the output also
 unbalanced, which is a major problem that needs to be resolved.
 Here we note a second transformation by 
\begin_inset CommandInset citation
LatexCommand citet
key "Storjohann:2006"

\end_inset

 which converts the input in such a way that each high degree row of the
 output becomes multiple rows of lower degrees.
 We refer to this as Storjohann's second transformation to distinguish it
 from that described in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sub:storjohannTransformation"

\end_inset

.
 The transformed problem can then be computed efficiently using 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

.
 After the computation, rows can then be combined appropriately to form
 a basis of the original problem.
 The method is computationally efficient.
\end_layout

\begin_layout Standard
Unfortunately, the bases computed this way are not minimal and hence do
 not in general produce our reduced order bases.
 In the following, we describe a transformation that incorporates Storjohann's
 second transformation and guarantees the minimality of some columns of
 the output, hence providing a partial order basis.
 We can then work on the remaining columns iteratively as done in the balanced
 shift case to compute a full order basis.
\end_layout

\begin_layout Standard
Condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "con:unbalancedCondition"

\end_inset

 essentially allows us to locate the potential high degree rows that need
 to be balanced.
 In more general cases, we may not know in advance which are the high degree
 rows that need to be balanced, so our approach given in this section does
 not work directly.
 This suggests that one possible future direction to pursue is to find an
 effective way to estimate the row degree of the result pivot entries.
 Such an estimate may allow us to apply the method given in this section
 efficiently for general unbalanced shifts.
 An example of the case not covered by Condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "con:unbalancedCondition"

\end_inset

 is when the shift 
\begin_inset Formula $\vec{s}=[0,-n\sigma,-2n\sigma,\dots,-(n-1)n\sigma]$
\end_inset

.
 This shift makes the result basis close to Hermite normal form but with
 possibly higher degree non-pivot entries.
 
\end_layout

\begin_layout Subsection
Transform to Balanced Shifts
\end_layout

\begin_layout Standard
We now describe the transformation for balancing the high degree rows of
 the resulting basis.
 Consider the problem of computing a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis, where the input shift 
\begin_inset Formula $\vec{s}$
\end_inset

 satisfies the conditions 
\begin_inset CommandInset ref
LatexCommand eqref
reference "con:unbalancedCondition"

\end_inset

.
 Let 
\begin_inset Formula $\alpha,\beta\in\mathbb{Z}_{>0}$
\end_inset

 be two parameters.
 For each shift entry 
\begin_inset Formula $s_{i}$
\end_inset

 in 
\begin_inset Formula $\vec{s}$
\end_inset

 with 
\begin_inset Formula $-s_{i}>\alpha+\beta$
\end_inset

, let 
\begin_inset Formula \[
r_{i}=\mbox{rem}\left(-s_{i}-\alpha-1,\beta\right)+1\]

\end_inset

 be the remainder when 
\begin_inset Formula $-s_{i}-\alpha$
\end_inset

 is divided by 
\begin_inset Formula $\beta$
\end_inset

, and where 
\begin_inset Formula $r_{i}=\beta$
\end_inset

 in the case where the remainder is 
\begin_inset Formula $0$
\end_inset

, and set 
\begin_inset Formula \[
q_{i}=\begin{cases}
1 & \mbox{if }-s_{i}\le\alpha+\beta\\
1+\left(-s_{i}-\alpha-r_{i}\right)/\beta & \mbox{otherwise}\end{cases}\]

\end_inset

 Then, for each 
\begin_inset Formula $q_{i}>1$
\end_inset

, we expand the corresponding 
\begin_inset Formula $i$
\end_inset

th column 
\begin_inset Formula $\mathbf{f}_{i}$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and shift 
\begin_inset Formula $s_{i}$
\end_inset

 to 
\begin_inset Formula \begin{eqnarray*}
\tilde{\mathbf{F}}^{\left(i\right)} & = & \left[~\mathbf{f}_{i},~x^{r_{i}}\mathbf{f}_{i},~x^{r_{i}+\beta}\mathbf{f}_{i},~\dots~,~x^{r_{i}+(q_{i}-2)\beta}\mathbf{f}_{i}\right],~~\tilde{s}_{i}=\left[-\alpha-\beta,~\dots~,-\alpha-\beta\right]\end{eqnarray*}

\end_inset

 with 
\begin_inset Formula $q_{i}$
\end_inset

 entries in each case.
 When 
\begin_inset Formula $q_{i}=1$
\end_inset

, the corresponding shift entry and input column remain the same, that is,
 
\begin_inset Formula $\tilde{s}_{i}=s_{i}$
\end_inset

, and 
\begin_inset Formula $\tilde{\mathbf{F}}^{\left(i\right)}=\mathbf{f}_{i}$
\end_inset

.
 Then for the transformed problem, the new shift becomes 
\begin_inset Formula $\bar{s}=[\tilde{s}_{1},\dots,\tilde{s}_{n}]\in\mathbb{Z}_{\le0}^{\bar{n}}$
\end_inset

, and the new input matrix becomes 
\begin_inset Formula $\bar{\mathbf{F}}=[\tilde{\mathbf{F}}^{\left(1\right)},\dots,\tilde{\mathbf{F}}^{\left(n\right)}]\in\mathbb{K}\left[x\right]^{m\times\bar{n}}$
\end_inset

, with the new column dimension 
\begin_inset Formula $\bar{n}$
\end_inset

 satisfies 
\begin_inset Formula $\bar{n}=\sum_{i=1}^{n}q_{i}$
\end_inset

.
 Note that every entry of the new shift 
\begin_inset Formula $\bar{s}$
\end_inset

 is an integer from 
\begin_inset Formula $-\alpha-\beta$
\end_inset

 to 
\begin_inset Formula $0$
\end_inset

.
 Let 
\begin_inset Formula \[
\mathbf{E}=\left[\begin{array}{ccccc|ccc|ccccccc}
1 & x^{r_{1}} & x^{r_{1}+\beta} & \cdots & x^{r_{1}+(q_{1}-2)\beta} &  &  & \\
\hline  &  &  &  &  & \ddots &  & \\
 &  &  &  &  &  & \  & \ddots\\
\hline  &  &  &  &  &  &  &  & 1 & x^{r_{n}} & x^{r_{n}+\beta} & \cdots & x^{r_{n}+(q_{n}-2)\beta}\end{array}\right]_{n\times\bar{n}}.\]

\end_inset

 Then 
\begin_inset Formula $\bar{\mathbf{F}}=\mathbf{F}\mathbf{E}$
\end_inset

.
 Storjohann's second transformation is determined by setting 
\begin_inset Formula $\alpha=-1$
\end_inset

, a value not allowed in our transformation (we show later in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:correctHighDegreeElements"

\end_inset

 that this value is not useful in our case).
 One can verify that the new dimension 
\begin_inset Formula \[
\bar{n}=\sum_{i=1}^{n}q_{i}\le n+\sum_{i=1}^{n}-s_{i}/\beta\le m\sigma/\beta+n.\]

\end_inset

 Thus by setting 
\begin_inset Formula $\beta\in\Theta\left(m\sigma/n\right)=\Theta\left(d\right)$
\end_inset

, we can make 
\begin_inset Formula $\bar{n}\in\Theta\left(n\right)$
\end_inset

.
 Furthermore, by also setting 
\begin_inset Formula $\alpha\in\Theta\left(d\right)$
\end_inset

, we have a balanced shift problem since 
\begin_inset Formula \[
\max\bar{s}-\min\bar{s}\le-\min\bar{s}\le\alpha+\beta\in\Theta(d).\]

\end_inset

 Hence 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 can compute a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis with cost 
\begin_inset Formula $O^{\sim}\left(n^{\omega}d\right)$
\end_inset

 in this case.
\end_layout

\begin_layout Standard
With a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{P}}\in\mathbb{K}\left[x\right]^{\bar{n}\times\bar{n}}$
\end_inset

 computed, let us now consider 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}\in\mathbb{K}\left[x\right]^{n\times\bar{n}}$
\end_inset

.
 While it is easy to see that 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 has order 
\begin_inset Formula $\left(\mathbf{F},\sigma\right)$
\end_inset

 since 
\series bold

\begin_inset Formula $\mathbf{F}\mathbf{E}\bar{\mathbf{P}}=\bar{\mathbf{F}}\bar{\mathbf{P}}\equiv0\mod x^{\sigma}$
\end_inset


\series default
, in general it is not a minimal basis (in fact, 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 is not even square).
 However, our transformation does guarantee that the highest degree columns
 of 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 having 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees exceed 
\begin_inset Formula $-\alpha$
\end_inset

 are minimal.
 That is, the columns of 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 whose 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees exceed 
\begin_inset Formula $-\alpha$
\end_inset

 are exactly the columns of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis whose 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees exceed 
\begin_inset Formula $-\alpha$
\end_inset

.
 We have therefore correctly computed a partial 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
 
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exm:unbalancedShift"

\end_inset

 Let us use the same input as in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:StorjohannTransformation"

\end_inset

, but with shift 
\begin_inset Formula $\vec{s}=[0,-3,-5,-6]$
\end_inset

, and parameters 
\begin_inset Formula $\alpha=\beta=1$
\end_inset

.
 Then we get the transformed input 
\begin_inset Formula \begin{align*}
\bar{\mathbf{F}}=[ & x+x^{2}+x^{3}+x^{4}+x^{5}+x^{6},\,~1+x+x^{5}+x^{6}+x^{7},\,~x+x^{2}+x^{6}+x^{7}+x^{8},\\
 & 1+x^{2}+x^{4}+x^{5}+x^{6}+x^{7},\,~x+x^{3}+x^{5}+x^{6}+x^{7}+x^{8},\,~x^{2}+x^{4}+x^{6}+x^{7}+x^{8}+x^{9},\\
 & x^{3}+x^{5}+x^{7}+x^{8}+x^{9}+x^{10},\,~1+x+x^{3}+x^{7},\,~x+x^{2}+x^{4}+x^{8},\\
 & x^{2}+x^{3}+x^{5}+x^{9},\,~x^{3}+x^{4}+x^{6}+x^{10},\,~x^{4}+x^{5}+x^{7}+x^{11}]\end{align*}

\end_inset

 having 
\begin_inset Formula $12$
\end_inset

 components, and 
\begin_inset Formula $\bar{s}=[0,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2]$
\end_inset

.
 In this case 
\begin_inset Formula $r_{1}=r_{2}=r_{3}=r_{4}=1$
\end_inset

, 
\begin_inset Formula $q_{1}=1$
\end_inset

, 
\begin_inset Formula $q_{2}=2$
\end_inset

, 
\begin_inset Formula $q_{3}=4$
\end_inset

, 
\begin_inset Formula $q_{4}=5$
\end_inset

 and the transformation matrix is 
\begin_inset Formula \[
\mathbf{E}=\left[{\begin{array}{c|cc|cccc|ccccc}
~1~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~\\
\hline 0 & 1 & x & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\hline 0 & 0 & 0 & 1 & x & x^{2} & x^{3} & 0 & 0 & 0 & 0 & 0\\
\hline 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & x & x^{2} & x^{3} & x^{4}\end{array}}\right].\]

\end_inset

 Using the earlier algorithm for balanced shift, we compute a 
\begin_inset Formula $(\bar{\mathbf{F}},8,\bar{s})$
\end_inset

-basis 
\begin_inset Formula \[
\bar{\mathbf{P}}=\left[{\begin{array}{cccccccccccc}
0 & ~0~ & ~0~ & ~0~ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1\\
\hline ~x~ & 1 & 0 & 0 & 1 & 0 & ~x~ & 0 & 0 & 0 & ~x~ & ~0~\\
0 & 0 & 1 & 0 & 0 & ~x~ & 1+~x~ & ~x~ & ~x~ & ~x~ & 1 & 0\\
\hline ~x~ & 1 & 0 & 1 & 1+x & 1 & ~x~ & 0 & 0 & 0 & 0 & 1\\
~x~ & 0 & 1 & 1 & 1+x & 1+x & 1 & ~x~ & ~x~ & 0 & 0 & 0\\
~x~ & 0 & 0 & 1 & 1+x & 1+x & 1 & ~x~ & 0 & 1 & 0 & 0\\
~x~ & 0 & 0 & 1 & 1 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
\hline 0 & 0 & 0 & 1 & ~x~ & 1 & 0 & 0 & 0 & 0 & 0 & 1\\
0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & ~x~ & 1 & 1 & 1 & 1 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\end{array}}\right]\]

\end_inset

 with 
\begin_inset Formula $\bar{s}$
\end_inset

-degrees 
\begin_inset Formula $[-1,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,0]$
\end_inset

.
 Only the last column has 
\begin_inset Formula $\bar{s}$
\end_inset

-degree exceeding 
\begin_inset Formula $-\alpha=-1$
\end_inset

 and so is the only column guaranteed to give a correct 
\begin_inset Formula $(\mathbf{F},8,\vec{s})$
\end_inset

-basis element.
 Comparing 
\begin_inset Formula \[
\mathbf{E}\bar{\mathbf{P}}=\left[{\begin{array}{cccccccccccc}
0 & ~0~ & ~0~ & 0 & ~0~ & 0 & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~1~\\
x & 1 & x & 0 & 1 & x^{2} & x^{2} & x^{2} & x^{2} & x^{2} & 0 & 0\\
x+x^{2}+x^{3}+x^{4} & 1 & x & 1+x+x^{2}+x^{3} & 1 & 1+x+x^{3} & x^{2} & x^{2} & x^{2} & x^{2} & 0 & 1\\
0 & x & x^{2} & 1+x^{3}+x^{4} & x & 1+x^{4} & x^{3} & x^{3} & x^{3} & x^{3} & 0 & 1\end{array}}\right]\]

\end_inset

 to a 
\begin_inset Formula $(\mathbf{F},8,\vec{s})$
\end_inset

-basis 
\begin_inset Formula \[
\mathbf{P}=\left[{\begin{array}{cccc}
~0~ & 0 & 0 & ~1~\\
1 & 0 & 0 & 0\\
1 & x^{2}+x^{3}+x^{4} & 1+x+x^{2}+x^{3} & 1\\
x & x^{2} & 1+x^{3}+x^{4} & 1\end{array}}\right]\]

\end_inset

 with 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees 
\begin_inset Formula $[-3,-1,-2,~0~]$
\end_inset

, we see that the last column of 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 is a element of a 
\begin_inset Formula $(\mathbf{F},8,\vec{s})$
\end_inset

-basis.
\end_layout

\begin_layout Example
If we set 
\begin_inset Formula $\alpha=2,\beta=1$
\end_inset

, then the new transformed problem gives 
\begin_inset Formula \[
\bar{\mathbf{P}}=\left[{\begin{array}{ccccccccc}
~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~1~\\
1 & 0 & 0 & x & 1+x & x & x & \, x\, & \,0\,\\
1 & x^{2} & 1 & x & 1 & x & \, x\, & 0 & 1\\
0 & x^{2} & 1 & \, x\, & 1 & \, x\, & 0 & 1 & 0\\
0 & x^{2} & 1+x & 1 & 0 & 1 & 0 & 0 & 0\\
0 & x^{2} & 1 & 0 & \, x\, & 0 & 0 & 0 & 1\\
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\,0\, & \,0\, & \, x\, & 1+x & 1 & 1 & 1 & 1 & 0\\
0 & 0 & x & 1 & 0 & 0 & 0 & 0 & 0\end{array}}\right]\]

\end_inset

 with 
\begin_inset Formula $\bar{s}$
\end_inset

-degrees 
\begin_inset Formula $[-3,-1,-2,-2,-2,-2,-2,-2,~0~]$
\end_inset

.
 In this case the second column also has 
\begin_inset Formula $\bar{s}$
\end_inset

-degree exceeding 
\begin_inset Formula $-\alpha=-2$
\end_inset

, and so it is guaranteed to produce another element of a 
\begin_inset Formula $(\mathbf{F},8,\vec{s})$
\end_inset

-basis.
 Computing 
\begin_inset Formula \[
\mathbf{E}\bar{\mathbf{P}}=\left[{\begin{array}{ccccccccc}
~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~0~ & ~1~\\
1 & 0 & 0 & x & 1+x & x & x & x & 0\\
1 & x^{2}+x^{3}+x^{4} & 1+x+x^{2}+x^{3} & x & 1+x & x & x & x & 1\\
x & x^{2} & 1+x^{3}+x^{4} & x^{2} & x+x^{2} & ~x^{2} & ~x^{2} & ~x^{2} & 1\end{array}}\right],\]

\end_inset

 we notice the second column is indeed an element of a 
\begin_inset Formula $(\mathbf{F},8,\vec{s})$
\end_inset

-basis.
 
\end_layout

\begin_layout Subsection
Correspondence Between the Original Problem and the Transformed Problem
\end_layout

\begin_layout Standard
We now work towards establishing the correspondence between the high degree
 columns of a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis whose 
\begin_inset Formula $\bar{s}$
\end_inset

-degrees exceed 
\begin_inset Formula $-\alpha$
\end_inset

 and those of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis whose 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees exceed 
\begin_inset Formula $-\alpha$
\end_inset

.
 A useful link is provided by the following a matrix .
\end_layout

\begin_layout Standard
Set 
\begin_inset Formula \[
\mathbf{A}_{i}=\begin{bmatrix}~~x^{r_{i}}\\
-1 & ~~x^{\beta}\\
 & -1 & \ddots\\
 &  & \ddots & ~~x^{\beta}\\
 &  &  & -1\end{bmatrix}_{q_{i}\times(q_{i}-1)}\mbox{ and \qquad}\mathbf{A}=\left[\begin{array}{ccc}
\mathbf{A}_{1}\\
 & \ddots\\
 &  & \mathbf{A}_{n}\end{array}\right]_{\bar{n}\times(\bar{n}-n)}.\]

\end_inset

 If 
\begin_inset Formula $q_{i}=1$
\end_inset

, 
\begin_inset Formula $\mathbf{A}_{i}$
\end_inset

 has dimension 
\begin_inset Formula $1\times0$
\end_inset

, which just adds a zero row and no column in 
\begin_inset Formula $\mathbf{A}$
\end_inset

.
\end_layout

\begin_layout Standard
We now show that for any 
\begin_inset Formula $\bar{\mathbf{w}}\in\left\langle \left(\bar{\mathbf{F}},\sigma,\bar{s}\right)\right\rangle $
\end_inset

, 
\begin_inset Formula $\bar{\mathbf{w}}$
\end_inset

 can be transformed by 
\begin_inset Formula $\mathbf{A}$
\end_inset

 to one of the two forms that correspond to the original problem and transformed
 problem.
 This is made more precise in the following lemma.
 We then use unimodular equivalence of these two forms to show the equivalence
 between the high degree part of the result from the transformed problem
 and that of the original problem.
 
\end_layout

\begin_layout Lemma
Let 
\begin_inset Formula \[
\bar{\mathbf{w}}=\begin{bmatrix}\bar{\mathbf{w}}_{1}\\
\vdots\\
\bar{\mathbf{w}}_{n}\end{bmatrix}\in\langle(\bar{\mathbf{F}},\sigma,\bar{s})\rangle\mbox{ with }\bar{\mathbf{w}}_{i}=\begin{bmatrix}\bar{w}_{i,0}\\
\vdots\\
\bar{w}_{i,q_{i}-1}\end{bmatrix}_{q_{i}\times1}.\]

\end_inset

 Then there exists a vector 
\begin_inset Formula $\mathbf{u}\in\mathbb{K}\left[x\right]^{\left(\bar{n}-n\right)\times1}$
\end_inset

 such that 
\begin_inset Formula $\bar{\mathbf{w}}+\mathbf{A}\mathbf{u}$
\end_inset

 has one of the following two forms.
 
\end_layout

\begin_deeper
\begin_layout Description
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

(a)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 The first form is 
\shape up

\begin_inset Formula \[
\mathbf{w}^{[1]}=\begin{bmatrix}\mathbf{w}_{1}^{[1]}\\
\vdots\\
\mathbf{w}_{n}^{[1]}\end{bmatrix}\mbox{ with }\mathbf{w}_{i}^{[1]}=\begin{bmatrix}w_{i}\\
0\\
\vdots\\
0\end{bmatrix}_{q_{i}\times1},\]

\end_inset

 
\shape default
 where 
\shape up

\begin_inset Formula $w_{i}=\bar{w}_{i,0}+\bar{w}_{i,1}x^{r_{i}}+\bar{w}_{i,2}x^{r_{i}+\beta}+\cdots+\bar{w}_{i,q_{i}-1}x^{r_{i}+(q_{i}-2)\beta}$
\end_inset

.

\shape default
 
\end_layout

\begin_layout Description
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

(b)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 The second form is 
\begin_inset Formula \[
\mathbf{w}^{[2]}=\begin{bmatrix}\mathbf{w}_{1}^{[2]}\\
\vdots\\
\mathbf{w}_{n}^{[2]}\end{bmatrix}\mbox{ with }\mathbf{w}_{i}^{[2]}=\begin{bmatrix}w_{i,0}\\
\vdots\\
w_{i,q_{i}-1}\end{bmatrix},\]

\end_inset

 where 
\begin_inset Formula $\deg w_{i,j}<r_{i}\le\beta$
\end_inset

 when 
\begin_inset Formula $j=0$
\end_inset

 and 
\begin_inset Formula $\deg w_{i,j}<\beta$
\end_inset

 when 
\begin_inset Formula $j\in\{1,\dots,q_{i}-2\}$
\end_inset

.
 There is no degree restriction on 
\begin_inset Formula $w_{i,q_{i}-1}$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Proof
The first form is obtained by setting 
\begin_inset Formula \[
\mathbf{u}^{[1]}=\begin{bmatrix}\mathbf{u}_{1}^{[1]}\\
\vdots\\
\mathbf{u}_{n}^{[1]}\end{bmatrix}\mbox{ with }\mathbf{u}_{i}^{[1]}=\left[\begin{array}{r}
\bar{w}_{i,1}+\bar{w}_{i,2}x^{\beta}+\bar{w}_{i,3}x^{2\beta}+\cdots+\bar{w}_{i,q_{i}-1}x^{(q_{i}-2)\beta}\\
\bar{w}_{i,2}+\bar{w}_{i,3}x^{\beta}+\cdots+\bar{w}_{i,q_{i}-1}x^{(q_{i}-3)\beta}\\
\vdots~~~~~\\
\bar{w}_{i,q_{i}-1}\end{array}\right].\]

\end_inset

 Then 
\begin_inset Formula $\bar{\mathbf{w}}+\mathbf{A}\mathbf{u}^{[1]}$
\end_inset

 gives the first form.
 Note that 
\begin_inset Formula $\mathbf{u}_{i}^{[1]}$
\end_inset

 is empty if 
\begin_inset Formula $q_{i}=1$
\end_inset

 and 
\begin_inset Formula $\bar{\mathbf{w}}_{i}=\mathbf{w}_{i}^{[1]}=[\bar{w}_{i,0}]$
\end_inset

 is not changed by the transformation.
\end_layout

\begin_layout Proof
The second form can be obtained based on the first form.
 Let 
\begin_inset Formula \[
t_{i,j}=\begin{cases}
r_{i} & \mbox{if }j=0\\
\beta & \mbox{if }j\in\{1,\dots,q_{i}-2\}\end{cases}\]

\end_inset

 and write 
\begin_inset Formula $w_{i}$
\end_inset

 from the first form as 
\begin_inset Formula \begin{equation}
w_{i}=w_{i,0}+w_{i,1}x^{r_{i}}+w_{i,2}x^{r_{i}+\beta}+\cdots+w_{i,q_{i}-1}x^{r_{i}+(q_{i}-2)\beta}\label{eq:wiSeparatedForm}\end{equation}

\end_inset

 with 
\begin_inset Formula $\deg w_{i,j}<t_{i,j}$
\end_inset

 for 
\begin_inset Formula $j<q_{i}-1$
\end_inset

.
 Note that in general 
\begin_inset Formula $w_{i,j}\ne\bar{w}_{i,j}$
\end_inset

, as 
\begin_inset Formula $\deg\bar{w}_{i,j}$
\end_inset

 may not be less than 
\begin_inset Formula $t_{i,j}$
\end_inset

.
 Now set 
\begin_inset Formula \[
\mathbf{v}=\begin{bmatrix}\mathbf{v}_{1}\\
\vdots\\
\mathbf{v}_{n}\end{bmatrix}\mbox{ with }\mathbf{v}_{i}=\left[\begin{array}{r}
w_{i,1}+w_{i,2}x^{\beta}+w_{i,3}x^{2\beta}+\cdots+w_{i,q_{i}-1}x^{(q_{i}-2)\beta}\\
w_{i,2}+w_{i,3}x^{\beta}+\cdots+w_{i,q_{i}-1}x^{(q_{i}-3)\beta}\\
\vdots~~~~~\\
w_{i,q_{i}-1}\end{array}\right]\]

\end_inset

 and 
\begin_inset Formula $\mathbf{u}^{[2]}=\mathbf{u}^{[1]}-\mathbf{v}$
\end_inset

, which comes from the unimodular transformation 
\begin_inset Formula \[
\left[\bar{\mathbf{w}},\mathbf{A}\right]\left[\begin{array}{c|c}
1\\
\hline \mathbf{\mathbf{u}}^{[1]} & \mathbf{I}\end{array}\right]\left[\begin{array}{c|c}
1\\
\hline -\mathbf{v} & \mathbf{I}\end{array}\right]=\left[\bar{\mathbf{w}},\mathbf{A}\right]\left[\begin{array}{c|c}
1\\
\hline \mathbf{u}^{[1]}-\mathbf{v} & \mathbf{I}\end{array}\right].\]

\end_inset

 Then 
\begin_inset Formula $\mathbf{w}^{[2]}=\bar{\mathbf{w}}+\mathbf{A}\mathbf{u}^{[2]}$
\end_inset

 is in the second form.
 Again note that 
\begin_inset Formula $\mathbf{v}_{i}$
\end_inset

 and 
\begin_inset Formula $\mathbf{u}_{i}^{[2]}$
\end_inset

 are empty if 
\begin_inset Formula $q_{i}=1$
\end_inset

 and 
\begin_inset Formula $\mathbf{w}_{i}^{[2]}=\bar{\mathbf{w}}_{i}=[\bar{w}_{i,0}]$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:degreeCorrespondence"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{w}}\in\left\langle \left(\bar{\mathbf{F}},\sigma,\bar{s}\right)\right\rangle $
\end_inset

 and 
\begin_inset Formula $\mathbf{w}^{[2]}$
\end_inset

 be in the second form.
 If 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}}>-\alpha$
\end_inset

 or 
\begin_inset Formula $\deg_{\bar{s}}\mathbf{w}^{[2]}>-\alpha$
\end_inset

, then 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}}=\deg_{\bar{s}}\mathbf{w}^{[2]}$
\end_inset

.
 
\end_layout

\begin_layout Proof
Consider the 
\begin_inset Formula $i$
\end_inset

th entry 
\begin_inset Formula $w_{i}$
\end_inset

 of 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{w}}$
\end_inset

 and the 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%corresponding 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

entries 
\begin_inset Formula $\mathbf{w}_{i}^{[2]}=\left[w_{i,0},\dots,w_{i,q_{i}-1}\right]^{T}$
\end_inset

 in 
\begin_inset Formula $\mathbf{w}^{[2]}$
\end_inset

.
 If 
\begin_inset Formula $q_{i}=1$
\end_inset

, then 
\begin_inset Formula $w_{i}=w_{i,0}$
\end_inset

 and the corresponding shifts satisfies 
\begin_inset Formula $s_{i}=\bar{s}_{\ell(i)}$
\end_inset

, where 
\begin_inset Formula $\ell(i)=\sum_{k=1}^{i}q_{k}$
\end_inset

.
 Hence 
\begin_inset Formula $\deg w_{i}+s_{i}=\deg w_{i,0}+\bar{s}_{\ell(i)}$
\end_inset

.
 Thus we only need to consider the case where 
\begin_inset Formula $q_{i}>1$
\end_inset

.
 Write 
\begin_inset Formula $w_{i}$
\end_inset

 as in Equation 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "eq:wiSeparatedForm"

\end_inset

.
 Note that 
\begin_inset Formula $\deg w_{i,q_{i}-1}=\deg w_{i}-r_{i}-\beta\left(q_{i}-2\right)$
\end_inset

 and hence 
\begin_inset Formula $\deg w_{i,q_{i}-1}-\alpha-\beta=\deg w_{i}-r_{i}-\alpha-\beta\left(q_{i}-1\right)$
\end_inset

, that is, 
\begin_inset Formula $\deg w_{i,q_{i}-1}+\bar{s}_{\ell(i)}=\deg w_{i}+s_{i}$
\end_inset

.
 It follows that 
\begin_inset Formula \begin{eqnarray*}
\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}} & = & \max_{i}(\deg w_{i}+s_{i})=\max_{i}(\deg w_{i,q_{i}-1}+\bar{s}_{\ell(i)})\\
 & \le & \max_{i,j}\left(\deg w_{i,j}+\bar{s}_{\ell(i-1)+j+1}\right)=\deg_{\bar{s}}\mathbf{w}^{[2]}.\end{eqnarray*}

\end_inset

 The only possible indices 
\begin_inset Formula $j$
\end_inset

 where the inequality can be strict occur when 
\begin_inset Formula $j<q_{i}-1$
\end_inset

.
 But 
\begin_inset Formula $\deg w_{i,j}<\beta$
\end_inset

 for all 
\begin_inset Formula $j<q_{i}-1$
\end_inset

, which implies 
\begin_inset Formula $\deg w_{i,j}+\bar{s}_{\ell(i-1)+j+1}=\deg w_{i,j}-\alpha-\beta<-\alpha$
\end_inset

, and so it follows that the entries at these indices 
\begin_inset Formula $j$
\end_inset

 do not contribute to 
\begin_inset Formula $\deg_{\bar{s}}\mathbf{w}^{[2]}$
\end_inset

 when 
\begin_inset Formula $\deg_{\bar{s}}\mathbf{w}^{[2]}>-\alpha$
\end_inset

 or 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}}=\max_{i}(\deg w_{i,q_{i}-1}+\bar{s}_{\ell(i)})>-\alpha$
\end_inset

.
 In other words, if one of them exceeds 
\begin_inset Formula $-\alpha$
\end_inset

, then 
\begin_inset Formula $\deg_{\bar{s}}\mathbf{w}^{[2]}$
\end_inset

 and 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}}$
\end_inset

 are determined only by entries at indices 
\begin_inset Formula $j=q_{i}-1$
\end_inset

, but the equality always holds for these entries.
 
\end_layout

\begin_layout Remark
Notice that the first form 
\begin_inset Formula $\mathbf{w}^{\left[1\right]}$
\end_inset

 of 
\begin_inset Formula $\bar{\mathbf{w}}$
\end_inset

 has nonzero entries only at indices 
\begin_inset Formula $I=[1,q_{1}+1,\dots,\sum_{k=1}^{n-1}q_{k}+1]$
\end_inset

.
 Let 
\begin_inset Formula $\mathbf{B}$
\end_inset

 be a 
\begin_inset Formula $\bar{n}\times n$
\end_inset

 matrix with 
\begin_inset Formula $1$
\end_inset

's at position 
\begin_inset Formula $(\sum_{k=1}^{n-1}q_{k}+1,i)$
\end_inset

 and 0's everywhere else.
 Then the first form satisfies
\shape up
 
\begin_inset Formula $\mathbf{w}^{[1]}=\mathbf{B}\mathbf{E}\bar{\mathbf{w}}$
\end_inset

.

\shape default
 Hence 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:degreeCorrespondence"

\end_inset

 provides the degree correspondence between the degrees of the first form
 
\begin_inset Formula $\mathbf{B}\mathbf{E}\bar{\mathbf{w}}$
\end_inset

, which is just 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{w}}$
\end_inset

 with zero rows added, and the second form 
\begin_inset Formula $\bar{\mathbf{w}}^{[2]}$
\end_inset

 of 
\begin_inset Formula $\bar{\mathbf{w}}$
\end_inset

.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:degreeCorrespondence"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{w}}\in\left\langle \left(\bar{\mathbf{F}},\sigma,\bar{s}\right)\right\rangle $
\end_inset

 and 
\begin_inset Formula $\mathbf{w}^{[2]}$
\end_inset

 be its second form.
 Then 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}}>-\alpha$
\end_inset

 if and only if 
\begin_inset Formula $\deg_{\bar{s}}\mathbf{w}^{[2]}>-\alpha$
\end_inset

.
\end_layout

\begin_layout Proof
The proof follows directly from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:degreeCorrespondence"

\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:degEwLessEqDegw"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{w}}\in\left\langle \left(\bar{\mathbf{F}},\sigma,\bar{s}\right)\right\rangle $
\end_inset

.
 Then 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}}\le\deg_{\bar{s}}\bar{\mathbf{w}}$
\end_inset

.
 
\end_layout

\begin_layout Proof
As in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:degreeCorrespondence"

\end_inset

, consider the 
\begin_inset Formula $i$
\end_inset

th entry 
\begin_inset Formula $w_{i}$
\end_inset

 of 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{w}}$
\end_inset

 and the corresponding entries 
\begin_inset Formula $\bar{\mathbf{w}}_{i}=\left[\bar{w}_{i,0},\dots,\bar{w}_{i,q_{i}-1}\right]^{T}$
\end_inset

 in 
\begin_inset Formula $\bar{\mathbf{w}}$
\end_inset

.
 If 
\begin_inset Formula $q_{i}=1$
\end_inset

, then 
\begin_inset Formula $\deg w_{i}+s_{i}=\deg w_{i,0}+\bar{s}_{\ell(i)}$
\end_inset

 as before.
 Thus we just need to consider the case 
\begin_inset Formula $q_{i}>1$
\end_inset

, where the shifts for 
\begin_inset Formula $\bar{\mathbf{w}}_{i}$
\end_inset

 are 
\begin_inset Formula $-\alpha-\beta$
\end_inset

.
 Since 
\begin_inset Formula $w_{i}=\bar{w}_{i,0}+\bar{w}_{i,1}x^{r_{i}}+\bar{w}_{i,2}x^{r_{i}+\beta}+\cdots+\bar{w}_{i,q_{i}-1}x^{r_{i}+(q_{i}-2)\beta},$
\end_inset

 we get 
\begin_inset Formula \[
\deg w_{i}=\max\left\{ \deg\bar{w}_{i,0},\deg\bar{w}_{i,1}+r_{i},\deg\bar{w}_{i,2}+r_{i}+\beta,\dots,\deg\bar{w}_{i,q_{i}-2}+r_{i}+(q_{i}-2)\beta\right\} .\]

\end_inset

 Then 
\begin_inset Formula \begin{eqnarray*}
\deg w_{i}+s_{i} & = & \deg w_{i}-r_{i}-\alpha-\beta(q_{i}-1)\\
 & = & \max\left\{ \deg\bar{w}_{i,0}-r_{i}-\alpha-\beta(q_{i}-1),~\deg\bar{w}_{i,1}-\alpha-\beta(q_{i}-1),~\dots,\right.\\
 &  & \left.~~~~~~~~~~~~~~\dots,\deg\bar{w}_{i,q_{i}-2}-\alpha-\beta\right\} \\
 & \le & \max\left\{ \deg\bar{w}_{i,0}-\alpha-\beta,\deg\bar{w}_{i,1}-\alpha-\beta,\dots,\deg\bar{w}_{i,q_{i}-2}-\alpha-\beta\right\} ,\end{eqnarray*}

\end_inset

 and so 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}}\le\deg_{\bar{s}}\bar{\mathbf{w}}$
\end_inset

.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:P2Degree"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{P}}=[\bar{\mathbf{P}}_{1},\bar{\mathbf{P}}_{2}]$
\end_inset

 be a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis, where 
\begin_inset Formula $\deg_{\bar{s}}\bar{\mathbf{P}}_{1}\le-\alpha$
\end_inset

 and 
\begin_inset Formula $\deg_{\bar{s}}\bar{\mathbf{P}}_{2}>-\alpha$
\end_inset

.
 Let 
\begin_inset Formula $\bar{\mathbf{P}}_{2}^{[2]}$
\end_inset

 be the second form of 
\begin_inset Formula $\bar{\mathbf{P}}_{2}$
\end_inset

.
 Then 
\begin_inset Formula $\deg_{\bar{s}}\bar{\mathbf{P}}_{2}=\deg_{\bar{s}}\bar{\mathbf{P}}_{2}^{[2]}=\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{P}}_{2}$
\end_inset

.
 Hence 
\begin_inset Formula $[\bar{\mathbf{P}}_{1},\bar{\mathbf{P}}_{2}^{[2]}]$
\end_inset

 is also a 
\begin_inset Formula $(\bar{\mathbf{F}},\sigma,\bar{s})$
\end_inset

-basis.
\end_layout

\begin_layout Proof
Since any column 
\begin_inset Formula $\bar{\mathbf{p}}$
\end_inset

 of 
\begin_inset Formula $\bar{\mathbf{P}}_{2}$
\end_inset

 satisfies 
\begin_inset Formula $\deg_{\bar{s}}\bar{\mathbf{p}}>-\alpha,$
\end_inset

 from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:degreeCorrespondence"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:degEwLessEqDegw"

\end_inset

, we get 
\begin_inset Formula \[
\deg_{\bar{s}}\bar{\mathbf{p}}^{[2]}=\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{p}}\le\deg_{\bar{s}}\bar{\mathbf{p}}.\]

\end_inset

 The inequality is in fact an equality, since otherwise, 
\begin_inset Formula $\bar{\mathbf{p}}$
\end_inset

 in 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

 can be replaced by 
\begin_inset Formula $\bar{\mathbf{p}}^{[2]}$
\end_inset

 to get a basis of lower degree, contradicting the minimality of 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

.
 Note that 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

 with its column 
\begin_inset Formula $\bar{\mathbf{p}}$
\end_inset

 replaced by 
\begin_inset Formula $\bar{\mathbf{p}}^{[2]}$
\end_inset

 remains to be a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis, since 
\begin_inset Formula $\bar{\mathbf{p}}^{[2]}=\bar{\mathbf{p}}+\mathbf{A}\mathbf{u}$
\end_inset

 involves column operations with only columns in 
\begin_inset Formula $\bar{\mathbf{P}}_{1}$
\end_inset

 as 
\begin_inset Formula $\mathbf{A}$
\end_inset

 has 
\begin_inset Formula $\bar{s}$
\end_inset

-degrees bounded by 
\begin_inset Formula $-\alpha$
\end_inset

 and hence is generated by 
\begin_inset Formula $\bar{\mathbf{P}}_{1}$
\end_inset

.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:PtoBPA"

\end_inset

If 
\begin_inset Formula $\mathbf{P}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis, then 
\begin_inset Formula $\left[\mathbf{B}\mathbf{P},\mathbf{A}\right]$
\end_inset

 is a basis for 
\begin_inset Formula $\left\langle \left(\bar{\mathbf{F}},\sigma,\bar{s}\right)\right\rangle $
\end_inset

.
\end_layout

\begin_layout Proof
Any 
\begin_inset Formula $\bar{\mathbf{w}}\in\left\langle \left(\bar{\mathbf{F}},\sigma,\bar{s}\right)\right\rangle $
\end_inset

 can be transformed by 
\begin_inset Formula $\mathbf{A}$
\end_inset

 to the first form 
\begin_inset Formula \[
\mathbf{w}^{[1]}=\bar{\mathbf{w}}+\mathbf{A}\mathbf{u}^{[1]}=\mathbf{B}\mathbf{E}\bar{\mathbf{w}},\]

\end_inset

 where 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{w}}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

 is generated by 
\begin_inset Formula $\mathbf{P}$
\end_inset

.
 That is, 
\begin_inset Formula \[
\bar{\mathbf{w}}=\mathbf{w}^{[1]}-\mathbf{A}\mathbf{u}^{[1]}=\mathbf{B}\mathbf{E}\bar{\mathbf{w}}-\mathbf{A}\mathbf{u}^{[1]}=\mathbf{B}\mathbf{P}\mathbf{v}-\mathbf{A}\mathbf{u}^{[1]}=\left[\mathbf{B}\mathbf{P},\mathbf{A}\right][\mathbf{v},-\mathbf{u}^{[1]}]^{T}.\]

\end_inset

 One can also see that the columns of 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and the columns of 
\begin_inset Formula $\mathbf{B}\mathbf{P}$
\end_inset

 are linearly independent, as each zero row of 
\begin_inset Formula $\mathbf{B}\mathbf{P}$
\end_inset

 has a 
\begin_inset Formula $-1$
\end_inset

 from a column of 
\begin_inset Formula $\mathbf{A}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Lemma
If 
\begin_inset Formula $\mathbf{P}_{1}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{-\alpha}$
\end_inset

-basis , then 
\begin_inset Formula $\left[\mathbf{B}\mathbf{P}_{1},\mathbf{A}\right]$
\end_inset

 is a basis for 
\begin_inset Formula $\left\langle \left(\bar{\mathbf{F}},\sigma,\bar{s}\right)\right\rangle _{-\alpha}$
\end_inset

.
\end_layout

\begin_layout Proof
We know that if 
\begin_inset Formula $\bar{\mathbf{w}}$
\end_inset

 has order 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma\right)$
\end_inset

 then 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{w}}$
\end_inset

 has order 
\begin_inset Formula $\left(\vec{\mathbf{F}},\sigma\right)$
\end_inset

.
 Also if 
\begin_inset Formula $\deg_{\bar{s}}\bar{\mathbf{w}}\le-\alpha$
\end_inset

, then 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{E}\bar{\mathbf{w}}\le-\alpha$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:degEwLessEqDegw"

\end_inset

.
 Therefore, if 
\begin_inset Formula $\bar{\mathbf{w}}\in\left\langle \left(\bar{\mathbf{F}},\sigma,\bar{s}\right)\right\rangle _{-\alpha}$
\end_inset

 , then 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{w}}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{-\alpha}$
\end_inset

.
 Now apply the same procedure as in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:PtoBPA"

\end_inset

, we get 
\begin_inset Formula $\bar{\mathbf{w}}=\mathbf{w}^{[1]}-\mathbf{A}\mathbf{u}^{[1]}=\mathbf{B}\mathbf{E}\bar{\mathbf{w}}-\mathbf{A}\mathbf{u}^{[1]}=\mathbf{B}\mathbf{P}_{1}\mathbf{v}-\mathbf{A}\mathbf{u}^{[1]}=\left[\mathbf{B}\mathbf{P}_{1},\mathbf{A}\right][\mathbf{v},-\mathbf{u}^{[1]}]^{T}.$
\end_inset

 Also as before, the columns of 
\begin_inset Formula $\mathbf{A}$
\end_inset

 and the columns of 
\begin_inset Formula $\mathbf{B}\mathbf{P}_{1}$
\end_inset

 are linearly independent.
 
\end_layout

\end_inset

 
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:EPgeneration"

\end_inset

If 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

 is a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis, then 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 generates 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

.
 That is, for any 
\begin_inset Formula $\mathbf{w}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

, there is an 
\begin_inset Formula $\mathbf{u}\in\mathbb{K}\left[x\right]^{\bar{n}\times1}$
\end_inset

 such that 
\begin_inset Formula $\mathbf{w}=\mathbf{E}\bar{\mathbf{P}}\mathbf{u}$
\end_inset

.
\end_layout

\begin_layout Proof
For any 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis 
\begin_inset Formula $\mathbf{P}$
\end_inset

, the columns of 
\begin_inset Formula $\mathbf{B}\mathbf{P}$
\end_inset

 are in 
\begin_inset Formula $\langle(\bar{\mathbf{F}},\sigma,\bar{s})\rangle$
\end_inset

 generated by 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

, that is, 
\begin_inset Formula $\mathbf{B}\mathbf{P}=\bar{\mathbf{P}}\mathbf{U}$
\end_inset

 for some 
\begin_inset Formula $\mathbf{U}\in\mathbb{K}[x]^{\bar{n}\times n}$
\end_inset

.
 Hence 
\begin_inset Formula $\mathbf{E}\mathbf{B}\mathbf{P}=\mathbf{P}$
\end_inset

 is generated by 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

.
 That is, 
\begin_inset Formula $\mathbf{P}=\mathbf{E}\bar{\mathbf{P}}\mathbf{U}$
\end_inset

.
 Then any 
\begin_inset Formula $\mathbf{w}\in\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

, which satisfies 
\begin_inset Formula $\mathbf{w}=\mathbf{P}\mathbf{v}$
\end_inset

 for some 
\begin_inset Formula $\mathbf{v}\in\mathbb{K}[x]^{n\times1}$
\end_inset

, satisfies 
\begin_inset Formula $\mathbf{w}=\mathbf{E}\bar{\mathbf{P}}\mathbf{U}\mathbf{v}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset Note Comment
status open

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:EP1generation"

\end_inset

If 
\begin_inset Formula $\bar{\mathbf{P}}_{1}$
\end_inset

 is a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)_{-\alpha}$
\end_inset

-basis, then 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{1}$
\end_inset

 generates 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle _{-\alpha}$
\end_inset

.
 
\end_layout

\begin_layout Proof
Suppose 
\begin_inset Formula $\mathbf{P}_{1}$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{-\alpha}$
\end_inset

-basis, then the columns of 
\begin_inset Formula $\mathbf{B}\mathbf{P}_{1}$
\end_inset

 can be transformed to the second form with 
\begin_inset Formula $\bar{s}$
\end_inset

-degrees less than or equal to
\begin_inset Formula $-\alpha$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:degreeCorrespondence"

\end_inset

, hence generated by 
\begin_inset Formula $\bar{\mathbf{P}}_{1}$
\end_inset

.
 That is, 
\begin_inset Formula $\mathbf{B}\mathbf{P}_{1}+\mathbf{A}\mathbf{U}$
\end_inset

 is generated by 
\begin_inset Formula $\bar{\mathbf{P}}_{1}$
\end_inset

.
 Therefore, 
\begin_inset Formula $\mathbf{E}(\mathbf{B}\mathbf{P}_{1}+\mathbf{A}\mathbf{U})=\mathbf{E}\mathbf{B}\mathbf{P}_{1}=\mathbf{P}_{1}$
\end_inset

 is generated by 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{1}$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
We are now ready to prove the main result on the correspondence between
 a high degree part of a basis of the transformed problem and that of the
 original problem.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:correctHighDegreeElements"

\end_inset

Let 
\begin_inset Formula $\bar{\mathbf{P}}=[\bar{\mathbf{P}}_{1},\bar{\mathbf{P}}_{2}]$
\end_inset

 be a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis, where 
\begin_inset Formula $\deg_{\bar{s}}\bar{\mathbf{P}}_{1}\le-\alpha$
\end_inset

 and 
\begin_inset Formula $\deg_{\bar{s}}\bar{\mathbf{P}}_{2}>-\alpha$
\end_inset

.
 Then 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{2}$
\end_inset

 is the matrix of the columns of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis whose 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees exceed 
\begin_inset Formula $-\alpha$
\end_inset

.
 
\end_layout

\begin_layout Proof
We want to show that 
\begin_inset Formula $[\mathbf{P}_{1},\mathbf{E}\bar{\mathbf{P}}_{2}]$
\end_inset

 is a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis for any 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{-\alpha}$
\end_inset

-basis 
\begin_inset Formula $\mathbf{P}_{1}$
\end_inset

.
 First, 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 has order 
\begin_inset Formula $(\mathbf{F},\sigma)$
\end_inset

 since 
\begin_inset Formula $\bar{\mathbf{F}}\bar{\mathbf{P}}=\mathbf{F}\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 and 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

 has order 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma\right)$
\end_inset

.
 Also, since 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}$
\end_inset

 generates 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:EPgeneration"

\end_inset

, and from 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:degreeCorrespondence"

\end_inset

 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{1}$
\end_inset

 has 
\begin_inset Formula $\vec{s}$
\end_inset

-degree bounded by 
\begin_inset Formula $-\alpha$
\end_inset

 hence is generated by 
\begin_inset Formula $\mathbf{P}_{1}$
\end_inset

, it follows that 
\begin_inset Formula $\left[\mathbf{P}_{1},\mathbf{E}\bar{\mathbf{P}}_{2}\right]$
\end_inset

 generates 
\begin_inset Formula $\left\langle \left(\mathbf{F},\sigma,\vec{s}\right)\right\rangle $
\end_inset

.
\end_layout

\begin_layout Proof
It only remains to show that the 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees of 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{2}$
\end_inset

 are minimal.
 Suppose not, then 
\begin_inset Formula $[\mathbf{P}_{1},\mathbf{E}\bar{\mathbf{P}}_{2}]$
\end_inset

 can be reduced to 
\begin_inset Formula $[\mathbf{P}_{1},\tilde{\mathbf{P}}_{2}]$
\end_inset

 where 
\begin_inset Formula $\tilde{\mathbf{P}}_{2}$
\end_inset

 has a column having lower 
\begin_inset Formula $\vec{s}$
\end_inset

-degree than that of the corresponding column in 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{2}$
\end_inset

.
 That is, assuming the columns of 
\begin_inset Formula $\tilde{\mathbf{P}}_{2}$
\end_inset

 and 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{2}$
\end_inset

 are in non-decreasing 
\begin_inset Formula $\vec{s}$
\end_inset

-degrees order, then we can find the first index 
\begin_inset Formula $i$
\end_inset

 where the 
\begin_inset Formula $\vec{s}$
\end_inset

-degree of 
\begin_inset Formula $i$
\end_inset

th column of 
\begin_inset Formula $\tilde{\mathbf{P}}_{2}$
\end_inset

 is lower than the 
\begin_inset Formula $\vec{s}$
\end_inset

-degree of the 
\begin_inset Formula $i$
\end_inset

th column of 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{2}$
\end_inset

.
 It follows that 
\begin_inset Formula $[\mathbf{B}\mathbf{P}_{1},\mathbf{B}\mathbf{E}\bar{\mathbf{P}}_{2}]$
\end_inset

 can be reduced to 
\begin_inset Formula $[\mathbf{B}\mathbf{P}_{1},\mathbf{B}\tilde{\mathbf{P}}_{2}]$
\end_inset

 and 
\begin_inset Formula $[\mathbf{B}\mathbf{P}_{1},\mathbf{B}\mathbf{E}\bar{\mathbf{P}}_{2},\mathbf{A}]$
\end_inset

 can be reduced to 
\begin_inset Formula $[\mathbf{B}\mathbf{P}_{1},\mathbf{B}\tilde{\mathbf{P}}_{2},\mathbf{A}]$
\end_inset

.
 Since 
\begin_inset Formula $[\mathbf{B}\mathbf{P}_{1},\mathbf{B}\tilde{\mathbf{P}}_{2},\mathbf{A}]$
\end_inset

 generates 
\begin_inset Formula $\langle(\bar{\mathbf{F}},\sigma,\bar{s})\rangle$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:PtoBPA"

\end_inset

, it can be reduced to 
\begin_inset Formula $\bar{\mathbf{P}}=[\bar{\mathbf{P}}_{1},\bar{\mathbf{P}}_{2}]$
\end_inset

.
 But it can also be reduced to 
\begin_inset Formula $[\bar{\mathbf{P}}_{1},\tilde{\mathbf{P}}_{2}^{[2]},\mathbf{A}]$
\end_inset

 with 
\begin_inset Formula $\tilde{\mathbf{P}}_{2}^{[2]}$
\end_inset

 the second form of 
\begin_inset Formula $\mathbf{B}\tilde{\mathbf{P}}_{2}$
\end_inset

, and to 
\begin_inset Formula $[\bar{\mathbf{P}}_{1},\tilde{\mathbf{P}}_{2}^{[2]}]$
\end_inset

 as the columns of 
\begin_inset Formula $\mathbf{A}$
\end_inset

 are generated by the 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)_{-\alpha}$
\end_inset

-basis 
\begin_inset Formula $\bar{\mathbf{P}}_{1}$
\end_inset

.
\end_layout

\begin_layout Proof
In order to reach a contradiction we just need to show that 
\begin_inset Formula $\tilde{\mathbf{P}}_{2}^{[2]}$
\end_inset

 has a column with 
\begin_inset Formula $\bar{s}$
\end_inset

-degree less than that of the corresponding column in 
\begin_inset Formula $\bar{\mathbf{P}}_{2}$
\end_inset

.
 Let 
\begin_inset Formula $\tilde{\mathbf{w}}$
\end_inset

 be the first column of 
\begin_inset Formula $\tilde{\mathbf{P}}_{2}$
\end_inset

 with 
\begin_inset Formula $\vec{s}$
\end_inset

-degree less than that of the corresponding column 
\begin_inset Formula $\mathbf{w}$
\end_inset

 in 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}_{2}$
\end_inset

 and let 
\begin_inset Formula $\bar{\mathbf{w}}$
\end_inset

 be the corresponding column in 
\begin_inset Formula $\bar{\mathbf{P}}_{2}$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:P2Degree"

\end_inset

 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{w}=\deg_{\bar{s}}\bar{\mathbf{w}}$
\end_inset

.
 Let 
\begin_inset Formula $\tilde{\mathbf{w}}^{[2]}$
\end_inset

 be the second form of 
\begin_inset Formula $\mathbf{B}\tilde{\mathbf{w}}$
\end_inset

, which is a column in 
\begin_inset Formula $\tilde{\mathbf{P}}_{2}^{[2]}$
\end_inset

 corresponding to the column 
\begin_inset Formula $\bar{\mathbf{w}}$
\end_inset

 in 
\begin_inset Formula $\bar{\mathbf{P}}_{2}$
\end_inset

.
 We know that either 
\begin_inset Formula $\deg_{\bar{s}}\tilde{\mathbf{w}}^{[2]}\le-\alpha$
\end_inset

 or 
\begin_inset Formula $\deg_{\bar{s}}\tilde{\mathbf{w}}^{[2]}=\deg_{\vec{s}}\tilde{\mathbf{w}}$
\end_inset

 by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "lem:degreeCorrespondence"

\end_inset

, as 
\begin_inset Formula $\mathbf{E}\tilde{\mathbf{w}}^{[2]}=\mathbf{E}(\mathbf{B}\tilde{\mathbf{w}}+\mathbf{A}\mathbf{u})=\tilde{\mathbf{w}}$
\end_inset

.
 In either case, 
\begin_inset Formula $\deg_{\bar{s}}\tilde{\mathbf{w}}^{[2]}<\deg_{\bar{s}}\bar{\mathbf{w}}$
\end_inset

, as 
\begin_inset Formula $\deg_{\bar{s}}\bar{\mathbf{w}}$
\end_inset

 is greater than both 
\begin_inset Formula $-\alpha$
\end_inset

 and 
\begin_inset Formula $\deg_{\vec{s}}\tilde{\mathbf{w}}$
\end_inset

.
 Hence we have 
\begin_inset Formula $[\bar{\mathbf{P}}_{1},\tilde{\mathbf{P}}_{2}^{[2]}]$
\end_inset

 is another 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis with lower 
\begin_inset Formula $\bar{s}$
\end_inset

-degrees than 
\begin_inset Formula $\mathbf{\bar{P}}$
\end_inset

, contradicting with the minimality of 
\begin_inset Formula $\bar{\mathbf{P}}$
\end_inset

.
 
\end_layout

\begin_layout Subsection
Achieving Efficient Computation
\end_layout

\begin_layout Standard
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:correctHighDegreeElements"

\end_inset

 essentially tells us that a high degree part of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis can be determined by computing a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis, something we know can be done efficiently.
 Notice the parallel between the situation here and in the earlier balanced
 shift case, where the transformed problem also allows us to compute a partial
 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis, albeit a low degree part, in each iteration.
\end_layout

\begin_layout Standard
After a 
\begin_inset Formula $\left(\bar{\mathbf{F}},\sigma,\bar{s}\right)$
\end_inset

-basis, or equivalently a high degree part of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis, is computed, for the remaining problem of computing the remaining
 basis elements, we can in fact reduce the dimension of the input 
\begin_inset Formula $\mathbf{F}$
\end_inset

 by removing some of its columns corresponding to the high shift entries.
 
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:zeroHighShiftEntries"

\end_inset

Suppose without loss of generality that the entries of 
\begin_inset Formula $\vec{s}$
\end_inset

 are in non-decreasing order.
 Let 
\begin_inset Formula $I$
\end_inset

 be the index set containing the indices of entries 
\begin_inset Formula $s_{i}$
\end_inset

 in 
\begin_inset Formula $\vec{s}$
\end_inset

 such that 
\begin_inset Formula $s_{i}\le-\alpha$
\end_inset

.
 Let 
\begin_inset Formula $\mathbf{F}_{I}$
\end_inset

 be the columns of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 indexed by 
\begin_inset Formula $I$
\end_inset

.
 Then a 
\begin_inset Formula $\left(\mathbf{F}_{I},\sigma,\vec{s}\right)_{-\alpha}$
\end_inset

-basis 
\series bold

\begin_inset Formula $\mathbf{P}_{1}$
\end_inset


\series default
 gives a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{-\alpha}$
\end_inset

-basis 
\begin_inset Formula $\left[\mathbf{P}_{1}^{T},\mathbf{0}\right]^{T}$
\end_inset

.
 
\end_layout

\begin_layout Standard
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%The theorem follows from the following claim.
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
end{pf}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
begin{claim}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
label{cla:zeroHighShiftEntries}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Proof
For any 
\begin_inset Formula $\mathbf{p}\in\mathbb{K}\left[x\right]^{n\times1}$
\end_inset

 and 
\begin_inset Formula $\deg_{\vec{s}}\mathbf{p}\le-\alpha$
\end_inset

, note that if the 
\begin_inset Formula $i$
\end_inset

th entry of the shift satisfies 
\begin_inset Formula $s_{i}\le-\alpha$
\end_inset

, then the corresponding entry 
\begin_inset Formula $p_{i}$
\end_inset

 of 
\begin_inset Formula $\mathbf{p}$
\end_inset

 is zero.
 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
end{claim}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%
\backslash
begin{pf}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Otherwise, if 
\begin_inset Formula $p_{i}\ne0$
\end_inset

 then the 
\begin_inset Formula $\vec{s}$
\end_inset

-degree of 
\begin_inset Formula $\mathbf{p}$
\end_inset

 is at least 
\begin_inset Formula $s_{i}>-\alpha$
\end_inset

, contradicting the assumption that the 
\begin_inset Formula $\vec{s}$
\end_inset

-degree of 
\begin_inset Formula $\mathbf{p}$
\end_inset

 is lower than or equal to 
\begin_inset Formula $-\alpha$
\end_inset

.
 
\end_layout

\begin_layout Standard
Thus, these zero entries do not need to be considered in the remaining problem
 of computing a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{-\alpha}$
\end_inset

-basis.
 As such the corresponding columns from the input matrix 
\begin_inset Formula $\mathbf{F}$
\end_inset

 can be removed.
 
\end_layout

\begin_layout Example
Let us return to 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:unbalancedShift"

\end_inset

.
 When the parameters 
\begin_inset Formula $\alpha=\beta=1$
\end_inset

, after computing an element of a 
\begin_inset Formula $(\mathbf{F},8,\vec{s})$
\end_inset

-basis with 
\begin_inset Formula $\vec{s}$
\end_inset

-degree 
\begin_inset Formula $0$
\end_inset

 that exceeds 
\begin_inset Formula $-\alpha=-1$
\end_inset

, the first row of any 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{-1}$
\end_inset

-basis must be zero by 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:zeroHighShiftEntries"

\end_inset

 (since the first entry of 
\begin_inset Formula $\vec{s}=[0,-3,-5,-6]$
\end_inset

 is 
\begin_inset Formula $0>-\alpha$
\end_inset

).
 This is illustrated by the 
\begin_inset Formula $(\mathbf{F},8,\vec{s})$
\end_inset

-basis 
\begin_inset Formula $\mathbf{P}$
\end_inset

 given in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "exm:unbalancedShift"

\end_inset

.
 This implies that the first column of 
\begin_inset Formula $\mathbf{F}$
\end_inset

 is not needed in the subsequent computation of the remaining basis elements.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:numberBasisElements"

\end_inset

If the shift 
\begin_inset Formula $\vec{s}$
\end_inset

 satisfies condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "con:unbalancedCondition"

\end_inset

 and 
\begin_inset Formula $c$
\end_inset

 is a constant greater than or equal to 
\begin_inset Formula $1$
\end_inset

, then a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{-cd}$
\end_inset

-basis has at most 
\begin_inset Formula $n/c$
\end_inset

 basis elements.
\end_layout

\begin_layout Proof
Since 
\begin_inset Formula $d=m\sigma/n\ge-\sum_{i=1}^{n}s_{i}/n$
\end_inset

 under condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "con:unbalancedCondition"

\end_inset

, there cannot be more than 
\begin_inset Formula $n/c$
\end_inset

 entries of 
\begin_inset Formula $\vec{s}$
\end_inset

 less than or equal to 
\begin_inset Formula $-cd$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:zeroHighShiftEntries"

\end_inset

, the only possible nonzero rows of a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)_{-cd}$
\end_inset

-basis are the ones corresponding to (with the same indices as) the shift
 entries that are less than or equal to 
\begin_inset Formula $-cd$
\end_inset

.
 Hence there cannot be more than 
\begin_inset Formula $n/c$
\end_inset

 nonzero rows and at most 
\begin_inset Formula $n/c$
\end_inset

 columns, as the columns are linearly independent.
 
\end_layout

\begin_layout Standard
We now have a situation similar to that found in the balanced shift case.
 Namely, for each iteration we transform the problem using appropriate parameter
s 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

 to efficiently compute the basis elements with degrees greater than 
\begin_inset Formula $-\alpha$
\end_inset

.
 Then we can remove columns from the input matrix 
\begin_inset Formula $\mathbf{F}$
\end_inset

 corresponding to the shift entries that are greater than 
\begin_inset Formula $-\alpha$
\end_inset

.
 We can then repeat the same process again, with a larger 
\begin_inset Formula $\alpha$
\end_inset

 and 
\begin_inset Formula $\beta$
\end_inset

, in order to compute more basis elements.
 
\end_layout

\begin_layout Theorem
If the shift 
\begin_inset Formula $\vec{s}$
\end_inset

 satisfies condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "con:unbalancedCondition"

\end_inset

, then a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis can be computed with cost 
\begin_inset Formula $O\left(n^{\omega}\bar{\M}(d)\log\sigma\right)=O(n^{\omega}d\log d\log\log d\log\sigma)\subset O^{\sim}(n^{\omega}d)$
\end_inset

.
 
\end_layout

\begin_layout Proof
We give the following constructive proof.
 Initially, we set transformation parameters 
\begin_inset Formula $\alpha_{1}=\beta_{1}=2d$
\end_inset

 with 
\begin_inset Formula $d=m\sigma/n\ge-\sum_{i=1}^{n}s_{i}/n$
\end_inset

.
 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 works efficiently on the transformed problem as the shift 
\begin_inset Formula $\bar{s}^{\left(1\right)}$
\end_inset

 is balanced and the dimension of 
\begin_inset Formula $\bar{\mathbf{F}}_{1}$
\end_inset

 remains 
\begin_inset Formula $O\left(n\right)$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:correctHighDegreeElements"

\end_inset

 this gives the basis elements of 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis with 
\begin_inset Formula $\vec{s}$
\end_inset

-degree exceeding 
\begin_inset Formula $-\alpha_{1}=-2d$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "cor:numberBasisElements"

\end_inset

, the number of basis elements remaining to be computed is at most 
\begin_inset Formula $n/2$
\end_inset

, hence the number of elements correctly computed is at least 
\begin_inset Formula $n/2$
\end_inset

.
 By 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "thm:zeroHighShiftEntries"

\end_inset

, this also allows us to remove at least half of the columns from the input
 
\begin_inset Formula $\mathbf{F}$
\end_inset

 and correspondingly at least half of the rows from the output for the remaining
 problem.
 Thus the new input matrix 
\begin_inset Formula $\mathbf{F}_{2}$
\end_inset

 has a new column dimension 
\begin_inset Formula $n_{2}\le n/2$
\end_inset

 and the corresponding shift 
\begin_inset Formula $\vec{s}^{\left(2\right)}$
\end_inset

 has 
\begin_inset Formula $n_{2}$
\end_inset

 entries.
 The average degree of the new problem is 
\begin_inset Formula $d_{2}~=~m\sigma/n_{2}$
\end_inset

.
\end_layout

\begin_layout Proof
For the second iteration, we set 
\begin_inset Formula $\alpha_{2}$
\end_inset

 and 
\begin_inset Formula $\beta_{2}$
\end_inset

 to 
\begin_inset Formula $2d_{2}$
\end_inset

.
 Since 
\begin_inset Formula \[
\alpha_{2}=2m\sigma/n_{2}\ge-2\sum_{i=1}^{n}s_{i}/n_{2}\ge-2\sum_{i=1}^{n_{2}}s_{i}^{\left(2\right)}/n_{2},\]

\end_inset

 this allows us to reduce the dimension 
\begin_inset Formula $n_{3}$
\end_inset

 of 
\begin_inset Formula $\mathbf{F}_{3}$
\end_inset

 to at most 
\begin_inset Formula $n_{2}/2$
\end_inset

 after finishing computing a 
\begin_inset Formula $\left(\bar{\mathbf{F}}_{2},\sigma,\bar{s}^{\left(2\right)}\right)_{-\alpha_{1}}$
\end_inset

-basis.
 Again, this can be done using 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "alg:mab"

\end_inset

 with a cost of 
\begin_inset Formula $O\left(n_{2}^{\omega}\bar{\M}(d_{2})\log\sigma\right)$
\end_inset

 as the shift 
\begin_inset Formula $\bar{a}_{2}$
\end_inset

 is balanced and the dimension of 
\begin_inset Formula $\bar{\mathbf{F}}_{2}$
\end_inset

 is 
\begin_inset Formula $O\left(n_{2}\right)$
\end_inset

.
 Repeating this process, at iteration 
\begin_inset Formula $i$
\end_inset

, we set 
\begin_inset Formula $\alpha_{i}=\beta_{i}=2d_{i}=2m\sigma/n_{i}$
\end_inset

.
 The transformed problem has a balanced shift 
\begin_inset Formula $\bar{a}_{i}$
\end_inset

 and column dimension 
\begin_inset Formula $O\left(n_{i}\right)$
\end_inset

.
 So a 
\begin_inset Formula $\left(\bar{\mathbf{F}}_{i},\sigma,\bar{s}^{\left(i\right)}\right)_{-\alpha_{i-1}}$
\end_inset

-basis can be computed with a cost of 
\begin_inset Formula \[
O\left(n_{i}^{\omega}\bar{\M}\left(d_{i}\right)\log\sigma\right)\subset O\left(\left(2^{-i}n\right)^{\omega}\bar{\M}\left(2^{i}d\right)\log\sigma\right)\subset O\left(2^{-i}n^{\omega}\bar{\M}(d)\log\sigma\right).\]

\end_inset

 Since 
\begin_inset Formula \[
\alpha_{i}=2m\sigma/n_{i}\ge-2\sum_{i=1}^{n}s_{i}/n_{i}\ge-2\sum_{i=1}^{n_{i}}s_{i}^{\left(i\right)}/n_{i},\]

\end_inset

 the column dimension 
\begin_inset Formula $n_{i+1}$
\end_inset

 of the next problem can again be reduced by a half.
 After iteration 
\begin_inset Formula $i$
\end_inset

, at most 
\begin_inset Formula $n/2^{i}$
\end_inset

 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis elements remain to be computed.
 We can stop this process when the column dimension 
\begin_inset Formula $n_{i}$
\end_inset

 of the input matrix 
\begin_inset Formula $\mathbf{F}_{i}$
\end_inset

 reaches the row dimension 
\begin_inset Formula $m$
\end_inset

, as an order basis can be efficiently computed in such case.
 Therefore, a complete 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis can be computed in at most 
\begin_inset Formula $\log(n/m)$
\end_inset

 iterations, so the overall cost is 
\begin_inset Formula \[
O\left(\sum_{i=1}^{\log(n/m)}\left(2^{-i}n^{\omega}\bar{\M}(d)\log\sigma\right)\right)=O\left(n^{\omega}\bar{\M}(d)\log\sigma\sum_{i=1}^{\log(n/m)}2^{-i}\right)\subset O\left(n^{\omega}\bar{\M}(d)\log\sigma\right)\]

\end_inset

 field operations.
 
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $\umab\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "alg:umab"

\end_inset

 
\end_layout

\begin_layout Algorithm
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 Input: 
\begin_inset Formula $\mathbf{F}\in K\left[x\right]^{m\times n}$
\end_inset

, 
\begin_inset Formula $\sigma\in\mathbb{Z}_{\ge0}$
\end_inset

, 
\begin_inset Formula $\vec{s}$
\end_inset

 satisfies condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "con:unbalancedCondition"

\end_inset

.
\end_layout

\begin_layout Algorithm
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 Output: 
\begin_inset Formula $\mathbf{P}\in K\left[x\right]^{n\times n}$
\end_inset

, an 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis.
\end_layout

\begin_layout Algorithm
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 Uses:
\end_layout

\begin_layout Algorithm
* (a) 
\begin_inset Formula $\TransformUnbalanced$
\end_inset

 : converts an unbalanced shift problem to a balanced one using the transformati
on described in 
\begin_inset CommandInset ref
LatexCommand prettyref
reference "sec:Unbalanced-Shift"

\end_inset

.
 Returns transformed input matrix, transformed shift, and transformation
 matrix.
\end_layout

\begin_layout Algorithm
* (b) 
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

%{
\backslash
em OrderBasis} 
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\begin_inset Formula $\mmab$
\end_inset

 : computes order basis with balanced shift.
 
\end_layout

\begin_layout Algorithm
* 
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $i:=1;$
\end_inset

 
\begin_inset Formula $\mathbf{P}=[\,]$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{F}^{\left(i\right)}:=\mathbf{F}$
\end_inset

, 
\begin_inset Formula $\vec{s}^{\left(i\right)}:=\vec{s}$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

while
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\columnDimension(\mathbf{P})\ne n$
\end_inset


\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $d_{i}=\left\lceil m\sigma/\columnDimension(\mathbf{F}^{\left(i\right)})\right\rceil $
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\alpha_{i}:=\beta_{i}:=2d_{i};$
\end_inset


\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\left[\bar{\mathbf{F}}^{\left(i\right)},\bar{s}^{\left(i\right)},\mathbf{E}\right]:=\TransformUnbalanced\left(\mathbf{F}^{\left(i\right)},\vec{s}^{\left(i\right)},\alpha_{i},\beta_{i}\right)$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\bar{\mathbf{P}}^{\left(i\right)}:=\mmab\left(\bar{\mathbf{F}}^{\left(i\right)},\sigma,\bar{s}^{\left(i\right)}\right)$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 Set 
\begin_inset Formula $\mathbf{P}^{\left(i\right)}$
\end_inset

 to be the columns of 
\begin_inset Formula $\mathbf{E}\bar{\mathbf{P}}^{\left(i\right)}$
\end_inset

 with 
\begin_inset Formula $\bar{s}_{i}$
\end_inset

-column degrees in 
\begin_inset Formula $(-\alpha_{i},-\alpha_{i-1}]$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{P}:=\left[\mathbf{P}^{\left(i\right)},\mathbf{P}\right]$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 Set 
\begin_inset Formula $I$
\end_inset

 as the set of indices 
\begin_inset Formula $i$
\end_inset

 satisfying 
\begin_inset Formula $s_{i}\le-\alpha_{i}$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{F}^{\left(i+1\right)}:=\mathbf{F}_{I}^{\left(i\right)}$
\end_inset

, 
\begin_inset Formula $\vec{s}^{\left(i+1\right)}:=\vec{s}_{I}^{\left(i\right)}$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset Formula $i:=i+1$
\end_inset

;
\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

endwhile
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Algorithm (num)
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

{
\end_layout

\end_inset

*
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

}
\end_layout

\end_inset

 return 
\begin_inset Formula $\mathbf{P}$
\end_inset

 ; 
\end_layout

\end_inset

Finally, we remark that when the condition 
\begin_inset CommandInset ref
LatexCommand eqref
reference "con:unbalancedCondition"

\end_inset

 is relaxed to 
\begin_inset Formula $\sum_{i=1}^{n}-s_{i}\in O\left(m\sigma\right)$
\end_inset

, so that 
\begin_inset Formula $\sum_{i=1}^{n}-s_{i}\le cm\sigma$
\end_inset

 for a constant 
\begin_inset Formula $c$
\end_inset

, we can still compute a 
\begin_inset Formula $\left(\mathbf{F},\sigma,\vec{s}\right)$
\end_inset

-basis with the same complexity, by setting 
\begin_inset Formula $\alpha_{i}=\beta_{i}=2cm\sigma/n_{i}$
\end_inset

 at each iteration 
\begin_inset Formula $i$
\end_inset

 and following the same procedure as above.
 The cost at each iteration 
\begin_inset Formula $i$
\end_inset

 remains 
\begin_inset Formula $O^{\sim}\left(n^{\omega}d\right)$
\end_inset

, and the entire computation still uses at most 
\begin_inset Formula $\log(n/m)$
\end_inset

 iterations.
 
\end_layout

\begin_layout Section
Future Research
\begin_inset CommandInset label
LatexCommand label
name "sec:Future-Research"

\end_inset


\end_layout

\begin_layout Standard
The algorithms in this paper give fast procedures for efficiently computing
 a large class of order basis problems, including those without shift, those
 with a balanced shift or with a restricted unbalanced shift.
 However a number of problems remain to be solved.
 In particular, the efficient computation of order basis with a general
 unbalanced shift remains an open problem.
 In addition, order bases are closely related to many other problems in
 polynomial matrix computation, for example nullspace basis and matrix normal
 forms.
 We are interested in seeing how our tools can be used to solve these problems
 more efficiently.
 Our work assumes that we are working with polynomials and power series
 represented in standard bases.
 We would like to obtain efficient methods for computation of order bases
 represented in arbitrary bases, particularly those associated to interpolation
 bases.
 Finally, the constructions used in this paper assume exact arithmetic where
 coefficient growth is not an issue.
 We are interested in determining how our tools can be used with methods
 such as fraction-free or modular construction of order bases, particularly
 combining the constructions found in 
\begin_inset CommandInset citation
LatexCommand citep
key "BL2000"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "paper"
options "elsart-harv"

\end_inset


\end_layout

\end_body
\end_document
